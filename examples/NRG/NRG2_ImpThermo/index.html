
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../NRG1_Energy_Flow/">
      
      
        <link rel="next" href="../NRG3_ImpSpec/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.41">
    
    
      
        <title>NRG-2: Impurity Contribution to Thermaldynamic Properties - QSpace Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M64 32C28.7 32 0 60.7 0 96v320c0 35.3 28.7 64 64 64h224V368c0-26.5 21.5-48 48-48h112V96c0-35.3-28.7-64-64-64zm384 320H336c-8.8 0-16 7.2-16 16v112l32-32 64-64z"/></svg>');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M96 0C43 0 0 43 0 96v320c0 53 43 96 96 96h320c17.7 0 32-14.3 32-32s-14.3-32-32-32v-64c17.7 0 32-14.3 32-32V32c0-17.7-14.3-32-32-32H96m0 384h256v64H96c-17.7 0-32-14.3-32-32s14.3-32 32-32m32-240c0-8.8 7.2-16 16-16h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16m16 48h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16s7.2-16 16-16"/></svg>');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M256 512a256 256 0 1 0 0-512 256 256 0 1 0 0 512m-40-176h24v-64h-24c-13.3 0-24-10.7-24-24s10.7-24 24-24h48c13.3 0 24 10.7 24 24v88h8c13.3 0 24 10.7 24 24s-10.7 24-24 24h-80c-13.3 0-24-10.7-24-24s10.7-24 24-24m40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64"/></svg>');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M480 32c0-12.9-7.8-24.6-19.8-29.6S434.5.2 425.3 9.3L381.7 53c-48 48-113.1 75-181 75H64c-35.3 0-64 28.7-64 64v96c0 35.3 28.7 64 64 64v128c0 17.7 14.3 32 32 32h64c17.7 0 32-14.3 32-32V352h8.7c67.9 0 133 27 181 75l43.6 43.6c9.2 9.2 22.9 11.9 34.9 6.9s19.8-16.6 19.8-29.6V300.3c18.6-8.8 32-32.5 32-60.4s-13.4-51.6-32-60.4zm-64 76.7v262.6C357.2 317.8 280.5 288 200.7 288H192v-96h8.7c79.8 0 156.5-29.8 215.3-83.3"/></svg>');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7l233.4-233.3c12.5-12.5 32.8-12.5 45.3 0z"/></svg>');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M256 512a256 256 0 1 0 0-512 256 256 0 1 0 0 512m-86.2-346.7c7.9-22.3 29.1-37.3 52.8-37.3h58.3c34.9 0 63.1 28.3 63.1 63.1 0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6-13.3 0-24-10.7-24-24v-13.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1 0-8.4-6.8-15.1-15.1-15.1h-58.3c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM224 352a32 32 0 1 1 64 0 32 32 0 1 1-64 0"/></svg>');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7.2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8.2-40.1l216-368C228.7 39.5 241.8 32 256 32m0 128c-13.3 0-24 10.7-24 24v112c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24m32 224a32 32 0 1 0-64 0 32 32 0 1 0 64 0"/></svg>');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.1 52.4 442.6 6.5c-1.9-3.9-6.1-6.5-10.5-6.5s-8.5 2.6-10.4 6.5l-16.5 45.9-46 16.8c-4.3 1.6-7.3 5.9-7.2 10.4 0 4.5 3 8.7 7.2 10.2l45.7 16.8 16.8 45.8c1.5 4.4 5.8 7.5 10.4 7.5s8.9-3.1 10.4-7.5l16.5-45.8 45.7-16.8c4.2-1.5 7.2-5.7 7.2-10.2 0-4.6-3-8.9-7.2-10.4zm-132.4 53c-12.5-12.5-32.8-12.5-45.3 0l-2.9 2.9c-22-8-45.8-12.3-70.5-12.3C93.1 96 0 189.1 0 304s93.1 208 208 208 208-93.1 208-208c0-24.7-4.3-48.5-12.2-70.5l2.9-2.9c12.5-12.5 12.5-32.8 0-45.3l-80-80zM200 192c-57.4 0-104 46.6-104 104v8c0 8.8-7.2 16-16 16s-16-7.2-16-16v-8c0-75.1 60.9-136 136-136h8c8.8 0 16 7.2 16 16s-7.2 16-16 16z"/></svg>');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 398.9c58.5-41.1 96-104.1 96-174.9C512 100.3 397.4 0 256 0S0 100.3 0 224c0 70.7 37.5 133.8 96 174.9V464c0 26.5 21.5 48 48 48h48v-48c0-8.8 7.2-16 16-16s16 7.2 16 16v48h64v-48c0-8.8 7.2-16 16-16s16 7.2 16 16v48h48c26.5 0 48-21.5 48-48v-65.1M96 256a64 64 0 1 1 128 0 64 64 0 1 1-128 0m256-64a64 64 0 1 1 0 128 64 64 0 1 1 0-128"/></svg>');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M320 0c17.7 0 32 14.3 32 32v64h120c39.8 0 72 32.2 72 72v272c0 39.8-32.2 72-72 72H168c-39.8 0-72-32.2-72-72V168c0-39.8 32.2-72 72-72h120V32c0-17.7 14.3-32 32-32M208 384c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16zM264 256a40 40 0 1 0-80 0 40 40 0 1 0 80 0m152 40a40 40 0 1 0 0-80 40 40 0 1 0 0 80M48 224h16v192H48c-26.5 0-48-21.5-48-48v-96c0-26.5 21.5-48 48-48m544 0c26.5 0 48 21.5 48 48v96c0 26.5-21.5 48-48 48h-16V224z"/></svg>');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M288 0H128c-17.7 0-32 14.3-32 32s14.3 32 32 32v132.8c0 11.8-3.3 23.5-9.5 33.5L10.3 406.2C3.6 417.2 0 429.7 0 442.6 0 480.9 31.1 512 69.4 512h309.2c38.3 0 69.4-31.1 69.4-69.4 0-12.8-3.6-25.4-10.3-36.4L329.5 230.4c-6.2-10.1-9.5-21.7-9.5-33.5V64c17.7 0 32-14.3 32-32S337.7 0 320 0zm-96 196.8V64h64v132.8c0 23.7 6.6 46.9 19 67.1l34.5 56.1h-171l34.5-56.1c12.4-20.2 19-43.4 19-67.1"/></svg>');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M0 216C0 149.7 53.7 96 120 96h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V216m256 0c0-66.3 53.7-120 120-120h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64h-64c-35.3 0-64-28.7-64-64V216"/></svg>');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/timeago.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#single-impurity-anderson-model-siam" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="QSpace Documentation" class="md-header__button md-logo" aria-label="QSpace Documentation" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            QSpace Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              NRG-2: Impurity Contribution  to Thermaldynamic  Properties
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Open-Source-QSpace/QSpace-Documentation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    QSpace Documentation
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../.." class="md-tabs__link">
          
  
  Getting started

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../tutorial/Get2Know/" class="md-tabs__link">
          
  
  Tutorial

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../NRG1_Energy_Flow/" class="md-tabs__link">
          
  
  Examples

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../reference/compactQS/" class="md-tabs__link">
          
  
  Reference

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../contribg/" class="md-tabs__link">
          
  
  Contribute

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="QSpace Documentation" class="md-nav__button md-logo" aria-label="QSpace Documentation" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    QSpace Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Open-Source-QSpace/QSpace-Documentation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    QSpace Documentation
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Getting started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What is QSpace?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../community/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Community Edition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_3" >
        
          
          <label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Installation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_3">
            <span class="md-nav__icon md-icon"></span>
            Installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../installation/Linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install on Linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../installation/macOS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install on macOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../installation/troublesh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Troubleshooting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../installation/customize/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Customization
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4" >
        
          
          <label class="md-nav__link" for="__nav_1_4" id="__nav_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Development
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorial
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorial
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/Get2Know/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get to Know QSpace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/CGCoeff/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clebsch-Gordan Coefficients
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/LocalOps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generate Local Operators
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/QSpaceObj/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Understand QSpace Objects
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/QSpaceData/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access QSpace Data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Operations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Operations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/BasicOps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic Operations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/Subspace/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access Subspaces
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/Contraction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contraction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/DrctSum/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Direct Sum
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/EigenDecomp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Eigen-decomposition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/SingValDecomp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Singular Value Decomposition
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Special Case
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            Special Case
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/Rank2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rank-2 Tensors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/Vacuum/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vacuum Space
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/Isometries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Identity & Isometry
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8" >
        
          
          <label class="md-nav__link" for="__nav_2_8" id="__nav_2_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Technicality
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8">
            <span class="md-nav__icon md-icon"></span>
            Technicality
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/ZeroTrunc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Truncation of Zeros
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/NormConv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Normalization Convention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/OuterMult/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Outer Multiplicity
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    NRG Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            NRG Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../NRG1_Energy_Flow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NRG-1: Energy Flow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    NRG-2: Impurity Contribution  to Thermaldynamic  Properties
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    NRG-2: Impurity Contribution  to Thermaldynamic  Properties
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#single-impurity-anderson-model-siam" class="md-nav__link">
    <span class="md-ellipsis">
      Single-impurity Anderson model (SIAM)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#thermodynamic-properties-of-the-bath-only" class="md-nav__link">
    <span class="md-ellipsis">
      Thermodynamic properties of the bath only
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#impurity-contribution" class="md-nav__link">
    <span class="md-ellipsis">
      Impurity contribution
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../NRG3_ImpSpec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NRG-3: Impurity Spectral Function
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../NRG_Kondo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NRG for SIKM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../NRG_Kondo_Thermal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SIKM Thermal Properties
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../NRG_SpecFunc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NRG for Spectral Functions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    DMRG Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            DMRG Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DMRG/DMRGHubbard2D/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2D Hubbard Model
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/compactQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    compactQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/contractQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    contractQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/diagQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    diagQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/eigQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eigQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/fdmNRG_QS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fdmNRG_QS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/fgrNRG/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fgrNRG
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/getDimQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    getDimQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/getIdentityQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    getIdentityQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/getLocalSpace/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    getLocalSpace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/getQDimQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    getQDimQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/getRC/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    getRC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/getSmoothSpec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    getSmoothSpec
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/getSmoothTDM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    getSmoothTDM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/getSymStates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    getSymStates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/isHConjQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    isHConjQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/isIdentityCG/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    isIdentityCG
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/isIdentityQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    isIdentityQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/makeUniqueQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    makeUniqueQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/normQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    normQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/orthoQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    orthoQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/permuteQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    permuteQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/plusQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    plusQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/setupRCStore/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    setupRCStore
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/skipZerosQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    skipZerosQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/svdQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    svdQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/tdmNRG/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tdmNRG
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/traceQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    traceQS
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Contribute
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Contribute
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contribg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to Contribute
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mdref/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Markdown Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mkdocsg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MkDocs Guide
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#single-impurity-anderson-model-siam" class="md-nav__link">
    <span class="md-ellipsis">
      Single-impurity Anderson model (SIAM)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#thermodynamic-properties-of-the-bath-only" class="md-nav__link">
    <span class="md-ellipsis">
      Thermodynamic properties of the bath only
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#impurity-contribution" class="md-nav__link">
    <span class="md-ellipsis">
      Impurity contribution
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/Open-Source-QSpace/QSpace-Documentation/edit/main/docs/examples/NRG/NRG2_ImpThermo.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/Open-Source-QSpace/QSpace-Documentation/raw/main/docs/examples/NRG/NRG2_ImpThermo.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


  <h1>NRG-2: Impurity Contribution  to Thermaldynamic  Properties</h1>

<p>Author: <a href="https://www.theorie.physik.uni-muenchen.de/lsvondelft/members/sci_mem/seung_sup-lee/index.html">Seung-Sup Lee</a></p>
<p>Date: 21.06.2020  (Minor update: 30.06.2020)</p>
<p>In this tutorial, we will compute the <strong>impurity contribution to the thermodynamic properties</strong>  of quantum impurity models. The impurity contribution to a thermodynamic property means the difference between the value of the thermodynamic property of the whole quantum impurity system (which has both the impurity and the bath) and that of the bath only. For example, the impurity contribution to the entropy is given by <span class="arithmatex">\(S_{{\mathrm{i}\mathrm{m}\mathrm{p}}} =S_{{\mathrm{t}\mathrm{o}\mathrm{t}}} -S_{{\mathrm{b}\mathrm{a}\mathrm{t}\mathrm{h}}}\)</span> . The subscript "tot" means the total system that contain both the impurity and the bath, and the subscript "bath" means the bath only.</p>
<p>The impurity contributions to  <strong>spin susceptibility</strong> <span class="arithmatex">\(\chi_{{\mathrm{i}\mathrm{m}\mathrm{p}}}\)</span> <strong>,</strong> to  <strong>entropy</strong> <span class="arithmatex">\(S_{{\mathrm{i}\mathrm{m}\mathrm{p}}}\)</span> <strong>,</strong> and to  <strong>specific heat</strong> <span class="arithmatex">\(C_{{\mathrm{i}\mathrm{m}\mathrm{p}}}\)</span> have strong temperature dependence, which shows the nature of fixed point regimes (free orbital, local moment, and strong coupling) and the crossover between these regimes.</p>
<p>From the spin susceptibility and the specific heat, one can derive the <strong>SommerfeldWilson ratio</strong></p>
<div class="arithmatex">\[
  R=\frac{\chi_{{\mathrm{i}\mathrm{m}\mathrm{p}}} /\chi_{{\mathrm{b}\mathrm{a}\mathrm{n}\mathrm{d}}} }{C_{{\mathrm{i}\mathrm{m}\mathrm{p}}} /C_{{\mathrm{b}\mathrm{a}\mathrm{n}\mathrm{d}}} }=\frac{T\chi_{{\mathrm{i}\mathrm{m}\mathrm{p}}} }{C_{{\mathrm{i}\mathrm{m}\mathrm{p}}} }\times \frac{4\pi^2 }{3}, 
\]</div>
<p>which is the universal value. Figure 6 in [<a href="https://arxiv.org/abs/cond-mat/0612006">P. Coleman, arXiv:cond-mat/0612006</a>] shows that the SommerfeldWilson ratio for many correlated systems are quite much the same. For non-interacting systems, the ratio is 1. In the Kondo regime of the single-impurity Anderson model (SIAM) or the single-impurity Kondo model (SIKM), the ratio is 2.</p>
<p>In this tutorial, we will use the conventional NRG scheme in which only the shell of energy eigenstates within each iteration is considered. The energy spectrum at iteration <span class="arithmatex">\(\ell\)</span> is regarded as the effective energy spectrum of the system at temperature <span class="arithmatex">\(T_{\ell } \equiv {\tilde{E} }_{\ell } /\beta_0\)</span> , where <span class="arithmatex">\({\tilde{E} }_{\ell } \propto\Lambda^{-\ell /2}\)</span> is the energy scale at the iteration <span class="arithmatex">\(\ell\)</span> (which is an element of the output <samp>Inrg.EScale</samp> from the iterative diagonalization routine <samp>NRG_IterDiagQS</samp>) and <span class="arithmatex">\(\beta_0\)</span> is a temperature prefactor parameter of order of <span class="arithmatex">\(O(1)\)</span> . The effective Hamiltonian at the iteration <span class="arithmatex">\(\ell\)</span> is given by</p>
<div class="arithmatex">\[
  {\hat{H} }_{\ell } =\sum_{\alpha } E_{\alpha }^{\ell } |\alpha \rangle_{\ell \ell } \langle {\alpha} |, 
\]</div>
<p>where <span class="arithmatex">\(|\alpha \rangle_{\ell }\)</span> are energy eigenstates (including both kept and discarded states) at the iteration <span class="arithmatex">\(\ell\)</span> and <span class="arithmatex">\(E_{\alpha }^{\ell }\)</span> are the corresponding energy eigenvalue. Then the effective density matrix for the iteration <span class="arithmatex">\(\ell\)</span> can be constructed as</p>
<div class="arithmatex">\[
 {\hat{\rho} }_{\ell } =\sum_{\alpha } E_{\alpha }^{\ell } |\alpha \rangle_{\ell \ell } \langle {\alpha} |\frac{\exp \left(-E_{\alpha }^{\ell } /T_{\ell } \right)}{Z_{\ell } }, 
\]</div>
<p>where <span class="arithmatex">\(Z_{\ell } =\sum_{\alpha } \exp \left(-E_{\alpha }^{\ell } /T_{\ell } \right)\)</span> is the partition function. The spin susceptibility is given by the variance of the spin- <span class="arithmatex">\(z\)</span> operator divided by temperature,</p>
<div class="arithmatex">\[
 T_{\ell } \,\chi (T_{\ell } )={\mathrm{T}\mathrm{r}}\left({\hat{\rho} }_{\ell } ({\hat{S} }_{&lt;\ell ,z} )^2 \right)-{\left({\mathrm{T}\mathrm{r}}\left({\hat{\rho} }_{\ell } {\hat{S} }_{&lt;\ell ,z} \right)\right)}^2 , 
\]</div>
<p>where <span class="arithmatex">\({\hat{S} }_{&lt;\ell ,z} =\sum_{m\le \ell } {\hat{S} }_{mz}\)</span> is the sum of spin-z operators acting on all the chain sites left from the site <span class="arithmatex">\(\ell\)</span> (including the site <span class="arithmatex">\(\ell\)</span> also). And the entropy is given by</p>
<div class="arithmatex">\[
  S(T_{\ell } )=\frac{{\mathrm{T}\mathrm{r}}\left({\hat{\rho} }_{\ell } {\hat{H} }_{\ell } \right)}{T_{\ell } }+\ln Z_{\ell } . 
\]</div>
<p>For details, refer to Sec. III.A.1 of [<a href="https://journals.aps.org/rmp/abstract/10.1103/RevModPhys.80.395">R. Bulla et al., Rev. Mod. Phys. <strong>80</strong>, 395 (2008)</a> or <a href="https://arxiv.org/abs/cond-mat/0701105">its arXiv version</a>].</p>
<!-- Exercise 1: Complete <samp>getTDconvQS_Ex.m</samp>

There is a function <samp>getTDconvQS_Ex.m</samp> which is zipped together with this document. The function is designed to compute the spin susceptibility (multiplied with temperature) $T_{\ell } \chi (T_{\ell } )$ and the entropy $S(T_{\ell } )$ at every iteration $\ell$ corresponding to temperature $T_{\ell }$ .  **Complete the parts which are enclosed by the comments** **<samp>TODO - Exercise 1</samp>**. -->
<blockquote>
<p>The function <a href="../codes/getTDconvQS.m">getTDconvQS.m</a> is designed to compute the spin susceptibility (multiplied with temperature) <span class="arithmatex">\(T_{\ell } \chi (T_{\ell } )\)</span> and the entropy <span class="arithmatex">\(S(T_{\ell } )\)</span> at every iteration <span class="arithmatex">\(\ell\)</span> corresponding to temperature <span class="arithmatex">\(T_{\ell }\)</span> .</p>
</blockquote>
<h2 id="single-impurity-anderson-model-siam"><strong>Single-impurity Anderson model (SIAM)</strong></h2>
<p>As a demonstartion of getTDconv.m, we compute the spin susceptibility <span class="arithmatex">\(\chi_{{\mathrm{t}\mathrm{o}\mathrm{t}}}\)</span> and the entropy <span class="arithmatex">\(S_{{\mathrm{t}\mathrm{o}\mathrm{t}}}\)</span> for <strong>the whole SIAM</strong>. Here we choose the same parameters as in the last tutorial T10.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nb">clear</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="c">% Hamiltonian parameters</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">U</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">4e-3</span><span class="p">;</span><span class="w"> </span><span class="c">% Coulomb interaction at the impurity</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">epsd</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="c">% impurity on-site energy</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">Gamma</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">8e-5</span><span class="o">*</span><span class="nb">pi</span><span class="p">;</span><span class="w"> </span><span class="c">% hybridization strength</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="c">% NRG parameters</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">Lambda</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">2.5</span><span class="p">;</span><span class="w"> </span><span class="c">% discretization parameter</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">N</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">55</span><span class="p">;</span><span class="w"> </span><span class="c">% length of the Wilson chain</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">Nkeep</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">300</span><span class="p">;</span>
</span></code></pre></div>
<p>For this tutorial, we perform a post-processing of the Wilson chain parameters after they are generated by the <samp>doCLD</samp> function. This post-processing is needed to reduce numerical noise, since the calculation of the impurity contributions to thermodynamic properties is sensitive to the noise. The reason for this sensitivity will be explained later at the end of this document.</p>
<p>The <samp>doCLD</samp> function uses numerical integration for determining the positions and the coupling strengths of discretized levels in a star geometry. So these values of the discretized levels are susceptible to numerical error whose size is proportional to the values themselves. The position and the coupling strength of the level from the outmost discretization interval is much larger, by many orders of maginutes, than those from the nearest discretization interval to the Fermi level (which are finite, due to the finite number of discretization intervals in numerical implementation). Thus relatively small numerical error for the outmost interval can have significant size for the low-energy intervals.</p>
<p>The Lanczos tridiagonalization which follows the numerical integration is also susceptible to numerical noise. Especially, the noise is accumulated via successive orthogonalization. As a result, the Wilson chain parameters for later sites have small but finite error.</p>
<p>To overcome the inevitable numerical error, we extrapolate the hopping amplitudes for later sites from the values for earlier sites, based on the scaling behavior <span class="arithmatex">\(t_{\ell } \propto\Lambda^{-\ell /2}\)</span> for large enough <span class="arithmatex">\(\ell\)</span> . Also, we set the on-site energyes as strict zero, which is always true for the particle-hole symmetric bath such that <span class="arithmatex">\(\Delta (\omega )=\Delta (-\omega )\)</span> .</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c">% Wilson chain</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="p">[</span><span class="n">ff</span><span class="p">,</span><span class="o">~</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">doCLD</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Gamma</span><span class="o">/</span><span class="nb">pi</span><span class="p">,</span><span class="n">Lambda</span><span class="p">,</span><span class="mi">30</span><span class="p">);</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="n">ff</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="n">ff</span><span class="p">;</span><span class="n">ff</span><span class="p">(</span><span class="k">end</span><span class="p">)</span><span class="o">.*</span><span class="p">(</span><span class="n">Lambda</span><span class="o">.^</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="p">:(</span><span class="n">N</span><span class="o">-</span><span class="nb">numel</span><span class="p">(</span><span class="n">ff</span><span class="p">))).</span><span class="o">&#39;/</span><span class="mi">2</span><span class="p">))];</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="n">gg</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">ff</span><span class="p">));</span>
</span></code></pre></div>
<p>The rest is the same for the iterative diagonalization.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c">% symmetries</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">symstr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;Acharge,SU2spin&#39;</span><span class="p">;</span><span class="w"> </span><span class="c">% U(1) charge and SU(2) spin</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="c">% symstr = &#39;Acharge,Aspin&#39;; % U(1) charge and U(1) spin</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="c">% Construct local operators</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="p">[</span><span class="n">F</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">I</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getLocalSpace</span><span class="p">(</span><span class="s">&#39;FermionS&#39;</span><span class="p">,</span><span class="n">symstr</span><span class="p">,</span><span class="s">&#39;NC&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="p">[</span><span class="n">F</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">EF</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">setItag</span><span class="p">(</span><span class="s">&#39;s00&#39;</span><span class="p">,</span><span class="s">&#39;op&#39;</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">);</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="c">% particle number operator</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="n">NF</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">QSpace</span><span class="p">;</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="k">for</span><span class="w"> </span><span class="n">itF</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">numel</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="w">    </span><span class="n">NF</span><span class="p">(</span><span class="n">itF</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">contract</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">itF</span><span class="p">),</span><span class="s">&#39;!2*&#39;</span><span class="p">,</span><span class="n">F</span><span class="p">(</span><span class="n">itF</span><span class="p">));</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="k">end</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="c">% Impurity Hamiltonian</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="n">H0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">U</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">NF</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">NF</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">epsd</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">NF</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1e-33</span><span class="o">*</span><span class="n">EF</span><span class="p">;</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a><span class="c">% ket tensor for the impurity</span>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="n">A0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getIdentity</span><span class="p">(</span><span class="n">setItag</span><span class="p">(</span><span class="s">&#39;L00&#39;</span><span class="p">,</span><span class="n">getvac</span><span class="p">(</span><span class="n">EF</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span><span class="mi">1</span><span class="p">,</span><span class="n">EF</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;K00&#39;</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]);</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a><span class="n">H0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">contract</span><span class="p">(</span><span class="n">A0</span><span class="p">,</span><span class="s">&#39;!2*&#39;</span><span class="p">,{</span><span class="n">A0</span><span class="p">,</span><span class="n">H0</span><span class="p">});</span>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a><span class="c">% same hopping amplitude and on-site energies for all flavors</span>
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a><span class="n">ff</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">repmat</span><span class="p">(</span><span class="n">ff</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="nb">numel</span><span class="p">(</span><span class="n">F</span><span class="p">)]);</span>
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a><span class="n">gg</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">repmat</span><span class="p">(</span><span class="n">gg</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="nb">numel</span><span class="p">(</span><span class="n">F</span><span class="p">)]);</span>
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a>
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a><span class="c">% iterative diagonalization</span>
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a><span class="n">Inrg</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">NRG_IterDiagQS</span><span class="p">(</span><span class="n">H0</span><span class="p">,</span><span class="n">A0</span><span class="p">,</span><span class="n">Lambda</span><span class="p">,</span><span class="n">ff</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">gg</span><span class="p">,</span><span class="n">NF</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">Nkeep</span><span class="p">);</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>21-05-10 17:11:26 | NRG: start
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>21-05-10 17:11:26 | #00/55 : NK=3/3, EK=1e-33/1e-33
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>21-05-10 17:11:26 | #01/55 : NK=10/10, EK=0.04891/0.04891
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>21-05-10 17:11:26 | #02/55 : NK=35/35, EK=3.207/3.207
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>21-05-10 17:11:26 | #03/55 : NK=126/126, EK=6.221/6.221
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>21-05-10 17:11:26 | #04/55 : NK=310/462, EK=7.494/13.01
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>21-05-10 17:11:26 | #05/55 : NK=310/1154, EK=7.028/13.07
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>21-05-10 17:11:26 | #06/55 : NK=318/1150, EK=7.238/13.61
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>21-05-10 17:11:27 | #07/55 : NK=310/1178, EK=7.043/13.08
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>21-05-10 17:11:27 | #08/55 : NK=318/1150, EK=7.244/13.61
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>21-05-10 17:11:27 | #09/55 : NK=310/1178, EK=7.068/13.12
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>21-05-10 17:11:27 | #10/55 : NK=318/1150, EK=7.27/13.59
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>21-05-10 17:11:27 | #11/55 : NK=310/1178, EK=7.112/13.18
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>21-05-10 17:11:27 | #12/55 : NK=318/1150, EK=7.354/13.58
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>21-05-10 17:11:27 | #13/55 : NK=310/1178, EK=7.202/13.32
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>21-05-10 17:11:27 | #14/55 : NK=322/1150, EK=7.684/13.89
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>21-05-10 17:11:27 | #15/55 : NK=312/1192, EK=7.455/13.81
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>21-05-10 17:11:28 | #16/55 : NK=327/1166, EK=8.38/14.69
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>21-05-10 17:11:28 | #17/55 : NK=304/1218, EK=8.445/14.97
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>21-05-10 17:11:28 | #18/55 : NK=307/1136, EK=9.021/16.03
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>21-05-10 17:11:28 | #19/55 : NK=312/1148, EK=9.324/16.01
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a>21-05-10 17:11:28 | #20/55 : NK=311/1170, EK=9.713/17.49
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>21-05-10 17:11:28 | #21/55 : NK=327/1174, EK=9.798/17.17
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a>21-05-10 17:11:28 | #22/55 : NK=311/1231, EK=9.775/18.24
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a>21-05-10 17:11:28 | #23/55 : NK=302/1174, EK=9.745/17.31
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a>21-05-10 17:11:28 | #24/55 : NK=311/1134, EK=9.83/17.87
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a>21-05-10 17:11:28 | #25/55 : NK=322/1174, EK=9.973/17.45
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a>21-05-10 17:11:29 | #26/55 : NK=311/1210, EK=9.91/18.34
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a>21-05-10 17:11:29 | #27/55 : NK=322/1174, EK=10.12/17.63
</span><span id="__span-3-30"><a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a>21-05-10 17:11:29 | #28/55 : NK=325/1210, EK=10.17/18.31
</span><span id="__span-3-31"><a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a>21-05-10 17:11:29 | #29/55 : NK=322/1224, EK=10.33/18.22
</span><span id="__span-3-32"><a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a>21-05-10 17:11:29 | #30/55 : NK=315/1210, EK=10.19/18.34
</span><span id="__span-3-33"><a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a>21-05-10 17:11:29 | #31/55 : NK=322/1184, EK=10.64/18.35
</span><span id="__span-3-34"><a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a>21-05-10 17:11:29 | #32/55 : NK=303/1210, EK=10.33/18.75
</span><span id="__span-3-35"><a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a>21-05-10 17:11:29 | #33/55 : NK=300/1136, EK=10.78/18.8
</span><span id="__span-3-36"><a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a>21-05-10 17:11:29 | #34/55 : NK=318/1122, EK=10.93/18.83
</span><span id="__span-3-37"><a id="__codelineno-3-37" name="__codelineno-3-37" href="#__codelineno-3-37"></a>21-05-10 17:11:29 | #35/55 : NK=300/1190, EK=11.32/19.87
</span><span id="__span-3-38"><a id="__codelineno-3-38" name="__codelineno-3-38" href="#__codelineno-3-38"></a>21-05-10 17:11:30 | #36/55 : NK=301/1119, EK=11.16/19.38
</span><span id="__span-3-39"><a id="__codelineno-3-39" name="__codelineno-3-39" href="#__codelineno-3-39"></a>21-05-10 17:11:30 | #37/55 : NK=316/1118, EK=11.93/20.39
</span><span id="__span-3-40"><a id="__codelineno-3-40" name="__codelineno-3-40" href="#__codelineno-3-40"></a>21-05-10 17:11:30 | #38/55 : NK=306/1175, EK=11.6/20.39
</span><span id="__span-3-41"><a id="__codelineno-3-41" name="__codelineno-3-41" href="#__codelineno-3-41"></a>21-05-10 17:11:30 | #39/55 : NK=310/1136, EK=12.08/21.48
</span><span id="__span-3-42"><a id="__codelineno-3-42" name="__codelineno-3-42" href="#__codelineno-3-42"></a>21-05-10 17:11:30 | #40/55 : NK=306/1151, EK=11.75/20.69
</span><span id="__span-3-43"><a id="__codelineno-3-43" name="__codelineno-3-43" href="#__codelineno-3-43"></a>21-05-10 17:11:30 | #41/55 : NK=307/1136, EK=11.97/21.77
</span><span id="__span-3-44"><a id="__codelineno-3-44" name="__codelineno-3-44" href="#__codelineno-3-44"></a>21-05-10 17:11:30 | #42/55 : NK=306/1139, EK=11.82/20.13
</span><span id="__span-3-45"><a id="__codelineno-3-45" name="__codelineno-3-45" href="#__codelineno-3-45"></a>21-05-10 17:11:30 | #43/55 : NK=309/1136, EK=12.19/21.89
</span><span id="__span-3-46"><a id="__codelineno-3-46" name="__codelineno-3-46" href="#__codelineno-3-46"></a>21-05-10 17:11:31 | #44/55 : NK=306/1147, EK=11.84/20.87
</span><span id="__span-3-47"><a id="__codelineno-3-47" name="__codelineno-3-47" href="#__codelineno-3-47"></a>21-05-10 17:11:31 | #45/55 : NK=309/1136, EK=12.21/21.94
</span><span id="__span-3-48"><a id="__codelineno-3-48" name="__codelineno-3-48" href="#__codelineno-3-48"></a>21-05-10 17:11:31 | #46/55 : NK=306/1147, EK=11.85/20.89
</span><span id="__span-3-49"><a id="__codelineno-3-49" name="__codelineno-3-49" href="#__codelineno-3-49"></a>21-05-10 17:11:31 | #47/55 : NK=309/1136, EK=12.21/21.96
</span><span id="__span-3-50"><a id="__codelineno-3-50" name="__codelineno-3-50" href="#__codelineno-3-50"></a>21-05-10 17:11:31 | #48/55 : NK=306/1147, EK=11.86/20.89
</span><span id="__span-3-51"><a id="__codelineno-3-51" name="__codelineno-3-51" href="#__codelineno-3-51"></a>21-05-10 17:11:31 | #49/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-3-52"><a id="__codelineno-3-52" name="__codelineno-3-52" href="#__codelineno-3-52"></a>21-05-10 17:11:31 | #50/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-3-53"><a id="__codelineno-3-53" name="__codelineno-3-53" href="#__codelineno-3-53"></a>21-05-10 17:11:31 | #51/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-3-54"><a id="__codelineno-3-54" name="__codelineno-3-54" href="#__codelineno-3-54"></a>21-05-10 17:11:31 | #52/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-3-55"><a id="__codelineno-3-55" name="__codelineno-3-55" href="#__codelineno-3-55"></a>21-05-10 17:11:32 | #53/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-3-56"><a id="__codelineno-3-56" name="__codelineno-3-56" href="#__codelineno-3-56"></a>21-05-10 17:11:32 | #54/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-3-57"><a id="__codelineno-3-57" name="__codelineno-3-57" href="#__codelineno-3-57"></a>21-05-10 17:11:32 | #55/55 : NK=0/1136, EK=0/21.97
</span><span id="__span-3-58"><a id="__codelineno-3-58" name="__codelineno-3-58" href="#__codelineno-3-58"></a>21-05-10 17:11:32 | Memory usage : 3.41GiB
</span><span id="__span-3-59"><a id="__codelineno-3-59" name="__codelineno-3-59" href="#__codelineno-3-59"></a>Elapsed time: 5.765s, CPU time: 13.74s, Avg # of cores: 2.383
</span></code></pre></div>
<p>Now we compute the thermodynamic quantities for the whole impurity model (impurity + bath). We use the temperature prefactor parameter <span class="arithmatex">\(\beta_0 =1\)</span> .</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">beta0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c">% parameter to define temperature values</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="p">[</span><span class="n">T</span><span class="p">,</span><span class="n">Tchi</span><span class="p">,</span><span class="n">Sent</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getTDconvQS</span><span class="p">(</span><span class="n">Inrg</span><span class="p">,</span><span class="n">beta0</span><span class="p">);</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="c">% temperature T, T * spin susceptibility chi, entropy S</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="nb">figure</span><span class="p">;</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="n">hold</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="nb">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">Tchi</span><span class="p">,</span><span class="s">&#39;LineStyle&#39;</span><span class="p">,</span><span class="s">&#39;-&#39;</span><span class="p">,</span><span class="s">&#39;Marker&#39;</span><span class="p">,</span><span class="s">&#39;x&#39;</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="nb">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">Sent</span><span class="p">,</span><span class="s">&#39;LineStyle&#39;</span><span class="p">,</span><span class="s">&#39;-&#39;</span><span class="p">,</span><span class="s">&#39;Marker&#39;</span><span class="p">,</span><span class="s">&#39;+&#39;</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="n">hold</span><span class="w"> </span><span class="s">off</span><span class="p">;</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="nb">set</span><span class="p">(</span><span class="nb">gca</span><span class="p">,</span><span class="s">&#39;XScale&#39;</span><span class="p">,</span><span class="s">&#39;log&#39;</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;FontSize&#39;</span><span class="p">,</span><span class="mi">13</span><span class="p">);</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="nb">legend</span><span class="p">({</span><span class="s">&#39; $T \chi$ &#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39; $S$ &#39;</span><span class="p">},</span><span class="w"> </span><span class="k">...</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="w">    </span><span class="s">&#39;Interpreter&#39;</span><span class="p">,</span><span class="s">&#39;latex&#39;</span><span class="p">,</span><span class="s">&#39;Location&#39;</span><span class="p">,</span><span class="s">&#39;northwest&#39;</span><span class="p">);</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39; $T$ &#39;</span><span class="p">,</span><span class="s">&#39;Interpreter&#39;</span><span class="p">,</span><span class="s">&#39;latex&#39;</span><span class="p">);</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="nb">title</span><span class="p">(</span><span class="s">&#39;Impurity + bath&#39;</span><span class="p">);</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="nb">xlim</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="n">T</span><span class="p">)]);</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="n">grid</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
</span></code></pre></div>
<p align="center">
  <img src="../images/imp+bath.png" alt="Alt Text" width = "70%">
</p>

<h2 id="thermodynamic-properties-of-the-bath-only"><strong>Thermodynamic properties of the bath only</strong></h2>
<p>Then we compute the same properties when there is no impurity in the system. The simplest way is to apply large on-site potential to the impurity which effectively empties out the impurity. By using the same functions except for the large on-site potential, the results are given on the same temperature grid.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c">% &quot;without&quot; impurity</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="n">H0_2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">1e4</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">NF</span><span class="p">);</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="n">H0_2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">contract</span><span class="p">(</span><span class="n">A0</span><span class="p">,</span><span class="s">&#39;!2*&#39;</span><span class="p">,{</span><span class="n">A0</span><span class="p">,</span><span class="n">H0_2</span><span class="p">})</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1e-33</span><span class="o">*</span><span class="n">contract</span><span class="p">(</span><span class="n">A0</span><span class="p">,</span><span class="s">&#39;!2*&#39;</span><span class="p">,</span><span class="n">A0</span><span class="p">);</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="c">% take the impurity level epsd to be far above the band edge (epsd &gt;&gt; 1);</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="c">% effectively emptied out</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="n">Inrg2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">NRG_IterDiagQS</span><span class="p">(</span><span class="n">H0_2</span><span class="p">,</span><span class="n">A0</span><span class="p">,</span><span class="n">Lambda</span><span class="p">,</span><span class="n">ff</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">gg</span><span class="p">,</span><span class="n">NF</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">Nkeep</span><span class="p">);</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>21-05-10 17:11:33 | NRG: start
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>21-05-10 17:11:33 | #00/55 : NK=3/3, EK=2e+04/2e+04
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>21-05-10 17:11:33 | #01/55 : NK=10/10, EK=1.932e+04/1.932e+04
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>21-05-10 17:11:33 | #02/55 : NK=35/35, EK=3.055e+04/3.055e+04
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>21-05-10 17:11:33 | #03/55 : NK=126/126, EK=4.83e+04/4.83e+04
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>21-05-10 17:11:33 | #04/55 : NK=326/462, EK=3.819e+04/7.637e+04
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>21-05-10 17:11:33 | #05/55 : NK=310/1216, EK=12.48/6.038e+04
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>21-05-10 17:11:33 | #06/55 : NK=309/1154, EK=12.22/23.03
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>21-05-10 17:11:34 | #07/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>21-05-10 17:11:34 | #08/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>21-05-10 17:11:34 | #09/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>21-05-10 17:11:34 | #10/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>21-05-10 17:11:34 | #11/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>21-05-10 17:11:34 | #12/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>21-05-10 17:11:34 | #13/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>21-05-10 17:11:34 | #14/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>21-05-10 17:11:34 | #15/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>21-05-10 17:11:35 | #16/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>21-05-10 17:11:35 | #17/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>21-05-10 17:11:35 | #18/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a>21-05-10 17:11:35 | #19/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a>21-05-10 17:11:35 | #20/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a>21-05-10 17:11:35 | #21/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a>21-05-10 17:11:35 | #22/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a>21-05-10 17:11:35 | #23/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-6-26"><a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a>21-05-10 17:11:35 | #24/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-6-27"><a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a>21-05-10 17:11:36 | #25/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-6-28"><a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a>21-05-10 17:11:36 | #26/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-6-29"><a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a>21-05-10 17:11:36 | #27/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-6-30"><a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a>21-05-10 17:11:36 | #28/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-6-31"><a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a>21-05-10 17:11:36 | #29/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-6-32"><a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a>21-05-10 17:11:36 | #30/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-6-33"><a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a>21-05-10 17:11:36 | #31/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-6-34"><a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a>21-05-10 17:11:36 | #32/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-6-35"><a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a>21-05-10 17:11:36 | #33/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-6-36"><a id="__codelineno-6-36" name="__codelineno-6-36" href="#__codelineno-6-36"></a>21-05-10 17:11:36 | #34/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-6-37"><a id="__codelineno-6-37" name="__codelineno-6-37" href="#__codelineno-6-37"></a>21-05-10 17:11:37 | #35/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-6-38"><a id="__codelineno-6-38" name="__codelineno-6-38" href="#__codelineno-6-38"></a>21-05-10 17:11:37 | #36/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-6-39"><a id="__codelineno-6-39" name="__codelineno-6-39" href="#__codelineno-6-39"></a>21-05-10 17:11:37 | #37/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-6-40"><a id="__codelineno-6-40" name="__codelineno-6-40" href="#__codelineno-6-40"></a>21-05-10 17:11:37 | #38/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-6-41"><a id="__codelineno-6-41" name="__codelineno-6-41" href="#__codelineno-6-41"></a>21-05-10 17:11:37 | #39/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-6-42"><a id="__codelineno-6-42" name="__codelineno-6-42" href="#__codelineno-6-42"></a>21-05-10 17:11:37 | #40/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-6-43"><a id="__codelineno-6-43" name="__codelineno-6-43" href="#__codelineno-6-43"></a>21-05-10 17:11:37 | #41/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-6-44"><a id="__codelineno-6-44" name="__codelineno-6-44" href="#__codelineno-6-44"></a>21-05-10 17:11:37 | #42/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-6-45"><a id="__codelineno-6-45" name="__codelineno-6-45" href="#__codelineno-6-45"></a>21-05-10 17:11:37 | #43/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-6-46"><a id="__codelineno-6-46" name="__codelineno-6-46" href="#__codelineno-6-46"></a>21-05-10 17:11:38 | #44/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-6-47"><a id="__codelineno-6-47" name="__codelineno-6-47" href="#__codelineno-6-47"></a>21-05-10 17:11:38 | #45/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-6-48"><a id="__codelineno-6-48" name="__codelineno-6-48" href="#__codelineno-6-48"></a>21-05-10 17:11:38 | #46/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-6-49"><a id="__codelineno-6-49" name="__codelineno-6-49" href="#__codelineno-6-49"></a>21-05-10 17:11:38 | #47/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-6-50"><a id="__codelineno-6-50" name="__codelineno-6-50" href="#__codelineno-6-50"></a>21-05-10 17:11:38 | #48/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-6-51"><a id="__codelineno-6-51" name="__codelineno-6-51" href="#__codelineno-6-51"></a>21-05-10 17:11:38 | #49/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-6-52"><a id="__codelineno-6-52" name="__codelineno-6-52" href="#__codelineno-6-52"></a>21-05-10 17:11:38 | #50/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-6-53"><a id="__codelineno-6-53" name="__codelineno-6-53" href="#__codelineno-6-53"></a>21-05-10 17:11:38 | #51/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-6-54"><a id="__codelineno-6-54" name="__codelineno-6-54" href="#__codelineno-6-54"></a>21-05-10 17:11:38 | #52/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-6-55"><a id="__codelineno-6-55" name="__codelineno-6-55" href="#__codelineno-6-55"></a>21-05-10 17:11:38 | #53/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-6-56"><a id="__codelineno-6-56" name="__codelineno-6-56" href="#__codelineno-6-56"></a>21-05-10 17:11:39 | #54/55 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-6-57"><a id="__codelineno-6-57" name="__codelineno-6-57" href="#__codelineno-6-57"></a>21-05-10 17:11:39 | #55/55 : NK=0/1147, EK=0/20.9
</span><span id="__span-6-58"><a id="__codelineno-6-58" name="__codelineno-6-58" href="#__codelineno-6-58"></a>21-05-10 17:11:39 | Memory usage : 3.45GiB
</span><span id="__span-6-59"><a id="__codelineno-6-59" name="__codelineno-6-59" href="#__codelineno-6-59"></a>Elapsed time: 5.599s, CPU time: 13.21s, Avg # of cores: 2.359
</span></code></pre></div>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="p">[</span><span class="o">~</span><span class="p">,</span><span class="n">Tchi2</span><span class="p">,</span><span class="n">Sent2</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getTDconvQS</span><span class="p">(</span><span class="n">Inrg2</span><span class="p">,</span><span class="n">beta0</span><span class="p">);</span>
</span></code></pre></div>
<p>Plot the obtained data. The values show simpler temperature dependence than those of the whole impurity system.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nb">figure</span><span class="p">;</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="n">hold</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="nb">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">Tchi2</span><span class="p">,</span><span class="s">&#39;LineStyle&#39;</span><span class="p">,</span><span class="s">&#39;-&#39;</span><span class="p">,</span><span class="s">&#39;Marker&#39;</span><span class="p">,</span><span class="s">&#39;x&#39;</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="nb">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">Sent2</span><span class="p">,</span><span class="s">&#39;LineStyle&#39;</span><span class="p">,</span><span class="s">&#39;-&#39;</span><span class="p">,</span><span class="s">&#39;Marker&#39;</span><span class="p">,</span><span class="s">&#39;+&#39;</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="n">hold</span><span class="w"> </span><span class="s">off</span><span class="p">;</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="nb">set</span><span class="p">(</span><span class="nb">gca</span><span class="p">,</span><span class="s">&#39;XScale&#39;</span><span class="p">,</span><span class="s">&#39;log&#39;</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;FontSize&#39;</span><span class="p">,</span><span class="mi">13</span><span class="p">);</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="nb">legend</span><span class="p">({</span><span class="s">&#39; $T \chi$ &#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39; $S$ &#39;</span><span class="p">},</span><span class="w"> </span><span class="k">...</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="w">    </span><span class="s">&#39;Interpreter&#39;</span><span class="p">,</span><span class="s">&#39;latex&#39;</span><span class="p">,</span><span class="s">&#39;Location&#39;</span><span class="p">,</span><span class="s">&#39;west&#39;</span><span class="p">);</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39; $T$ &#39;</span><span class="p">,</span><span class="s">&#39;Interpreter&#39;</span><span class="p">,</span><span class="s">&#39;latex&#39;</span><span class="p">);</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="nb">title</span><span class="p">(</span><span class="s">&#39;Bath only&#39;</span><span class="p">);</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="nb">xlim</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="n">T</span><span class="p">)]);</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="n">grid</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
</span></code></pre></div>
<p align="center">
  <img src="../images/bath-only.png" alt="Alt Text" width = "70%">
</p>

<h2 id="impurity-contribution"><strong>Impurity contribution</strong></h2>
<p>Subtract the values for the bath only from those for the whole impurity model, to obtain the impurity contribution.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c">% impurity contribution to the spin susceptibility * temperature</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="n">Tchi_imp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Tchi</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Tchi2</span><span class="p">;</span><span class="w"> </span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="c">% impurity contribution to the entropy</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="n">Sent_imp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Sent</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Sent2</span><span class="p">;</span>
</span></code></pre></div>
<p>The specific heat can be obtained by differentiating the entropy,</p>
<p>$$ C=T\frac{{\mathrm{d}}S}{{\mathrm{d}}T}=\frac{{\mathrm{d}}S}{{\mathrm{d}}(\ln T)}. $$ 
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">logT</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">log</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="c">% impurity contribution to the specific heat C = T* dS/dT = dS / d(log T)</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="c">% numerical differentiation</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="n">C_imp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">interp1</span><span class="p">((</span><span class="n">logT</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">logT</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">    </span><span class="nb">diff</span><span class="p">(</span><span class="n">Sent_imp</span><span class="p">)</span><span class="o">./</span><span class="nb">diff</span><span class="p">(</span><span class="n">logT</span><span class="p">),</span><span class="n">logT</span><span class="p">,</span><span class="s">&#39;linear&#39;</span><span class="p">,</span><span class="s">&#39;extrap&#39;</span><span class="p">);</span>
</span></code></pre></div></p>
<p>Then we obtain the SommerfeldWilson ratio.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c">% Sommerfeld-Wilson ratio</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="n">WR</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">Tchi_imp</span><span class="o">./</span><span class="n">C_imp</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="nb">pi</span>^<span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">);</span>
</span></code></pre></div>
<p>The characteritic temperature scale of the Kondo regime is, literally, the Kondo temperature <span class="arithmatex">\(T_{{\mathrm{K}}}\)</span> . The Kondo temperature is the energy scale at which the crossover to the Kondo regime happens. Since the crossover is a smooth change, there are different ways to define the Kondo temperature, which give similar but different values. In this analysis, we use the formula given by the Bethe ansatz solution:</p>
<div class="arithmatex">\[
 T_{{\mathrm{K}}} =\sqrt{\frac{U\Gamma }{2}}\exp \left(-\frac{\pi U}{8\Gamma }+\frac{\pi \Gamma }{2U}\right) 
\]</div>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c">% Kondo temperature from the Bethe ansatz</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="n">TK</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="n">U</span><span class="o">*</span><span class="n">Gamma</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="nb">pi</span><span class="o">*</span><span class="n">U</span><span class="o">/</span><span class="mi">8</span><span class="o">/</span><span class="n">Gamma</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">pi</span><span class="o">*</span><span class="n">Gamma</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">U</span><span class="p">);</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="nb">disp</span><span class="p">(</span><span class="n">TK</span><span class="p">);</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>1.5106e-06
</span></code></pre></div>
<p>Plot the result.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="nb">figure</span><span class="p">;</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="nb">semilogx</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">TK</span><span class="p">,(</span><span class="n">Tchi_imp</span><span class="o">./</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">TK</span><span class="p">),</span><span class="w"> </span><span class="k">...</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">    </span><span class="n">T</span><span class="o">/</span><span class="n">TK</span><span class="p">,</span><span class="n">Sent_imp</span><span class="o">/</span><span class="nb">log</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="k">...</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w">    </span><span class="n">T</span><span class="o">/</span><span class="n">TK</span><span class="p">,</span><span class="n">WR</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="nb">set</span><span class="p">(</span><span class="nb">gca</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;FontSize&#39;</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="s">&#39;XTick&#39;</span><span class="p">,</span><span class="mf">10.</span>^<span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">));</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39; $T / T_\mathrm{K}$ &#39;</span><span class="p">,</span><span class="s">&#39;Interpreter&#39;</span><span class="p">,</span><span class="s">&#39;latex&#39;</span><span class="p">);</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="nb">legend</span><span class="p">({</span><span class="s">&#39; $4 T_\mathrm{K} \chi_\mathrm{imp}$ &#39;</span><span class="p">;</span><span class="w"> </span><span class="k">...</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="w">    </span><span class="s">&#39; $S_\mathrm{imp} / \ln 2$ &#39;</span><span class="p">;</span><span class="w"> </span><span class="k">...</span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="w">    </span><span class="s">&#39; $R$ &#39;</span><span class="p">},</span><span class="w"> </span><span class="k">...</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="w">    </span><span class="s">&#39;Interpreter&#39;</span><span class="p">,</span><span class="s">&#39;latex&#39;</span><span class="p">,</span><span class="s">&#39;Location&#39;</span><span class="p">,</span><span class="s">&#39;northeast&#39;</span><span class="p">);</span>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="nb">ylim</span><span class="p">([</span><span class="mi">0</span><span class="w"> </span><span class="mi">3</span><span class="p">]);</span>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="nb">xlim</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="n">T</span><span class="p">)]</span><span class="o">/</span><span class="n">TK</span><span class="p">);</span>
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="n">grid</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
</span></code></pre></div>
<p align="center">
  <img src="../images/chi.png" alt="Alt Text" width = "70%">
</p>

<p>At <span class="arithmatex">\(T\ll T_{{\mathrm{K}}}\)</span> , the SommerfeldWilson ratio <span class="arithmatex">\(R\)</span> becomes 2, up to 3% error. The impurity contribution to the entropy <span class="arithmatex">\(S_{{\mathrm{i}\mathrm{m}\mathrm{p}}}\)</span> is <span class="arithmatex">\(\ln 4\)</span> at high temperature <span class="arithmatex">\(T\gg U\)</span> , then decreases to <span class="arithmatex">\(\ln 2\)</span> , and then finally vanishes at temperatures <span class="arithmatex">\(T\ll T_{{\mathrm{K}}}\)</span> . These values indeed represent the nature of different fixed-point regimes:</p>
<ol>
<li>Free orbital regime: At <span class="arithmatex">\(T\gg U\)</span> , all four states of the impurity can be populated, so the presence of the impurity adds up <span class="arithmatex">\(\ln 4\)</span> to the entropy.</li>
<li>Local moment regime: At <span class="arithmatex">\(T_{{\mathrm{K}}} \ll T\ll U\)</span> , only the singly occupied states of the impurity can be populated. So the impurity contribution is <span class="arithmatex">\(\ln 2\)</span> , for two impurity states of <span class="arithmatex">\(S_{d,z} =\pm 1/2\)</span> .</li>
<li>Strong coupling regime: At <span class="arithmatex">\(T\ll T_{{\mathrm{K}}}\)</span> , the impurity spin and the bath form the Kondo singlet. The impurity state is locked into the bath state; the impurity and the bath are quantum entangled. Thus there is no additional entropy by the presence of the impurity.</li>
</ol>
<p>There are a few technical remarks.</p>
<ol>
<li>The values of <span class="arithmatex">\(T\chi\)</span> and <span class="arithmatex">\(S\)</span> , for the whole impurity system and for the bath only, depend on the choice of <span class="arithmatex">\(\beta_0\)</span> . However, their subtractions <span class="arithmatex">\(T\chi_{{\mathrm{i}\mathrm{m}\mathrm{p}}}\)</span> and <span class="arithmatex">\(S_{{\mathrm{i}\mathrm{m}\mathrm{p}}}\)</span> do not change much with changing <span class="arithmatex">\(\beta_0\)</span> . (<strong>Quick exercise:</strong> try out different values of <span class="arithmatex">\(\beta_0\)</span> .)</li>
<li>There is a kink in the curve of the SommerfeldWilson ratio at the lowest temperatures ( <span class="arithmatex">\(T\sim 10^{-5} T_{{\mathrm{K}}}\)</span> ). This is a numerical noise. The SommerfeldWilson ratio at such temperatures is given by the ratio between two small values, and each small value is given by the subtraction of two large values (one for the whole impurity and the other for the bath only). For example, <samp>Tchi(end)</samp> and <samp>Tchi2(end)</samp> are <span class="arithmatex">\(O(0.1)\)</span> , but their difference, <samp>Tchi_imp(end)</samp> is just <span class="arithmatex">\(O(10^{-6} )\)</span> . That's why we have performed the post-processing of the Wilson chain paramers above.</li>
</ol>
<blockquote>
<p><strong>Exercise</strong>: Single-impurity Kondo model</p>
</blockquote>
<p>Compute the theremodynamic properties for the single-impurity Kondo model, for the value of <span class="arithmatex">\(J=8\Gamma D/\pi U\)</span> , considering the same values of <span class="arithmatex">\(\Gamma\)</span> and <span class="arithmatex">\(U\)</span> used in the above demonstration. Compare your result with Fig. 5 in [<a href="https://journals.aps.org/rmp/abstract/10.1103/RevModPhys.80.395">R. Bulla et al., Rev. Mod. Phys. <strong>80</strong>, 395 (2008)</a>]. Also compare with the SIAM result of <span class="arithmatex">\(4T_{{\mathrm{K}}} \chi_{{\mathrm{i}\mathrm{m}\mathrm{p}}}\)</span> , <span class="arithmatex">\(S_{{\mathrm{i}\mathrm{m}\mathrm{p}}} /\ln 2\)</span> , and <span class="arithmatex">\(R\)</span> , shown in the above demonstration.</p>
<blockquote>
<p><strong>Solution to exercise</strong>: Single-impurity Kondo model</p>
</blockquote>
<p>Perform the iterative diagonalization for the whole Kondo model (SIKM). For details of the iterative diagonalization for the SIKM, refer to the solution to T10b.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="nb">clear</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="c">% Hamiltonian parameters</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="n">U</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">4e-3</span><span class="p">;</span><span class="w"> </span><span class="c">% Coulomb interaction at the impurity</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="n">epsd</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="c">% impurity on-site energy</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="n">Gamma</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">8e-5</span><span class="o">*</span><span class="nb">pi</span><span class="p">;</span><span class="w"> </span><span class="c">% hybridization strength</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="n">J</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">8</span><span class="o">*</span><span class="n">Gamma</span><span class="o">/</span><span class="nb">pi</span><span class="o">/</span><span class="n">U</span><span class="p">;</span><span class="w"> </span><span class="c">% Kondo coupling strength</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="c">% NRG parameters</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="n">Lambda</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">2.5</span><span class="p">;</span><span class="w"> </span><span class="c">% discretization parameter</span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="n">N</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">55</span><span class="p">;</span><span class="w"> </span><span class="c">% length of the Wilson chain</span>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="n">Nkeep</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">300</span><span class="p">;</span>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="c">% Wilson chain</span>
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="p">[</span><span class="n">ff</span><span class="p">,</span><span class="o">~</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">doCLD</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Gamma</span><span class="o">/</span><span class="nb">pi</span><span class="p">,</span><span class="n">Lambda</span><span class="p">,</span><span class="mi">30</span><span class="p">);</span>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a><span class="c">% post-processing</span>
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a><span class="n">ff</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="n">ff</span><span class="p">;</span><span class="n">ff</span><span class="p">(</span><span class="k">end</span><span class="p">)</span><span class="o">.*</span><span class="p">(</span><span class="n">Lambda</span><span class="o">.^</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="p">:(</span><span class="n">N</span><span class="o">-</span><span class="nb">numel</span><span class="p">(</span><span class="n">ff</span><span class="p">))).</span><span class="o">&#39;/</span><span class="mi">2</span><span class="p">))];</span>
</span><span id="__span-15-18"><a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a><span class="n">gg</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">ff</span><span class="p">));</span>
</span><span id="__span-15-19"><a id="__codelineno-15-19" name="__codelineno-15-19" href="#__codelineno-15-19"></a><span class="n">ff</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ff</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="p">);</span><span class="w"> </span><span class="c">% shift to the left by one site</span>
</span><span id="__span-15-20"><a id="__codelineno-15-20" name="__codelineno-15-20" href="#__codelineno-15-20"></a><span class="n">gg</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">gg</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="p">);</span>
</span><span id="__span-15-21"><a id="__codelineno-15-21" name="__codelineno-15-21" href="#__codelineno-15-21"></a>
</span><span id="__span-15-22"><a id="__codelineno-15-22" name="__codelineno-15-22" href="#__codelineno-15-22"></a><span class="c">% Construct local operators</span>
</span><span id="__span-15-23"><a id="__codelineno-15-23" name="__codelineno-15-23" href="#__codelineno-15-23"></a><span class="p">[</span><span class="n">F</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">I</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getLocalSpace</span><span class="p">(</span><span class="s">&#39;FermionS&#39;</span><span class="p">,</span><span class="s">&#39;Acharge,SU2spin&#39;</span><span class="p">,</span><span class="s">&#39;NC&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-15-24"><a id="__codelineno-15-24" name="__codelineno-15-24" href="#__codelineno-15-24"></a><span class="p">[</span><span class="n">F</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">EF</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">setItag</span><span class="p">(</span><span class="s">&#39;s00&#39;</span><span class="p">,</span><span class="s">&#39;op&#39;</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">);</span>
</span><span id="__span-15-25"><a id="__codelineno-15-25" name="__codelineno-15-25" href="#__codelineno-15-25"></a><span class="p">[</span><span class="n">Ss</span><span class="p">,</span><span class="n">Is</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getLocalSpace</span><span class="p">(</span><span class="s">&#39;Spin&#39;</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
</span><span id="__span-15-26"><a id="__codelineno-15-26" name="__codelineno-15-26" href="#__codelineno-15-26"></a><span class="p">[</span><span class="n">Ss</span><span class="p">,</span><span class="n">Is</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">setItag</span><span class="p">(</span><span class="s">&#39;L00&#39;</span><span class="p">,</span><span class="s">&#39;op&#39;</span><span class="p">,</span><span class="n">Ss</span><span class="p">,</span><span class="n">Is</span><span class="p">.</span><span class="n">E</span><span class="p">);</span>
</span><span id="__span-15-27"><a id="__codelineno-15-27" name="__codelineno-15-27" href="#__codelineno-15-27"></a>
</span><span id="__span-15-28"><a id="__codelineno-15-28" name="__codelineno-15-28" href="#__codelineno-15-28"></a><span class="c">% attach U(1) charge symmetry label to spin</span>
</span><span id="__span-15-29"><a id="__codelineno-15-29" name="__codelineno-15-29" href="#__codelineno-15-29"></a><span class="n">Ss</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">appendScalarSymmetry</span><span class="p">(</span><span class="n">Ss</span><span class="p">,</span><span class="s">&#39;A&#39;</span><span class="p">,</span><span class="s">&#39;pos&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-15-30"><a id="__codelineno-15-30" name="__codelineno-15-30" href="#__codelineno-15-30"></a><span class="n">Is</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">appendScalarSymmetry</span><span class="p">(</span><span class="n">Is</span><span class="p">,</span><span class="s">&#39;A&#39;</span><span class="p">,</span><span class="s">&#39;pos&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-15-31"><a id="__codelineno-15-31" name="__codelineno-15-31" href="#__codelineno-15-31"></a>
</span><span id="__span-15-32"><a id="__codelineno-15-32" name="__codelineno-15-32" href="#__codelineno-15-32"></a><span class="c">% particle number operator</span>
</span><span id="__span-15-33"><a id="__codelineno-15-33" name="__codelineno-15-33" href="#__codelineno-15-33"></a><span class="n">NF</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">QSpace</span><span class="p">;</span>
</span><span id="__span-15-34"><a id="__codelineno-15-34" name="__codelineno-15-34" href="#__codelineno-15-34"></a><span class="k">for</span><span class="w"> </span><span class="n">itF</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">numel</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
</span><span id="__span-15-35"><a id="__codelineno-15-35" name="__codelineno-15-35" href="#__codelineno-15-35"></a><span class="w">    </span><span class="n">NF</span><span class="p">(</span><span class="n">itF</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">contract</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">itF</span><span class="p">),</span><span class="s">&#39;!2*&#39;</span><span class="p">,</span><span class="n">F</span><span class="p">(</span><span class="n">itF</span><span class="p">));</span>
</span><span id="__span-15-36"><a id="__codelineno-15-36" name="__codelineno-15-36" href="#__codelineno-15-36"></a><span class="k">end</span>
</span><span id="__span-15-37"><a id="__codelineno-15-37" name="__codelineno-15-37" href="#__codelineno-15-37"></a>
</span><span id="__span-15-38"><a id="__codelineno-15-38" name="__codelineno-15-38" href="#__codelineno-15-38"></a><span class="c">% Impurity Hamiltonian</span>
</span><span id="__span-15-39"><a id="__codelineno-15-39" name="__codelineno-15-39" href="#__codelineno-15-39"></a><span class="n">H0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">J</span><span class="o">*</span><span class="n">contract</span><span class="p">(</span><span class="n">Ss</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="s">&#39;*&#39;</span><span class="p">);</span>
</span><span id="__span-15-40"><a id="__codelineno-15-40" name="__codelineno-15-40" href="#__codelineno-15-40"></a>
</span><span id="__span-15-41"><a id="__codelineno-15-41" name="__codelineno-15-41" href="#__codelineno-15-41"></a><span class="c">% ket tensor for the impurity</span>
</span><span id="__span-15-42"><a id="__codelineno-15-42" name="__codelineno-15-42" href="#__codelineno-15-42"></a><span class="n">A0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getIdentity</span><span class="p">(</span><span class="n">Is</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">EF</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;K00&#39;</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]);</span>
</span><span id="__span-15-43"><a id="__codelineno-15-43" name="__codelineno-15-43" href="#__codelineno-15-43"></a>
</span><span id="__span-15-44"><a id="__codelineno-15-44" name="__codelineno-15-44" href="#__codelineno-15-44"></a><span class="n">H0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">contract</span><span class="p">(</span><span class="n">A0</span><span class="p">,</span><span class="s">&#39;!2*&#39;</span><span class="p">,{</span><span class="n">A0</span><span class="p">,</span><span class="n">H0</span><span class="p">})</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1e-33</span><span class="o">*</span><span class="n">contract</span><span class="p">(</span><span class="n">A0</span><span class="p">,</span><span class="s">&#39;!2*&#39;</span><span class="p">,</span><span class="n">A0</span><span class="p">);</span>
</span><span id="__span-15-45"><a id="__codelineno-15-45" name="__codelineno-15-45" href="#__codelineno-15-45"></a>
</span><span id="__span-15-46"><a id="__codelineno-15-46" name="__codelineno-15-46" href="#__codelineno-15-46"></a><span class="c">% iterative diagonalization</span>
</span><span id="__span-15-47"><a id="__codelineno-15-47" name="__codelineno-15-47" href="#__codelineno-15-47"></a><span class="n">Inrg</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">NRG_IterDiagQS</span><span class="p">(</span><span class="n">H0</span><span class="p">,</span><span class="n">A0</span><span class="p">,</span><span class="n">Lambda</span><span class="p">,</span><span class="n">ff</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">gg</span><span class="p">,</span><span class="n">NF</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">Nkeep</span><span class="p">);</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>21-05-10 17:44:16 | NRG: start
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>21-05-10 17:44:16 | #00/54 : NK=4/4, EK=0.08/0.08
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>21-05-10 17:44:16 | #01/54 : NK=15/15, EK=3.231/3.231
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>21-05-10 17:44:16 | #02/54 : NK=56/56, EK=6.468/6.468
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>21-05-10 17:44:16 | #03/54 : NK=210/210, EK=13.1/13.1
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>21-05-10 17:44:16 | #04/54 : NK=310/792, EK=9.834/22.35
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>21-05-10 17:44:16 | #05/54 : NK=311/1170, EK=9.829/18.02
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>21-05-10 17:44:16 | #06/54 : NK=302/1174, EK=9.77/17.36
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>21-05-10 17:44:16 | #07/54 : NK=311/1134, EK=9.852/17.96
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>21-05-10 17:44:16 | #08/54 : NK=322/1174, EK=9.953/17.44
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>21-05-10 17:44:17 | #09/54 : NK=311/1210, EK=9.893/18.39
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>21-05-10 17:44:17 | #10/54 : NK=322/1174, EK=10.07/17.57
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a>21-05-10 17:44:17 | #11/54 : NK=311/1210, EK=9.947/18.33
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a>21-05-10 17:44:17 | #12/54 : NK=322/1172, EK=10.25/17.87
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a>21-05-10 17:44:17 | #13/54 : NK=315/1210, EK=10.09/18.32
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a>21-05-10 17:44:17 | #14/54 : NK=312/1184, EK=10.36/18.18
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a>21-05-10 17:44:17 | #15/54 : NK=300/1170, EK=10.15/18.49
</span><span id="__span-16-18"><a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a>21-05-10 17:44:17 | #16/54 : NK=309/1124, EK=10.74/18.46
</span><span id="__span-16-19"><a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a>21-05-10 17:44:17 | #17/54 : NK=325/1158, EK=10.85/18.96
</span><span id="__span-16-20"><a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a>21-05-10 17:44:18 | #18/54 : NK=322/1218, EK=11.36/19.57
</span><span id="__span-16-21"><a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a>21-05-10 17:44:18 | #19/54 : NK=320/1204, EK=11.26/19.6
</span><span id="__span-16-22"><a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a>21-05-10 17:44:18 | #20/54 : NK=311/1192, EK=11.7/20.71
</span><span id="__span-16-23"><a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a>21-05-10 17:44:18 | #21/54 : NK=306/1160, EK=11.51/20.05
</span><span id="__span-16-24"><a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a>21-05-10 17:44:18 | #22/54 : NK=310/1136, EK=12.01/21.29
</span><span id="__span-16-25"><a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a>21-05-10 17:44:18 | #23/54 : NK=306/1151, EK=11.71/20.59
</span><span id="__span-16-26"><a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a>21-05-10 17:44:18 | #24/54 : NK=307/1136, EK=11.96/21.69
</span><span id="__span-16-27"><a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a>21-05-10 17:44:18 | #25/54 : NK=306/1139, EK=11.8/20.11
</span><span id="__span-16-28"><a id="__codelineno-16-28" name="__codelineno-16-28" href="#__codelineno-16-28"></a>21-05-10 17:44:18 | #26/54 : NK=307/1136, EK=11.97/21.86
</span><span id="__span-16-29"><a id="__codelineno-16-29" name="__codelineno-16-29" href="#__codelineno-16-29"></a>21-05-10 17:44:18 | #27/54 : NK=306/1139, EK=11.83/20.16
</span><span id="__span-16-30"><a id="__codelineno-16-30" name="__codelineno-16-30" href="#__codelineno-16-30"></a>21-05-10 17:44:19 | #28/54 : NK=309/1136, EK=12.2/21.93
</span><span id="__span-16-31"><a id="__codelineno-16-31" name="__codelineno-16-31" href="#__codelineno-16-31"></a>21-05-10 17:44:19 | #29/54 : NK=306/1147, EK=11.85/20.88
</span><span id="__span-16-32"><a id="__codelineno-16-32" name="__codelineno-16-32" href="#__codelineno-16-32"></a>21-05-10 17:44:19 | #30/54 : NK=309/1136, EK=12.21/21.95
</span><span id="__span-16-33"><a id="__codelineno-16-33" name="__codelineno-16-33" href="#__codelineno-16-33"></a>21-05-10 17:44:19 | #31/54 : NK=306/1147, EK=11.85/20.89
</span><span id="__span-16-34"><a id="__codelineno-16-34" name="__codelineno-16-34" href="#__codelineno-16-34"></a>21-05-10 17:44:19 | #32/54 : NK=309/1136, EK=12.21/21.96
</span><span id="__span-16-35"><a id="__codelineno-16-35" name="__codelineno-16-35" href="#__codelineno-16-35"></a>21-05-10 17:44:19 | #33/54 : NK=306/1147, EK=11.86/20.89
</span><span id="__span-16-36"><a id="__codelineno-16-36" name="__codelineno-16-36" href="#__codelineno-16-36"></a>21-05-10 17:44:19 | #34/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-16-37"><a id="__codelineno-16-37" name="__codelineno-16-37" href="#__codelineno-16-37"></a>21-05-10 17:44:19 | #35/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-16-38"><a id="__codelineno-16-38" name="__codelineno-16-38" href="#__codelineno-16-38"></a>21-05-10 17:44:19 | #36/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-16-39"><a id="__codelineno-16-39" name="__codelineno-16-39" href="#__codelineno-16-39"></a>21-05-10 17:44:19 | #37/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-16-40"><a id="__codelineno-16-40" name="__codelineno-16-40" href="#__codelineno-16-40"></a>21-05-10 17:44:20 | #38/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-16-41"><a id="__codelineno-16-41" name="__codelineno-16-41" href="#__codelineno-16-41"></a>21-05-10 17:44:20 | #39/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-16-42"><a id="__codelineno-16-42" name="__codelineno-16-42" href="#__codelineno-16-42"></a>21-05-10 17:44:20 | #40/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-16-43"><a id="__codelineno-16-43" name="__codelineno-16-43" href="#__codelineno-16-43"></a>21-05-10 17:44:20 | #41/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-16-44"><a id="__codelineno-16-44" name="__codelineno-16-44" href="#__codelineno-16-44"></a>21-05-10 17:44:20 | #42/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-16-45"><a id="__codelineno-16-45" name="__codelineno-16-45" href="#__codelineno-16-45"></a>21-05-10 17:44:20 | #43/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-16-46"><a id="__codelineno-16-46" name="__codelineno-16-46" href="#__codelineno-16-46"></a>21-05-10 17:44:20 | #44/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-16-47"><a id="__codelineno-16-47" name="__codelineno-16-47" href="#__codelineno-16-47"></a>21-05-10 17:44:20 | #45/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-16-48"><a id="__codelineno-16-48" name="__codelineno-16-48" href="#__codelineno-16-48"></a>21-05-10 17:44:20 | #46/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-16-49"><a id="__codelineno-16-49" name="__codelineno-16-49" href="#__codelineno-16-49"></a>21-05-10 17:44:20 | #47/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-16-50"><a id="__codelineno-16-50" name="__codelineno-16-50" href="#__codelineno-16-50"></a>21-05-10 17:44:21 | #48/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-16-51"><a id="__codelineno-16-51" name="__codelineno-16-51" href="#__codelineno-16-51"></a>21-05-10 17:44:21 | #49/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-16-52"><a id="__codelineno-16-52" name="__codelineno-16-52" href="#__codelineno-16-52"></a>21-05-10 17:44:21 | #50/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-16-53"><a id="__codelineno-16-53" name="__codelineno-16-53" href="#__codelineno-16-53"></a>21-05-10 17:44:21 | #51/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-16-54"><a id="__codelineno-16-54" name="__codelineno-16-54" href="#__codelineno-16-54"></a>21-05-10 17:44:21 | #52/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-16-55"><a id="__codelineno-16-55" name="__codelineno-16-55" href="#__codelineno-16-55"></a>21-05-10 17:44:21 | #53/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-16-56"><a id="__codelineno-16-56" name="__codelineno-16-56" href="#__codelineno-16-56"></a>21-05-10 17:44:21 | #54/54 : NK=0/1136, EK=0/21.97
</span><span id="__span-16-57"><a id="__codelineno-16-57" name="__codelineno-16-57" href="#__codelineno-16-57"></a>21-05-10 17:44:21 | Memory usage : 3.38GiB
</span><span id="__span-16-58"><a id="__codelineno-16-58" name="__codelineno-16-58" href="#__codelineno-16-58"></a>Elapsed time: 5.517s, CPU time: 12.89s, Avg # of cores: 2.336
</span></code></pre></div>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="n">beta0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c">% parameter to define temperature values</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="p">[</span><span class="n">T</span><span class="p">,</span><span class="n">Tchi</span><span class="p">,</span><span class="n">Sent</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getTDconvQS</span><span class="p">(</span><span class="n">Inrg</span><span class="p">,</span><span class="n">beta0</span><span class="p">);</span>
</span></code></pre></div>
<p>Perform the iterative diagonalization for the bath only. <strong>We replace the Kondo impurity with vacuum</strong>.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="n">A0_2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getIdentity</span><span class="p">(</span><span class="n">setItag</span><span class="p">(</span><span class="n">getvac</span><span class="p">(</span><span class="n">EF</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="s">&#39;L00&#39;</span><span class="p">),</span><span class="mi">2</span><span class="p">,</span><span class="n">EF</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;K00&#39;</span><span class="p">,[</span><span class="mi">1</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">2</span><span class="p">]);</span><span class="w"> </span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="n">H0_2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">1e-33</span><span class="o">*</span><span class="n">contract</span><span class="p">(</span><span class="n">A0_2</span><span class="p">,</span><span class="s">&#39;!2*&#39;</span><span class="p">,</span><span class="n">A0_2</span><span class="p">);</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="n">Inrg2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">NRG_IterDiagQS</span><span class="p">(</span><span class="n">H0_2</span><span class="p">,</span><span class="n">A0_2</span><span class="p">,</span><span class="n">Lambda</span><span class="p">,</span><span class="n">ff</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">gg</span><span class="p">,</span><span class="n">NF</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">Nkeep</span><span class="p">);</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>21-05-10 17:44:22 | NRG: start
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>21-05-10 17:44:22 | #00/54 : NK=3/3, EK=1e-33/1e-33
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>21-05-10 17:44:22 | #01/54 : NK=10/10, EK=3.203/3.203
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>21-05-10 17:44:22 | #02/54 : NK=35/35, EK=6.15/6.15
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>21-05-10 17:44:22 | #03/54 : NK=126/126, EK=13/13
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>21-05-10 17:44:22 | #04/54 : NK=310/462, EK=12.48/21.9
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>21-05-10 17:44:22 | #05/54 : NK=309/1154, EK=12.22/23.03
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>21-05-10 17:44:22 | #06/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>21-05-10 17:44:22 | #07/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>21-05-10 17:44:22 | #08/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>21-05-10 17:44:22 | #09/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>21-05-10 17:44:22 | #10/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a>21-05-10 17:44:22 | #11/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a>21-05-10 17:44:23 | #12/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>21-05-10 17:44:23 | #13/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a>21-05-10 17:44:23 | #14/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-19-17"><a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a>21-05-10 17:44:23 | #15/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-19-18"><a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a>21-05-10 17:44:23 | #16/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-19-19"><a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a>21-05-10 17:44:23 | #17/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-19-20"><a id="__codelineno-19-20" name="__codelineno-19-20" href="#__codelineno-19-20"></a>21-05-10 17:44:23 | #18/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-19-21"><a id="__codelineno-19-21" name="__codelineno-19-21" href="#__codelineno-19-21"></a>21-05-10 17:44:23 | #19/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-19-22"><a id="__codelineno-19-22" name="__codelineno-19-22" href="#__codelineno-19-22"></a>21-05-10 17:44:23 | #20/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-19-23"><a id="__codelineno-19-23" name="__codelineno-19-23" href="#__codelineno-19-23"></a>21-05-10 17:44:23 | #21/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-19-24"><a id="__codelineno-19-24" name="__codelineno-19-24" href="#__codelineno-19-24"></a>21-05-10 17:44:24 | #22/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-19-25"><a id="__codelineno-19-25" name="__codelineno-19-25" href="#__codelineno-19-25"></a>21-05-10 17:44:24 | #23/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-19-26"><a id="__codelineno-19-26" name="__codelineno-19-26" href="#__codelineno-19-26"></a>21-05-10 17:44:24 | #24/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-19-27"><a id="__codelineno-19-27" name="__codelineno-19-27" href="#__codelineno-19-27"></a>21-05-10 17:44:24 | #25/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-19-28"><a id="__codelineno-19-28" name="__codelineno-19-28" href="#__codelineno-19-28"></a>21-05-10 17:44:24 | #26/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-19-29"><a id="__codelineno-19-29" name="__codelineno-19-29" href="#__codelineno-19-29"></a>21-05-10 17:44:24 | #27/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-19-30"><a id="__codelineno-19-30" name="__codelineno-19-30" href="#__codelineno-19-30"></a>21-05-10 17:44:24 | #28/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-19-31"><a id="__codelineno-19-31" name="__codelineno-19-31" href="#__codelineno-19-31"></a>21-05-10 17:44:24 | #29/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-19-32"><a id="__codelineno-19-32" name="__codelineno-19-32" href="#__codelineno-19-32"></a>21-05-10 17:44:24 | #30/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-19-33"><a id="__codelineno-19-33" name="__codelineno-19-33" href="#__codelineno-19-33"></a>21-05-10 17:44:25 | #31/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-19-34"><a id="__codelineno-19-34" name="__codelineno-19-34" href="#__codelineno-19-34"></a>21-05-10 17:44:25 | #32/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-19-35"><a id="__codelineno-19-35" name="__codelineno-19-35" href="#__codelineno-19-35"></a>21-05-10 17:44:25 | #33/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-19-36"><a id="__codelineno-19-36" name="__codelineno-19-36" href="#__codelineno-19-36"></a>21-05-10 17:44:25 | #34/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-19-37"><a id="__codelineno-19-37" name="__codelineno-19-37" href="#__codelineno-19-37"></a>21-05-10 17:44:25 | #35/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-19-38"><a id="__codelineno-19-38" name="__codelineno-19-38" href="#__codelineno-19-38"></a>21-05-10 17:44:25 | #36/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-19-39"><a id="__codelineno-19-39" name="__codelineno-19-39" href="#__codelineno-19-39"></a>21-05-10 17:44:25 | #37/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-19-40"><a id="__codelineno-19-40" name="__codelineno-19-40" href="#__codelineno-19-40"></a>21-05-10 17:44:25 | #38/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-19-41"><a id="__codelineno-19-41" name="__codelineno-19-41" href="#__codelineno-19-41"></a>21-05-10 17:44:25 | #39/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-19-42"><a id="__codelineno-19-42" name="__codelineno-19-42" href="#__codelineno-19-42"></a>21-05-10 17:44:26 | #40/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-19-43"><a id="__codelineno-19-43" name="__codelineno-19-43" href="#__codelineno-19-43"></a>21-05-10 17:44:26 | #41/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-19-44"><a id="__codelineno-19-44" name="__codelineno-19-44" href="#__codelineno-19-44"></a>21-05-10 17:44:26 | #42/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-19-45"><a id="__codelineno-19-45" name="__codelineno-19-45" href="#__codelineno-19-45"></a>21-05-10 17:44:26 | #43/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-19-46"><a id="__codelineno-19-46" name="__codelineno-19-46" href="#__codelineno-19-46"></a>21-05-10 17:44:26 | #44/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-19-47"><a id="__codelineno-19-47" name="__codelineno-19-47" href="#__codelineno-19-47"></a>21-05-10 17:44:26 | #45/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-19-48"><a id="__codelineno-19-48" name="__codelineno-19-48" href="#__codelineno-19-48"></a>21-05-10 17:44:26 | #46/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-19-49"><a id="__codelineno-19-49" name="__codelineno-19-49" href="#__codelineno-19-49"></a>21-05-10 17:44:26 | #47/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-19-50"><a id="__codelineno-19-50" name="__codelineno-19-50" href="#__codelineno-19-50"></a>21-05-10 17:44:26 | #48/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-19-51"><a id="__codelineno-19-51" name="__codelineno-19-51" href="#__codelineno-19-51"></a>21-05-10 17:44:27 | #49/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-19-52"><a id="__codelineno-19-52" name="__codelineno-19-52" href="#__codelineno-19-52"></a>21-05-10 17:44:27 | #50/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-19-53"><a id="__codelineno-19-53" name="__codelineno-19-53" href="#__codelineno-19-53"></a>21-05-10 17:44:27 | #51/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-19-54"><a id="__codelineno-19-54" name="__codelineno-19-54" href="#__codelineno-19-54"></a>21-05-10 17:44:27 | #52/54 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-19-55"><a id="__codelineno-19-55" name="__codelineno-19-55" href="#__codelineno-19-55"></a>21-05-10 17:44:27 | #53/54 : NK=309/1136, EK=12.21/21.97
</span><span id="__span-19-56"><a id="__codelineno-19-56" name="__codelineno-19-56" href="#__codelineno-19-56"></a>21-05-10 17:44:27 | #54/54 : NK=0/1147, EK=0/20.9
</span><span id="__span-19-57"><a id="__codelineno-19-57" name="__codelineno-19-57" href="#__codelineno-19-57"></a>21-05-10 17:44:27 | Memory usage : 3.39GiB
</span><span id="__span-19-58"><a id="__codelineno-19-58" name="__codelineno-19-58" href="#__codelineno-19-58"></a>Elapsed time: 5.586s, CPU time: 12.79s, Avg # of cores: 2.29
</span></code></pre></div>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="p">[</span><span class="o">~</span><span class="p">,</span><span class="n">Tchi2</span><span class="p">,</span><span class="n">Sent2</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getTDconvQS</span><span class="p">(</span><span class="n">Inrg2</span><span class="p">,</span><span class="n">beta0</span><span class="p">);</span>
</span></code></pre></div>
<p>Then subtract the thermodynamic properties from the bath only from those from the whole impurity model, to obtain the impurity contribution.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c">% impurity contribution to the spin susceptibility (* temperature)</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="n">Tchi_imp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Tchi</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Tchi2</span><span class="p">;</span><span class="w"> </span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="c">% impurity contribution to the entropy</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="n">Sent_imp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Sent</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Sent2</span><span class="p">;</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="n">logT</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">log</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="c">% impurity contribution to the specific heat C = T* dS/dT = dS / d(log T)</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="n">C_imp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">interp1</span><span class="p">((</span><span class="n">logT</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">logT</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="w">    </span><span class="nb">diff</span><span class="p">(</span><span class="n">Sent_imp</span><span class="p">)</span><span class="o">./</span><span class="nb">diff</span><span class="p">(</span><span class="n">logT</span><span class="p">),</span><span class="n">logT</span><span class="p">,</span><span class="s">&#39;linear&#39;</span><span class="p">,</span><span class="s">&#39;extrap&#39;</span><span class="p">);</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="c">% Sommerfeld-Wilson ratio</span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="n">WR</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">Tchi_imp</span><span class="o">./</span><span class="n">C_imp</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="nb">pi</span>^<span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">);</span>
</span></code></pre></div>
<p>To rescale the temperature, we compute the Kondo temperature <span class="arithmatex">\(T_{{\mathrm{K}}}\)</span> . Here we use the formula from the second-order poor man's scaling calculation.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c">% Kondo temperature</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="n">TK</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">J</span><span class="p">);</span><span class="w"> </span><span class="c">% half-bandwidth D = 1</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="nb">disp</span><span class="p">(</span><span class="n">TK</span><span class="p">);</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>   7.7218e-04
</span></code></pre></div>
<p>Plot the result.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="nb">figure</span><span class="p">;</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="nb">semilogx</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">TK</span><span class="p">,(</span><span class="n">Tchi_imp</span><span class="o">./</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">TK</span><span class="p">),</span><span class="w"> </span><span class="k">...</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="w">    </span><span class="n">T</span><span class="o">/</span><span class="n">TK</span><span class="p">,</span><span class="n">Sent_imp</span><span class="o">/</span><span class="nb">log</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="k">...</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="w">    </span><span class="n">T</span><span class="o">/</span><span class="n">TK</span><span class="p">,</span><span class="n">WR</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="nb">set</span><span class="p">(</span><span class="nb">gca</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;FontSize&#39;</span><span class="p">,</span><span class="mi">13</span><span class="p">);</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39; $T / T_\mathrm{K}$ &#39;</span><span class="p">,</span><span class="s">&#39;Interpreter&#39;</span><span class="p">,</span><span class="s">&#39;latex&#39;</span><span class="p">);</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="nb">legend</span><span class="p">({</span><span class="s">&#39; $4 T_\mathrm{K} \chi_\mathrm{imp}$ &#39;</span><span class="p">;</span><span class="w"> </span><span class="k">...</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="w">    </span><span class="s">&#39; $S_\mathrm{imp} / \ln 2$ &#39;</span><span class="p">;</span><span class="w"> </span><span class="k">...</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="w">    </span><span class="s">&#39; $R$ &#39;</span><span class="p">},</span><span class="w"> </span><span class="k">...</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="w">    </span><span class="s">&#39;Interpreter&#39;</span><span class="p">,</span><span class="s">&#39;latex&#39;</span><span class="p">,</span><span class="s">&#39;Location&#39;</span><span class="p">,</span><span class="s">&#39;northwest&#39;</span><span class="p">);</span>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="nb">ylim</span><span class="p">([</span><span class="mi">0</span><span class="w"> </span><span class="mi">3</span><span class="p">]);</span>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a><span class="nb">xlim</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="n">T</span><span class="p">)]</span><span class="o">/</span><span class="n">TK</span><span class="p">);</span>
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a><span class="n">grid</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
</span></code></pre></div>
<p align="center">
  <img src="../images/chi-SIKM.png" alt="Alt Text" width = "70%">
</p>

<p>The curves of <span class="arithmatex">\(R(T)\)</span> and <span class="arithmatex">\(\chi_{{\mathrm{i}\mathrm{m}\mathrm{p}}} (T)\)</span> for the SIKM exhibit similar behavior as those for the SIAM. Compare this plot with the demonstration plot. The kinks of <span class="arithmatex">\(R\)</span> at the highest and the lowest temperatures come from numerical artifact.</p>
<p>On the other hand, the curve of <span class="arithmatex">\(S_{{\mathrm{i}\mathrm{m}\mathrm{p}}} (T)\)</span> for the SIKM shows different features from that for the SIAM. <span class="arithmatex">\(S_{{\mathrm{i}\mathrm{m}\mathrm{p}}} (T)\)</span> for the SIAM has had three plateaus that represent three regimes: (i) <span class="arithmatex">\(\ln 4\)</span> for the free orbital regime, (ii) <span class="arithmatex">\(\ln 2\)</span> for the local moment regime, and (iii) <span class="arithmatex">\(0\)</span> for the strong coupling regime. <span class="arithmatex">\(S_{{\mathrm{i}\mathrm{m}\mathrm{p}}} (T)\)</span> for the SIKM has only two plateaus: (i) <span class="arithmatex">\(\ln 2\)</span> for the local moment regime and (ii) <span class="arithmatex">\(0\)</span> for the strong coupling regime.</p>
<p>The absence of the free orbital regime is natural. In the derivation of the SIKM out of the SIAM, the doubly-occupied and the empty states of the impurity are "integrated out." As the result, the impurity of the SIKM has only spin degrees of freedom. That is, there is no free orbital regime at all for the SIKM.</p>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2024-05-08T15:01:05+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-05-08</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2024-04-23T08:40:49+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-04-23</span>
  </span>

    
    
    
      
  <span class="md-source-file__fact">
    
      
  <span class="md-icon" title="Contributors">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg>
  </span>
  <span>GitHub</span>

    
    <nav>
      
        <a href="https://github.com/RubiscoP" class="md-author" title="@RubiscoP">
          
          <img src="https://avatars.githubusercontent.com/u/47628396?v=4&size=72" alt="RubiscoP">
        </a>
      
        <a href="https://github.com/Phy-David-Zhang" class="md-author" title="@Phy-David-Zhang">
          
          <img src="https://avatars.githubusercontent.com/u/20659726?v=4&size=72" alt="Phy-David-Zhang">
        </a>
      
      
      
    </nav>
  </span>

    
  </aside>


  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              Thanks for your feedback! Help us improve this page by raising issues in our <a href="https://github.com/Open-Source-QSpace/QSpace-Documentation/issues" target="_blank" rel="noopener">repository</a>.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../NRG1_Energy_Flow/" class="md-footer__link md-footer__link--prev" aria-label="Previous: NRG-1: Energy Flow">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                NRG-1: Energy Flow
              </div>
            </div>
          </a>
        
        
          
          <a href="../NRG3_ImpSpec/" class="md-footer__link md-footer__link--next" aria-label="Next: NRG-3: Impurity Spectral Function">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                NRG-3: Impurity Spectral Function
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Open Source QSpace Organization
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/Open-Source-QSpace" target="_blank" rel="noopener" title="Organization" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="https://bitbucket.org/qspace4u" target="_blank" rel="noopener" title="QSpace4u" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M22.2 32A16 16 0 0 0 6 47.8a26 26 0 0 0 .2 2.8l67.9 412.1a21.77 21.77 0 0 0 21.3 18.2h325.7a16 16 0 0 0 16-13.4L505 50.7a16 16 0 0 0-13.2-18.3 25 25 0 0 0-2.8-.2zm285.9 297.8h-104l-28.1-147h157.3z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://arxiv.org/abs/2405.06632" target="_blank" rel="noopener" title="Technicality" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://www.mathworks.com/products/matlab.html" target="_blank" rel="noopener" title="MATLAB" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M224 373.12c-25.24-31.67-40.08-59.43-45-83.18-22.55-88 112.61-88 90.06 0-5.45 24.25-20.29 52-45 83.18zm138.15 73.23c-42.06 18.31-83.67-10.88-119.3-50.47 103.9-130.07 46.11-200-18.85-200-54.92 0-85.16 46.51-73.28 100.5 6.93 29.19 25.23 62.39 54.43 99.5-32.53 36.05-60.55 52.69-85.15 54.92-50 7.43-89.11-41.06-71.3-91.09 15.1-39.16 111.72-231.18 115.87-241.56 15.75-30.07 25.56-57.4 59.38-57.4 32.34 0 43.4 25.94 60.37 59.87 36 70.62 89.35 177.48 114.84 239.09 13.17 33.07-1.37 71.29-37.01 86.64m47-136.12C280.27 35.93 273.13 32 224 32c-45.52 0-64.87 31.67-84.66 72.79C33.18 317.1 22.89 347.19 22 349.81-3.22 419.14 48.74 480 111.63 480c21.71 0 60.61-6.06 112.37-62.4 58.68 63.78 101.26 62.4 112.37 62.4 62.89.05 114.85-60.86 89.61-130.19.02-3.89-16.82-38.9-16.82-39.58z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.sections", "navigation.footer", "content.action.edit", "content.action.view", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../../js/timeago.min.js"></script>
      
        <script src="../../../js/timeago_mkdocs_material.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="../../../javascripts/feedback.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>