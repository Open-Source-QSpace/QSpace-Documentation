
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../NRG2_ImpThermo/">
      
      
        <link rel="next" href="../NRG_Kondo/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.41">
    
    
      
        <title>NRG-3: Impurity Spectral Function - QSpace Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M64 32C28.7 32 0 60.7 0 96v320c0 35.3 28.7 64 64 64h224V368c0-26.5 21.5-48 48-48h112V96c0-35.3-28.7-64-64-64zm384 320H336c-8.8 0-16 7.2-16 16v112l32-32 64-64z"/></svg>');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M96 0C43 0 0 43 0 96v320c0 53 43 96 96 96h320c17.7 0 32-14.3 32-32s-14.3-32-32-32v-64c17.7 0 32-14.3 32-32V32c0-17.7-14.3-32-32-32H96m0 384h256v64H96c-17.7 0-32-14.3-32-32s14.3-32 32-32m32-240c0-8.8 7.2-16 16-16h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16m16 48h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16s7.2-16 16-16"/></svg>');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M256 512a256 256 0 1 0 0-512 256 256 0 1 0 0 512m-40-176h24v-64h-24c-13.3 0-24-10.7-24-24s10.7-24 24-24h48c13.3 0 24 10.7 24 24v88h8c13.3 0 24 10.7 24 24s-10.7 24-24 24h-80c-13.3 0-24-10.7-24-24s10.7-24 24-24m40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64"/></svg>');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M480 32c0-12.9-7.8-24.6-19.8-29.6S434.5.2 425.3 9.3L381.7 53c-48 48-113.1 75-181 75H64c-35.3 0-64 28.7-64 64v96c0 35.3 28.7 64 64 64v128c0 17.7 14.3 32 32 32h64c17.7 0 32-14.3 32-32V352h8.7c67.9 0 133 27 181 75l43.6 43.6c9.2 9.2 22.9 11.9 34.9 6.9s19.8-16.6 19.8-29.6V300.3c18.6-8.8 32-32.5 32-60.4s-13.4-51.6-32-60.4zm-64 76.7v262.6C357.2 317.8 280.5 288 200.7 288H192v-96h8.7c79.8 0 156.5-29.8 215.3-83.3"/></svg>');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7l233.4-233.3c12.5-12.5 32.8-12.5 45.3 0z"/></svg>');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M256 512a256 256 0 1 0 0-512 256 256 0 1 0 0 512m-86.2-346.7c7.9-22.3 29.1-37.3 52.8-37.3h58.3c34.9 0 63.1 28.3 63.1 63.1 0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6-13.3 0-24-10.7-24-24v-13.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1 0-8.4-6.8-15.1-15.1-15.1h-58.3c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM224 352a32 32 0 1 1 64 0 32 32 0 1 1-64 0"/></svg>');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7.2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8.2-40.1l216-368C228.7 39.5 241.8 32 256 32m0 128c-13.3 0-24 10.7-24 24v112c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24m32 224a32 32 0 1 0-64 0 32 32 0 1 0 64 0"/></svg>');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.1 52.4 442.6 6.5c-1.9-3.9-6.1-6.5-10.5-6.5s-8.5 2.6-10.4 6.5l-16.5 45.9-46 16.8c-4.3 1.6-7.3 5.9-7.2 10.4 0 4.5 3 8.7 7.2 10.2l45.7 16.8 16.8 45.8c1.5 4.4 5.8 7.5 10.4 7.5s8.9-3.1 10.4-7.5l16.5-45.8 45.7-16.8c4.2-1.5 7.2-5.7 7.2-10.2 0-4.6-3-8.9-7.2-10.4zm-132.4 53c-12.5-12.5-32.8-12.5-45.3 0l-2.9 2.9c-22-8-45.8-12.3-70.5-12.3C93.1 96 0 189.1 0 304s93.1 208 208 208 208-93.1 208-208c0-24.7-4.3-48.5-12.2-70.5l2.9-2.9c12.5-12.5 12.5-32.8 0-45.3l-80-80zM200 192c-57.4 0-104 46.6-104 104v8c0 8.8-7.2 16-16 16s-16-7.2-16-16v-8c0-75.1 60.9-136 136-136h8c8.8 0 16 7.2 16 16s-7.2 16-16 16z"/></svg>');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 398.9c58.5-41.1 96-104.1 96-174.9C512 100.3 397.4 0 256 0S0 100.3 0 224c0 70.7 37.5 133.8 96 174.9V464c0 26.5 21.5 48 48 48h48v-48c0-8.8 7.2-16 16-16s16 7.2 16 16v48h64v-48c0-8.8 7.2-16 16-16s16 7.2 16 16v48h48c26.5 0 48-21.5 48-48v-65.1M96 256a64 64 0 1 1 128 0 64 64 0 1 1-128 0m256-64a64 64 0 1 1 0 128 64 64 0 1 1 0-128"/></svg>');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M320 0c17.7 0 32 14.3 32 32v64h120c39.8 0 72 32.2 72 72v272c0 39.8-32.2 72-72 72H168c-39.8 0-72-32.2-72-72V168c0-39.8 32.2-72 72-72h120V32c0-17.7 14.3-32 32-32M208 384c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16zM264 256a40 40 0 1 0-80 0 40 40 0 1 0 80 0m152 40a40 40 0 1 0 0-80 40 40 0 1 0 0 80M48 224h16v192H48c-26.5 0-48-21.5-48-48v-96c0-26.5 21.5-48 48-48m544 0c26.5 0 48 21.5 48 48v96c0 26.5-21.5 48-48 48h-16V224z"/></svg>');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M288 0H128c-17.7 0-32 14.3-32 32s14.3 32 32 32v132.8c0 11.8-3.3 23.5-9.5 33.5L10.3 406.2C3.6 417.2 0 429.7 0 442.6 0 480.9 31.1 512 69.4 512h309.2c38.3 0 69.4-31.1 69.4-69.4 0-12.8-3.6-25.4-10.3-36.4L329.5 230.4c-6.2-10.1-9.5-21.7-9.5-33.5V64c17.7 0 32-14.3 32-32S337.7 0 320 0zm-96 196.8V64h64v132.8c0 23.7 6.6 46.9 19 67.1l34.5 56.1h-171l34.5-56.1c12.4-20.2 19-43.4 19-67.1"/></svg>');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M0 216C0 149.7 53.7 96 120 96h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V216m256 0c0-66.3 53.7-120 120-120h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64h-64c-35.3 0-64-28.7-64-64V216"/></svg>');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/timeago.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#iterative-diagonalization" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="QSpace Documentation" class="md-header__button md-logo" aria-label="QSpace Documentation" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            QSpace Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              NRG-3: Impurity Spectral Function
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Open-Source-QSpace/QSpace-Documentation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    QSpace Documentation
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../.." class="md-tabs__link">
          
  
  Getting started

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../tutorial/Get2Know/" class="md-tabs__link">
          
  
  Tutorial

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../NRG1_Energy_Flow/" class="md-tabs__link">
          
  
  Examples

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../reference/compactQS/" class="md-tabs__link">
          
  
  Reference

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../contribg/" class="md-tabs__link">
          
  
  Contribute

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="QSpace Documentation" class="md-nav__button md-logo" aria-label="QSpace Documentation" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    QSpace Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Open-Source-QSpace/QSpace-Documentation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    QSpace Documentation
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Getting started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What is QSpace?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../community/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Community Edition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_3" >
        
          
          <label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Installation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_3">
            <span class="md-nav__icon md-icon"></span>
            Installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../installation/Linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install on Linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../installation/macOS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install on macOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../installation/troublesh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Troubleshooting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../installation/customize/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Customization
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4" >
        
          
          <label class="md-nav__link" for="__nav_1_4" id="__nav_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Development
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../standards/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Standards
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorial
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorial
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/Get2Know/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get to Know QSpace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/CGCoeff/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clebsch-Gordan Coefficients
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/LocalOps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generate Local Operators
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/QSpaceObj/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Understand QSpace Objects
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/QSpaceData/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access QSpace Data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Operations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Operations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/BasicOps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic Operations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/Subspace/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access Subspaces
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/Contraction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contraction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/DrctSum/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Direct Sum
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/EigenDecomp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Eigen-decomposition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/SingValDecomp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Singular Value Decomposition
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Special Case
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            Special Case
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/Rank2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rank-2 Tensors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/Vacuum/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vacuum Space
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/Isometries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Identity & Isometry
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8" >
        
          
          <label class="md-nav__link" for="__nav_2_8" id="__nav_2_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Technicality
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8">
            <span class="md-nav__icon md-icon"></span>
            Technicality
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/ZeroTrunc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Truncation of Zeros
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/NormConv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Normalization Convention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/OuterMult/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Outer Multiplicity
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    NRG Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            NRG Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../NRG1_Energy_Flow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NRG-1: Energy Flow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../NRG2_ImpThermo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NRG-2: Impurity Contribution  to Thermaldynamic  Properties
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    NRG-3: Impurity Spectral Function
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    NRG-3: Impurity Spectral Function
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#iterative-diagonalization" class="md-nav__link">
    <span class="md-ellipsis">
      Iterative diagonalization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#double-occupation-vs-temperature" class="md-nav__link">
    <span class="md-ellipsis">
      Double occupation vs. temperature
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#impurity-spectral-function-discrete-data" class="md-nav__link">
    <span class="md-ellipsis">
      Impurity spectral function: discrete data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#impurity-spectral-function-continuous-curve" class="md-nav__link">
    <span class="md-ellipsis">
      Impurity spectral function: continuous curve
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dynamical-impurity-spin-susceptibility" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamical impurity spin susceptibility
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../NRG_Kondo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NRG for SIKM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../NRG_Kondo_Thermal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SIKM Thermal Properties
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../NRG_SpecFunc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NRG for Spectral Functions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    DMRG Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            DMRG Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DMRG/DMRGHubbard2D/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2D Hubbard Model
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/compactQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    compactQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/contractQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    contractQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/diagQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    diagQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/eigQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eigQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/fdmNRG_QS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fdmNRG_QS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/fgrNRG/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fgrNRG
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/getDimQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    getDimQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/getIdentityQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    getIdentityQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/getLocalSpace/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    getLocalSpace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/getQDimQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    getQDimQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/getRC/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    getRC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/getSmoothSpec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    getSmoothSpec
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/getSmoothTDM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    getSmoothTDM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/getSymStates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    getSymStates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/isHConjQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    isHConjQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/isIdentityCG/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    isIdentityCG
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/isIdentityQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    isIdentityQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/makeUniqueQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    makeUniqueQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/normQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    normQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/orthoQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    orthoQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/permuteQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    permuteQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/plusQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    plusQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/setupRCStore/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    setupRCStore
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/skipZerosQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    skipZerosQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/svdQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    svdQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/tdmNRG/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tdmNRG
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/traceQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    traceQS
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Contribute
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Contribute
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contribg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to Contribute
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mdref/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Markdown Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mkdocsg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MkDocs Guide
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#iterative-diagonalization" class="md-nav__link">
    <span class="md-ellipsis">
      Iterative diagonalization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#double-occupation-vs-temperature" class="md-nav__link">
    <span class="md-ellipsis">
      Double occupation vs. temperature
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#impurity-spectral-function-discrete-data" class="md-nav__link">
    <span class="md-ellipsis">
      Impurity spectral function: discrete data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#impurity-spectral-function-continuous-curve" class="md-nav__link">
    <span class="md-ellipsis">
      Impurity spectral function: continuous curve
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dynamical-impurity-spin-susceptibility" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamical impurity spin susceptibility
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/Open-Source-QSpace/QSpace-Documentation/edit/main/docs/examples/NRG/NRG3_ImpSpec.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/Open-Source-QSpace/QSpace-Documentation/raw/main/docs/examples/NRG/NRG3_ImpSpec.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


  <h1>NRG-3: Impurity Spectral Function</h1>

<p>Author: <a href="https://www.theorie.physik.uni-muenchen.de/lsvondelft/members/sci_mem/seung_sup-lee/index.html">Seung-Sup Lee</a></p>
<p>Date: 20.06.2020  (Minor update: 30.06.2020)</p>
<p>Here we will compute the <strong>thermal expectation value of impurity operators</strong> and the <strong>impurity spectral function,</strong> by using the <strong>full-density-matrix NRG</strong> (fdmNRG).</p>
<p>Consider an operator, say <span class="arithmatex">\({\hat{O} }_d\)</span> , that acts on the impurity. Then the spectral function of the retarded-time correlation function of <span class="arithmatex">\({\hat{O} }_d\)</span> is given by:</p>
<div class="arithmatex">\[
  A(\omega )=\frac{-1}{\pi }{\mathrm{I}\mathrm{m}}\int {\mathrm{d}}t\,\,e^{i\omega t} \left(-i\Theta (t)\langle [{\hat{O} }_d (t),{\hat{O} }_d^{\dagger} ]_{\pm } \rangle \right),~~~~~~~~(1) 
\]</div>
<p>where the superscript <span class="arithmatex">\(\pm\)</span> of the commutator means the anti-commutator <span class="arithmatex">\([\,\,,\,\,]_+\)</span> for fermionic <span class="arithmatex">\({\hat{O} }_d\)</span> and the commutator <span class="arithmatex">\([\,\,,\,\,]_-\)</span> for bosonic <span class="arithmatex">\({\hat{O} }_d\)</span> . With the energy eigenstates <span class="arithmatex">\(\lbrace |\alpha \rangle {\rbrace}\)</span> and their corresponding eigenvalues <span class="arithmatex">\(\lbrace E_{\alpha } \rbrace\)</span> , we write the <strong>Lehmann representation</strong> of the spectral function as</p>
<div class="arithmatex">\[
  A(\omega )=\sum_{\alpha \beta } \langle \alpha |{\hat{O} }_d |\beta \rangle \left(\langle \beta |{\hat{O} }_d^{\dagger} \,\hat{\rho} |\alpha \rangle \pm \langle \beta |\hat{\rho} \,{\hat{O} }_d^{\dagger} |\alpha \rangle \right)\,\,\delta ( \omega -(E_{\beta } -E_{\alpha } )),
\]</div>
<!-- |{\hat{O} }_d |\beta \rangle {\left}(\langle {\beta} |{\hat{O} }_d^{\dagger} \,\hat{\rho} |\alpha \rangle {\pm} \langle {\beta} |\hat{\rho} \,{\hat{O} }_d^{\dagger} |\alpha \rangle {\right})\,\,\delta ( \omega -(E_{\beta } -E_{\alpha } )), -->

<p>where <span class="arithmatex">\(\hat{\rho}\)</span> is the density matrix of the system at thermal equilbrium,</p>
<div class="arithmatex">\[
 \langle \alpha |\hat{\rho} |\beta \rangle =\delta_{\,\,\,\beta }^{\alpha } \frac{\exp (-E_{\beta } /T)}{Z}, 
\]</div>
<p>and <span class="arithmatex">\(Z=\sum_{\alpha } \exp (-E_{\alpha } /T)\)</span> is the partition function. In this tutorial, we will use <span class="arithmatex">\(\beta\)</span> as an index, not as the inverse temperature.</p>
<p>As explained in the lecture, the discarded eigenstates in the iterative diagonalization consitute the <strong>complete basis of (approximate) energy eigenstates</strong> <span class="arithmatex">\(\lbrace |\alpha ,e\rangle_{\ell }^D \rbrace\)</span> . However, it is hard to compute the spectral weight associated with <span class="arithmatex">\(|\alpha ,e\rangle_{\ell }^D\)</span> and <span class="arithmatex">\(|\beta ,e^{\prime } \rangle_{\ell^{\prime } }^D\)</span> that are at different iterations. Thus we employ the <strong>NRG approximation</strong> to compute spectral functions:</p>
<div class="arithmatex">\[
 A(\omega )=\sum_{\ell } \sum_{X,Y\not= KK} \sum_{\alpha \beta } A_{\alpha \beta }^{\ell XY} \,\,\delta \left(\omega -(E_{\beta }^{\ell Y} -E_{\alpha }^{\ell X} )\right)\,, 
\]</div>
<div class="arithmatex">\[
 A_{\alpha \beta}^{\ell X Y}=\left[B_{[\ell ]\,\,\,Y}^{~~\,X}\right]^\alpha{ }_\beta \left( {\left\lbrack C_{[\ell ]\,\,\,X}^{~~\,Y} \rho_{[\ell] X}^{~~\,X} \right\rbrack }_{\,\,\,\alpha }^{\beta } \pm \left[ \rho_{[\ell] Y}^{~~\,Y} C_{[\ell ]\,\,\,X}^{~~\,Y} \right]^{\beta}_{\,\,\,\alpha} \right)
\]</div>
<!-- $$
 A_{\alpha \beta }^{\ell XY} ={\left\lbrack B_{[\ell ]\,\,\,Y}^{~~\,X} \right\rbrack }_{\,\,\,\beta }^{\alpha } \left({\left\lbrack C_{[\ell ]\,\,\,X}^{~~\,\,Y} \rho_{[\ell ]\,\,\,X}^{~~X} \right\rbrack }_{\,\,\,\alpha }^{\beta } \pm {\left\lbrack \rho_{[\ell ]\,\,\,Y}^{~~Y} C_{[\ell ]\,\,\,X}^{~~\,\,Y} \right\rbrack }_{\,\,\,\alpha }^{\beta } \Big \right)\,, 
$$  -->

<div class="arithmatex">\[
 {\left\lbrack B_{[\ell ]\,\,\,Y}^{~~\,X} \right\rbrack }_{\,\,\,\beta }^{\alpha } =_{\ell }^X \langle \alpha |{\hat{O} }_d |\beta \rangle_{\ell }^Y \,, 
\]</div>
<div class="arithmatex">\[
 {\left\lbrack C_{[\ell ]\,\,\,X}^{~~\,Y} \right\rbrack }_{\,\,\,\alpha }^{\beta } =_{\ell }^Y \langle \beta |{\hat{O} }_d^{\dagger} |\alpha \rangle_{\ell }^X ={\left({\left\lbrack B_{[\ell ]\,\,\,Y}^{~~\,X} \right\rbrack }_{\,\,\,\beta }^{\alpha } \right)}^* \,. 
\]</div>
<p>Here <span class="arithmatex">\(\ell\)</span> is the iteration index, and <span class="arithmatex">\(X\)</span> and <span class="arithmatex">\(Y\)</span> are either <span class="arithmatex">\(K\)</span> (kept) or <span class="arithmatex">\(D\)</span> (discarded). The case <span class="arithmatex">\(X=Y=K\)</span> is not considered to avoid double-counting.</p>
<p>The density matrix in the discarded space is given by the diagonal matrix,</p>
<div class="arithmatex">\[
 [\rho_{[\ell ]\,\,D}^{~~\,D} ]_{\,\,\,\beta }^{\alpha }= \sum_e{ }_{\ell}^D\langle\alpha, e|\hat{\rho}| \beta, e\rangle_{\ell}^D=\delta_\beta^\alpha \frac{d^{N-\ell} \exp \left(-E_\alpha^{\ell D} / T\right)}{Z}
\]</div>
<p>where <span class="arithmatex">\(d\)</span> is the dimension of the local Hilbert space of each chain site, and <span class="arithmatex">\(N\)</span> is the index of the last chain site. In the construction of the complete basis <span class="arithmatex">\(\lbrace |\alpha ,e\rangle_{\ell }^D \rbrace =\lbrace |\alpha \rangle_{\ell }^D \otimes |\sigma_{\ell +1} \rangle \otimes |\sigma_{\ell +2} \rangle \otimes \cdots \otimes |\sigma_N \rangle \rbrace\)</span> , the "environmental states" <span class="arithmatex">\(|e \rangle =|\sigma_{\ell +1} \rangle \otimes |\sigma_{\ell +2} \rangle \otimes \cdots \otimes |\sigma_N \rangle\)</span> does not contribute to the energy; they only introduce the degeneracy. So <span class="arithmatex">\(d^{N-\ell }\)</span> counts the degeneracy introduced by the environmental states.</p>
<p>On the other hand, the density matrix in the kept space is given by tracing out the Hilbert spaces of later chain sites,</p>
<div class="arithmatex">\[
 \rho_{[\ell]}{ }_K^K=\sum_e{ }_{\ell}^K\langle\alpha, e|\hat{\rho}| \beta, e\rangle_{\ell}^K 
\]</div>
<div class="arithmatex">\[
 =\sum_{m&gt;\ell } \sum_{\vec{\sigma} } \sum_{\alpha } \langle \sigma_{\ell +1} |\cdots \langle \sigma_m |\alpha \rangle_m^D \,\,\,{\left\lbrack \rho_{[m]\,\,D}^{~~\,D} \right\rbrack }_{\,\,\,\alpha }^{\alpha } \,\,\,_m^D \langle \alpha |\sigma_m \rangle \cdots |\sigma_{\ell +1} \rangle . 
\]</div>
<p>And there are no off-diagonal blocks, i.e., <span class="arithmatex">\(\rho_{[\ell ]\,\,X}^{~~\,Y} =0\)</span> if <span class="arithmatex">\(X\not= Y\)</span> . The name of the method, "full density matrix", is given by the fact that the density matrices from the <strong>all</strong> iterations (i.e., all energy scales) are considered.</p>
<p>The Lehmann representation above represents the discrete spectral data of the spectral function; the result is the collection of the Dirac delta functions, rather than continuous curves. This discreteness originates from the logarithimic discretization of the originally continuous system. To return to the original continuity, we need to broaden the discrete data to obtain the continuous curves. For this, we use the broadening kernel that is the convolution of the symmetric logarithmic Gaussian (for broadening for high frequencies) and the derivative of the Fermi-Dirac distribution function (for broadening for low frequencies), as developed in [<a href="https://journals.aps.org/prb/abstract/10.1103/PhysRevB.94.235127">S.-S. B. Lee and A. Weichselbaum, Phys. Rev. B <strong>94</strong>, 235127 (2016)</a> or <a href="https://arxiv.org/abs/1609.01248">its arXiv version</a>].</p>
<p>Please review the following newly added functions:</p>
<ul>
<li><samp>getRhoFDMQS.m</samp>: It is zipped together with this document. This function is designed to construct the density matrices <span class="arithmatex">\(\rho_{[\ell ]\,\,D}^{~~\,D}\)</span> and <span class="arithmatex">\(\rho_{[\ell ]\,\,K}^{~~\,K}\)</span> . <strong>This function should be completed, as Exercise 1.</strong> See below for details. </li>
<li><samp>getAdiscQS.m</samp>: It is zipped together with this document. This function computes the Lehmann representation of the spectral function. Its second input corresponds to <span class="arithmatex">\({\hat{O} }_d\)</span> above. The first output <samp>odisc</samp> is the frequency grid, and the second output <samp>Adisc</samp> is the histogram of the spectral weights <span class="arithmatex">\(A_{\alpha \beta }^{\ell XY}\)</span> according to the frequency grid. That is, the value of <samp>Adisc(n)</samp> is the sum of all the spectral weights <span class="arithmatex">\(A_{\alpha \beta }^{\ell XY}\)</span> whose corresponding frequency values <span class="arithmatex">\(E_{\beta }^{\ell Y} -E_{\alpha }^{\ell X}\)</span> are close to the frequency bin value <samp>odisc(n)</samp>. <strong>This function should be completed, as Exercise 2.</strong> See below for details. </li>
<li><samp>NRG/getAcont.m</samp>: Broaden the discrete data to obtain continuous curves. In this tutorial, we will not discuss the detail of the function. So take this function as granted. Interested readers may refer to [<a href="https://journals.aps.org/prb/abstract/10.1103/PhysRevB.94.235127">S.-S. B. Lee and A. Weichselbaum, Phys. Rev. B <strong>94</strong>, 235127 (2016)</a> or <a href="https://arxiv.org/abs/1609.01248">its arXiv version</a>] for details. <em>(Yes, it's a shameless self-advertisement...)</em> </li>
</ul>
<h2 id="iterative-diagonalization"><strong>Iterative diagonalization</strong></h2>
<p>First, run the iterative diagonalization for the SIAM. Here we use the same parameters as those used in the last tutorial.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nb">clear</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="c">% Hamiltonian parameters</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">U</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">4e-3</span><span class="p">;</span><span class="w"> </span><span class="c">% Coulomb interaction at the impurity</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">epsd</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="c">% impurity on-site energy</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">Gamma</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">8e-5</span><span class="o">*</span><span class="nb">pi</span><span class="p">;</span><span class="w"> </span><span class="c">% hybridization strength</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="c">% NRG parameters</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">Lambda</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">2.5</span><span class="p">;</span><span class="w"> </span><span class="c">% discretization parameter</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">N</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">55</span><span class="p">;</span><span class="w"> </span><span class="c">% length of the Wilson chain</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">Nkeep</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">300</span><span class="p">;</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="c">% Wilson chain</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="p">[</span><span class="n">ff</span><span class="p">,</span><span class="n">gg</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">doCLD</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Gamma</span><span class="o">/</span><span class="nb">pi</span><span class="p">,</span><span class="n">Lambda</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>
</span></code></pre></div>
<p>Note that we don't need to post-process the Wilson chain parameters as we did for the tutorial T11a, since the calculations in this tutorial are stable against the (very) small numerical noise that mattered in T11a.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c">% symmetries</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">symstr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;Acharge,SU2spin&#39;</span><span class="p">;</span><span class="w"> </span><span class="c">% U(1) charge and SU(2) spin</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="c">% symstr = &#39;Acharge,Aspin&#39;; % U(1) charge and U(1) spin</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="c">% Construct local operators</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="p">[</span><span class="n">F</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">I</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getLocalSpace</span><span class="p">(</span><span class="s">&#39;FermionS&#39;</span><span class="p">,</span><span class="n">symstr</span><span class="p">,</span><span class="s">&#39;NC&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="p">[</span><span class="n">F</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">EF</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">setItag</span><span class="p">(</span><span class="s">&#39;s00&#39;</span><span class="p">,</span><span class="s">&#39;op&#39;</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">);</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="c">% particle number operator</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="n">NF</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">QSpace</span><span class="p">;</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="k">for</span><span class="w"> </span><span class="n">itF</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">numel</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="w">    </span><span class="n">NF</span><span class="p">(</span><span class="n">itF</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">contract</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">itF</span><span class="p">),</span><span class="s">&#39;!2*&#39;</span><span class="p">,</span><span class="n">F</span><span class="p">(</span><span class="n">itF</span><span class="p">));</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="k">end</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="c">% Impurity Hamiltonian</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="n">H0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">U</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">NF</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">NF</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">epsd</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">NF</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1e-33</span><span class="o">*</span><span class="n">EF</span><span class="p">;</span>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="c">% ket tensor for the impurity</span>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="n">A0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getIdentity</span><span class="p">(</span><span class="n">setItag</span><span class="p">(</span><span class="s">&#39;L00&#39;</span><span class="p">,</span><span class="n">getvac</span><span class="p">(</span><span class="n">EF</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span><span class="mi">1</span><span class="p">,</span><span class="n">EF</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;K00&#39;</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]);</span>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="n">H0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">contract</span><span class="p">(</span><span class="n">A0</span><span class="p">,</span><span class="s">&#39;!2*&#39;</span><span class="p">,{</span><span class="n">A0</span><span class="p">,</span><span class="n">H0</span><span class="p">});</span>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a><span class="c">% same hopping amplitude and on-site energies for all flavors</span>
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="n">ff</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">repmat</span><span class="p">(</span><span class="n">ff</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="nb">numel</span><span class="p">(</span><span class="n">F</span><span class="p">)]);</span>
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a><span class="n">gg</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">repmat</span><span class="p">(</span><span class="n">gg</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="nb">numel</span><span class="p">(</span><span class="n">F</span><span class="p">)]);</span>
</span><span id="__span-1-26"><a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a>
</span><span id="__span-1-27"><a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a><span class="c">% iterative diagonalization</span>
</span><span id="__span-1-28"><a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a><span class="n">Inrg</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">NRG_IterDiagQS</span><span class="p">(</span><span class="n">H0</span><span class="p">,</span><span class="n">A0</span><span class="p">,</span><span class="n">Lambda</span><span class="p">,</span><span class="n">ff</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">gg</span><span class="p">,</span><span class="n">NF</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">Nkeep</span><span class="p">);</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>21-05-11 17:03:32 | NRG: start
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>21-05-11 17:03:32 | #00/55 : NK=3/3, EK=1e-33/1e-33
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>21-05-11 17:03:32 | #01/55 : NK=10/10, EK=0.04894/0.04894
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>21-05-11 17:03:32 | #02/55 : NK=35/35, EK=3.209/3.209
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>21-05-11 17:03:32 | #03/55 : NK=126/126, EK=6.225/6.225
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>21-05-11 17:03:32 | #04/55 : NK=310/462, EK=7.499/13.02
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>21-05-11 17:03:32 | #05/55 : NK=310/1154, EK=7.033/13.08
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>21-05-11 17:03:32 | #06/55 : NK=318/1150, EK=7.243/13.62
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>21-05-11 17:03:32 | #07/55 : NK=310/1178, EK=7.047/13.09
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>21-05-11 17:03:33 | #08/55 : NK=318/1150, EK=7.248/13.61
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>21-05-11 17:03:33 | #09/55 : NK=310/1178, EK=7.073/13.13
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>21-05-11 17:03:33 | #10/55 : NK=318/1150, EK=7.274/13.59
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>21-05-11 17:03:33 | #11/55 : NK=310/1178, EK=7.117/13.19
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>21-05-11 17:03:33 | #12/55 : NK=318/1150, EK=7.359/13.59
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>21-05-11 17:03:33 | #13/55 : NK=310/1178, EK=7.207/13.33
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>21-05-11 17:03:33 | #14/55 : NK=322/1150, EK=7.688/13.9
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>21-05-11 17:03:34 | #15/55 : NK=312/1192, EK=7.46/13.82
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>21-05-11 17:03:34 | #16/55 : NK=327/1166, EK=8.385/14.7
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>21-05-11 17:03:34 | #17/55 : NK=304/1218, EK=8.45/14.98
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>21-05-11 17:03:34 | #18/55 : NK=307/1136, EK=9.027/16.05
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>21-05-11 17:03:34 | #19/55 : NK=312/1148, EK=9.33/16.02
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>21-05-11 17:03:34 | #20/55 : NK=311/1170, EK=9.719/17.5
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>21-05-11 17:03:34 | #21/55 : NK=327/1174, EK=9.804/17.18
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a>21-05-11 17:03:34 | #22/55 : NK=311/1231, EK=9.781/18.26
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a>21-05-11 17:03:35 | #23/55 : NK=302/1174, EK=9.751/17.32
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a>21-05-11 17:03:35 | #24/55 : NK=311/1134, EK=9.836/17.88
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a>21-05-11 17:03:35 | #25/55 : NK=322/1174, EK=9.979/17.46
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a>21-05-11 17:03:35 | #26/55 : NK=311/1210, EK=9.916/18.36
</span><span id="__span-2-29"><a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a>21-05-11 17:03:35 | #27/55 : NK=322/1174, EK=10.13/17.64
</span><span id="__span-2-30"><a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a>21-05-11 17:03:35 | #28/55 : NK=325/1210, EK=10.18/18.32
</span><span id="__span-2-31"><a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a>21-05-11 17:03:35 | #29/55 : NK=322/1224, EK=10.34/18.23
</span><span id="__span-2-32"><a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a>21-05-11 17:03:36 | #30/55 : NK=315/1210, EK=10.19/18.35
</span><span id="__span-2-33"><a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a>21-05-11 17:03:36 | #31/55 : NK=322/1184, EK=10.65/18.36
</span><span id="__span-2-34"><a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a>21-05-11 17:03:36 | #32/55 : NK=303/1210, EK=10.33/18.76
</span><span id="__span-2-35"><a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a>21-05-11 17:03:36 | #33/55 : NK=300/1136, EK=10.79/18.81
</span><span id="__span-2-36"><a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a>21-05-11 17:03:36 | #34/55 : NK=318/1122, EK=10.94/18.84
</span><span id="__span-2-37"><a id="__codelineno-2-37" name="__codelineno-2-37" href="#__codelineno-2-37"></a>21-05-11 17:03:36 | #35/55 : NK=300/1190, EK=11.33/19.89
</span><span id="__span-2-38"><a id="__codelineno-2-38" name="__codelineno-2-38" href="#__codelineno-2-38"></a>21-05-11 17:03:36 | #36/55 : NK=301/1119, EK=11.16/19.39
</span><span id="__span-2-39"><a id="__codelineno-2-39" name="__codelineno-2-39" href="#__codelineno-2-39"></a>21-05-11 17:03:36 | #37/55 : NK=316/1118, EK=11.94/20.4
</span><span id="__span-2-40"><a id="__codelineno-2-40" name="__codelineno-2-40" href="#__codelineno-2-40"></a>21-05-11 17:03:37 | #38/55 : NK=306/1175, EK=11.61/20.4
</span><span id="__span-2-41"><a id="__codelineno-2-41" name="__codelineno-2-41" href="#__codelineno-2-41"></a>21-05-11 17:03:37 | #39/55 : NK=310/1136, EK=12.08/21.49
</span><span id="__span-2-42"><a id="__codelineno-2-42" name="__codelineno-2-42" href="#__codelineno-2-42"></a>21-05-11 17:03:37 | #40/55 : NK=306/1151, EK=11.76/20.7
</span><span id="__span-2-43"><a id="__codelineno-2-43" name="__codelineno-2-43" href="#__codelineno-2-43"></a>21-05-11 17:03:37 | #41/55 : NK=307/1136, EK=11.97/21.78
</span><span id="__span-2-44"><a id="__codelineno-2-44" name="__codelineno-2-44" href="#__codelineno-2-44"></a>21-05-11 17:03:37 | #42/55 : NK=306/1139, EK=11.82/20.14
</span><span id="__span-2-45"><a id="__codelineno-2-45" name="__codelineno-2-45" href="#__codelineno-2-45"></a>21-05-11 17:03:37 | #43/55 : NK=309/1136, EK=12.2/21.9
</span><span id="__span-2-46"><a id="__codelineno-2-46" name="__codelineno-2-46" href="#__codelineno-2-46"></a>21-05-11 17:03:37 | #44/55 : NK=306/1147, EK=11.85/20.88
</span><span id="__span-2-47"><a id="__codelineno-2-47" name="__codelineno-2-47" href="#__codelineno-2-47"></a>21-05-11 17:03:38 | #45/55 : NK=309/1136, EK=12.21/21.95
</span><span id="__span-2-48"><a id="__codelineno-2-48" name="__codelineno-2-48" href="#__codelineno-2-48"></a>21-05-11 17:03:38 | #46/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-2-49"><a id="__codelineno-2-49" name="__codelineno-2-49" href="#__codelineno-2-49"></a>21-05-11 17:03:38 | #47/55 : NK=309/1136, EK=12.22/21.97
</span><span id="__span-2-50"><a id="__codelineno-2-50" name="__codelineno-2-50" href="#__codelineno-2-50"></a>21-05-11 17:03:38 | #48/55 : NK=306/1147, EK=11.86/20.91
</span><span id="__span-2-51"><a id="__codelineno-2-51" name="__codelineno-2-51" href="#__codelineno-2-51"></a>21-05-11 17:03:38 | #49/55 : NK=309/1136, EK=12.22/21.98
</span><span id="__span-2-52"><a id="__codelineno-2-52" name="__codelineno-2-52" href="#__codelineno-2-52"></a>21-05-11 17:03:38 | #50/55 : NK=306/1147, EK=11.86/20.91
</span><span id="__span-2-53"><a id="__codelineno-2-53" name="__codelineno-2-53" href="#__codelineno-2-53"></a>21-05-11 17:03:38 | #51/55 : NK=309/1136, EK=12.22/21.98
</span><span id="__span-2-54"><a id="__codelineno-2-54" name="__codelineno-2-54" href="#__codelineno-2-54"></a>21-05-11 17:03:38 | #52/55 : NK=306/1147, EK=11.86/20.91
</span><span id="__span-2-55"><a id="__codelineno-2-55" name="__codelineno-2-55" href="#__codelineno-2-55"></a>21-05-11 17:03:39 | #53/55 : NK=309/1136, EK=12.22/21.98
</span><span id="__span-2-56"><a id="__codelineno-2-56" name="__codelineno-2-56" href="#__codelineno-2-56"></a>21-05-11 17:03:39 | #54/55 : NK=306/1147, EK=11.86/20.91
</span><span id="__span-2-57"><a id="__codelineno-2-57" name="__codelineno-2-57" href="#__codelineno-2-57"></a>21-05-11 17:03:39 | #55/55 : NK=0/1136, EK=0/21.98
</span><span id="__span-2-58"><a id="__codelineno-2-58" name="__codelineno-2-58" href="#__codelineno-2-58"></a>21-05-11 17:03:39 | Memory usage : 1.98GiB
</span><span id="__span-2-59"><a id="__codelineno-2-59" name="__codelineno-2-59" href="#__codelineno-2-59"></a>Elapsed time: 7.017s, CPU time: 14.64s, Avg # of cores: 2.086
</span></code></pre></div>
<p>Plot the energy flow diagram.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c">% Energy flow diagram</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">Eshow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="c">% energy window to show (from 0 to Eshow)</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="c">% determine energy levels, corresponding quantum numbers and degeneracies</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="n">Es</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">cell</span><span class="p">(</span><span class="nb">numel</span><span class="p">(</span><span class="n">Inrg</span><span class="p">.</span><span class="n">HK</span><span class="p">),</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c">% energies</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="n">Qs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">cell</span><span class="p">(</span><span class="nb">numel</span><span class="p">(</span><span class="n">Inrg</span><span class="p">.</span><span class="n">HK</span><span class="p">),</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c">% corresponding quantum numbers</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="k">for</span><span class="w"> </span><span class="n">itN</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">numel</span><span class="p">(</span><span class="n">Es</span><span class="p">)</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">itN</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="w">        </span><span class="n">HN</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Inrg</span><span class="p">.</span><span class="n">HK</span><span class="p">{</span><span class="n">itN</span><span class="p">};</span><span class="w"> </span><span class="c">% kept Hamiltonian at itN</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="w">    </span><span class="k">else</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="w">        </span><span class="n">HN</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Inrg</span><span class="p">.</span><span class="n">HD</span><span class="p">{</span><span class="n">itN</span><span class="p">};</span><span class="w"> </span><span class="c">% only discarded states at the last iteration</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="w">    </span><span class="k">end</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">itN</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="c">% impurity is not diagonalized in NRG_IterDiagQS</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="w">        </span><span class="p">[</span><span class="o">~</span><span class="p">,</span><span class="n">I</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">eigQS</span><span class="p">(</span><span class="n">HN</span><span class="p">);</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="w">        </span><span class="n">HN</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">QSpace</span><span class="p">(</span><span class="n">I</span><span class="p">.</span><span class="n">EK</span><span class="p">);</span>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="w">    </span><span class="k">end</span>
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">itq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">size</span><span class="p">(</span><span class="n">HN</span><span class="p">.</span><span class="n">Q</span><span class="p">{</span><span class="mi">1</span><span class="p">},</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a><span class="w">        </span><span class="n">Qs</span><span class="p">{</span><span class="n">itN</span><span class="p">}(</span><span class="n">itq</span><span class="p">,:)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">HN</span><span class="p">.</span><span class="n">Q</span><span class="p">{</span><span class="mi">1</span><span class="p">}(</span><span class="n">itq</span><span class="p">,:);</span>
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a><span class="w">        </span><span class="n">Es</span><span class="p">{</span><span class="n">itN</span><span class="p">}{</span><span class="n">itq</span><span class="p">,</span><span class="mi">1</span><span class="p">}</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sort</span><span class="p">((</span><span class="n">HN</span><span class="p">.</span><span class="n">data</span><span class="p">{</span><span class="n">itq</span><span class="p">}(</span><span class="n">HN</span><span class="p">.</span><span class="n">data</span><span class="p">{</span><span class="n">itq</span><span class="p">}</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">Eshow</span><span class="p">))</span><span class="o">&#39;</span><span class="p">,</span><span class="s">&#39;ascend&#39;</span><span class="p">);</span>
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a><span class="w">    </span><span class="k">end</span>
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a><span class="k">end</span>
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a>
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a><span class="c">% get maximum number of energy levels per symmetry sector</span>
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a><span class="n">nEmax</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a><span class="k">for</span><span class="w"> </span><span class="n">iti</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">numel</span><span class="p">(</span><span class="n">Es</span><span class="p">)</span>
</span><span id="__span-3-30"><a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a><span class="w">    </span><span class="n">nEmax</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">max</span><span class="p">([</span><span class="n">nEmax</span><span class="p">;</span><span class="nb">cellfun</span><span class="p">(</span><span class="s">&#39;prodofsize&#39;</span><span class="p">,</span><span class="n">Es</span><span class="p">{</span><span class="n">iti</span><span class="p">}(:))]);</span>
</span><span id="__span-3-31"><a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a><span class="k">end</span>
</span><span id="__span-3-32"><a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a>
</span><span id="__span-3-33"><a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a><span class="n">Quniq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">unique</span><span class="p">(</span><span class="nb">cell2mat</span><span class="p">(</span><span class="n">Qs</span><span class="p">),</span><span class="s">&#39;rows&#39;</span><span class="p">);</span><span class="w"> </span><span class="c">% unique sets of quantum numbers</span>
</span><span id="__span-3-34"><a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a><span class="n">Es2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">cell</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">Quniq</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c">% each Es2{n} is the collection of curves for each quantum number set Quniq(n,:)</span>
</span><span id="__span-3-35"><a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a><span class="n">Eeven</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">cell</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">Quniq</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c">% even iterations</span>
</span><span id="__span-3-36"><a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a><span class="n">Eodd</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">cell</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">Quniq</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c">% even iterations</span>
</span><span id="__span-3-37"><a id="__codelineno-3-37" name="__codelineno-3-37" href="#__codelineno-3-37"></a>
</span><span id="__span-3-38"><a id="__codelineno-3-38" name="__codelineno-3-38" href="#__codelineno-3-38"></a><span class="k">for</span><span class="w"> </span><span class="n">itq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">size</span><span class="p">(</span><span class="n">Quniq</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</span><span id="__span-3-39"><a id="__codelineno-3-39" name="__codelineno-3-39" href="#__codelineno-3-39"></a><span class="w">    </span><span class="n">Es2</span><span class="p">{</span><span class="n">itq</span><span class="p">}</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">nan</span><span class="p">(</span><span class="nb">numel</span><span class="p">(</span><span class="n">Es</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">nEmax</span><span class="p">);</span>
</span><span id="__span-3-40"><a id="__codelineno-3-40" name="__codelineno-3-40" href="#__codelineno-3-40"></a>
</span><span id="__span-3-41"><a id="__codelineno-3-41" name="__codelineno-3-41" href="#__codelineno-3-41"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">iti</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">numel</span><span class="p">(</span><span class="n">Es</span><span class="p">)</span>
</span><span id="__span-3-42"><a id="__codelineno-3-42" name="__codelineno-3-42" href="#__codelineno-3-42"></a><span class="w">        </span><span class="n">okq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">ismember</span><span class="p">(</span><span class="n">Qs</span><span class="p">{</span><span class="n">iti</span><span class="p">},</span><span class="n">Quniq</span><span class="p">(</span><span class="n">itq</span><span class="p">,:),</span><span class="s">&#39;rows&#39;</span><span class="p">);</span>
</span><span id="__span-3-43"><a id="__codelineno-3-43" name="__codelineno-3-43" href="#__codelineno-3-43"></a>
</span><span id="__span-3-44"><a id="__codelineno-3-44" name="__codelineno-3-44" href="#__codelineno-3-44"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nb">any</span><span class="p">(</span><span class="n">okq</span><span class="p">)</span>
</span><span id="__span-3-45"><a id="__codelineno-3-45" name="__codelineno-3-45" href="#__codelineno-3-45"></a><span class="w">            </span><span class="n">Etmp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Es</span><span class="p">{</span><span class="n">iti</span><span class="p">}{</span><span class="n">okq</span><span class="p">};</span>
</span><span id="__span-3-46"><a id="__codelineno-3-46" name="__codelineno-3-46" href="#__codelineno-3-46"></a><span class="w">            </span><span class="n">Es2</span><span class="p">{</span><span class="n">itq</span><span class="p">}(</span><span class="n">iti</span><span class="p">,(</span><span class="mi">1</span><span class="p">:</span><span class="nb">numel</span><span class="p">(</span><span class="n">Etmp</span><span class="p">)))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Etmp</span><span class="p">(:).</span><span class="o">&#39;</span><span class="p">;</span>
</span><span id="__span-3-47"><a id="__codelineno-3-47" name="__codelineno-3-47" href="#__codelineno-3-47"></a><span class="w">        </span><span class="k">end</span>
</span><span id="__span-3-48"><a id="__codelineno-3-48" name="__codelineno-3-48" href="#__codelineno-3-48"></a><span class="w">    </span><span class="k">end</span>
</span><span id="__span-3-49"><a id="__codelineno-3-49" name="__codelineno-3-49" href="#__codelineno-3-49"></a>
</span><span id="__span-3-50"><a id="__codelineno-3-50" name="__codelineno-3-50" href="#__codelineno-3-50"></a><span class="w">    </span><span class="n">Es2</span><span class="p">{</span><span class="n">itq</span><span class="p">}(:,(</span><span class="nb">find</span><span class="p">(</span><span class="o">~</span><span class="nb">all</span><span class="p">(</span><span class="nb">isnan</span><span class="p">(</span><span class="n">Es2</span><span class="p">{</span><span class="n">itq</span><span class="p">}),</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;last&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="k">end</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-3-51"><a id="__codelineno-3-51" name="__codelineno-3-51" href="#__codelineno-3-51"></a>
</span><span id="__span-3-52"><a id="__codelineno-3-52" name="__codelineno-3-52" href="#__codelineno-3-52"></a><span class="w">    </span><span class="n">Eeven</span><span class="p">{</span><span class="n">itq</span><span class="p">}</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Es2</span><span class="p">{</span><span class="n">itq</span><span class="p">}(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="p">,:);</span><span class="w"> </span><span class="c">% impurity is 0, i.e. even</span>
</span><span id="__span-3-53"><a id="__codelineno-3-53" name="__codelineno-3-53" href="#__codelineno-3-53"></a><span class="w">    </span><span class="n">Eodd</span><span class="p">{</span><span class="n">itq</span><span class="p">}</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Es2</span><span class="p">{</span><span class="n">itq</span><span class="p">}(</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="p">,:);</span>
</span><span id="__span-3-54"><a id="__codelineno-3-54" name="__codelineno-3-54" href="#__codelineno-3-54"></a>
</span><span id="__span-3-55"><a id="__codelineno-3-55" name="__codelineno-3-55" href="#__codelineno-3-55"></a><span class="k">end</span>
</span><span id="__span-3-56"><a id="__codelineno-3-56" name="__codelineno-3-56" href="#__codelineno-3-56"></a>
</span><span id="__span-3-57"><a id="__codelineno-3-57" name="__codelineno-3-57" href="#__codelineno-3-57"></a><span class="c">% shorten Eeven and Eodd such that only a single row of NaN&#39;s remains</span>
</span><span id="__span-3-58"><a id="__codelineno-3-58" name="__codelineno-3-58" href="#__codelineno-3-58"></a><span class="n">Neven</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">Nodd</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-3-59"><a id="__codelineno-3-59" name="__codelineno-3-59" href="#__codelineno-3-59"></a><span class="k">for</span><span class="w"> </span><span class="n">itq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">numel</span><span class="p">(</span><span class="n">Eeven</span><span class="p">)</span>
</span><span id="__span-3-60"><a id="__codelineno-3-60" name="__codelineno-3-60" href="#__codelineno-3-60"></a><span class="w">    </span><span class="n">Neven</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">max</span><span class="p">([</span><span class="n">Neven</span><span class="p">,</span><span class="nb">find</span><span class="p">(</span><span class="o">~</span><span class="nb">all</span><span class="p">(</span><span class="nb">isnan</span><span class="p">(</span><span class="n">Eeven</span><span class="p">{</span><span class="n">itq</span><span class="p">}),</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;last&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">]);</span><span class="w"> </span>
</span><span id="__span-3-61"><a id="__codelineno-3-61" name="__codelineno-3-61" href="#__codelineno-3-61"></a><span class="w">    </span><span class="n">Nodd</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">max</span><span class="p">([</span><span class="n">Nodd</span><span class="p">,</span><span class="nb">find</span><span class="p">(</span><span class="o">~</span><span class="nb">all</span><span class="p">(</span><span class="nb">isnan</span><span class="p">(</span><span class="n">Eodd</span><span class="p">{</span><span class="n">itq</span><span class="p">}),</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;last&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">]);</span>
</span><span id="__span-3-62"><a id="__codelineno-3-62" name="__codelineno-3-62" href="#__codelineno-3-62"></a><span class="k">end</span>
</span><span id="__span-3-63"><a id="__codelineno-3-63" name="__codelineno-3-63" href="#__codelineno-3-63"></a><span class="k">for</span><span class="w"> </span><span class="n">itq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">numel</span><span class="p">(</span><span class="n">Eeven</span><span class="p">)</span>
</span><span id="__span-3-64"><a id="__codelineno-3-64" name="__codelineno-3-64" href="#__codelineno-3-64"></a>
</span><span id="__span-3-65"><a id="__codelineno-3-65" name="__codelineno-3-65" href="#__codelineno-3-65"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nb">size</span><span class="p">(</span><span class="n">Eeven</span><span class="p">{</span><span class="n">itq</span><span class="p">},</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">Neven</span>
</span><span id="__span-3-66"><a id="__codelineno-3-66" name="__codelineno-3-66" href="#__codelineno-3-66"></a><span class="w">        </span><span class="n">Eeven</span><span class="p">{</span><span class="n">itq</span><span class="p">}</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Eeven</span><span class="p">{</span><span class="n">itq</span><span class="p">}(</span><span class="mi">1</span><span class="p">:</span><span class="n">Neven</span><span class="p">,:);</span>
</span><span id="__span-3-67"><a id="__codelineno-3-67" name="__codelineno-3-67" href="#__codelineno-3-67"></a><span class="w">    </span><span class="k">else</span>
</span><span id="__span-3-68"><a id="__codelineno-3-68" name="__codelineno-3-68" href="#__codelineno-3-68"></a><span class="w">        </span><span class="n">Eeven</span><span class="p">{</span><span class="n">itq</span><span class="p">}(</span><span class="k">end</span><span class="o">+</span><span class="mi">1</span><span class="p">,:)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">nan</span><span class="p">;</span>
</span><span id="__span-3-69"><a id="__codelineno-3-69" name="__codelineno-3-69" href="#__codelineno-3-69"></a><span class="w">    </span><span class="k">end</span>
</span><span id="__span-3-70"><a id="__codelineno-3-70" name="__codelineno-3-70" href="#__codelineno-3-70"></a>
</span><span id="__span-3-71"><a id="__codelineno-3-71" name="__codelineno-3-71" href="#__codelineno-3-71"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nb">size</span><span class="p">(</span><span class="n">Eodd</span><span class="p">{</span><span class="n">itq</span><span class="p">},</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">Nodd</span>
</span><span id="__span-3-72"><a id="__codelineno-3-72" name="__codelineno-3-72" href="#__codelineno-3-72"></a><span class="w">        </span><span class="n">Eodd</span><span class="p">{</span><span class="n">itq</span><span class="p">}</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Eodd</span><span class="p">{</span><span class="n">itq</span><span class="p">}(</span><span class="mi">1</span><span class="p">:</span><span class="n">Nodd</span><span class="p">,:);</span>
</span><span id="__span-3-73"><a id="__codelineno-3-73" name="__codelineno-3-73" href="#__codelineno-3-73"></a><span class="w">    </span><span class="k">else</span>
</span><span id="__span-3-74"><a id="__codelineno-3-74" name="__codelineno-3-74" href="#__codelineno-3-74"></a><span class="w">        </span><span class="n">Eodd</span><span class="p">{</span><span class="n">itq</span><span class="p">}(</span><span class="k">end</span><span class="o">+</span><span class="mi">1</span><span class="p">,:)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">nan</span><span class="p">;</span>
</span><span id="__span-3-75"><a id="__codelineno-3-75" name="__codelineno-3-75" href="#__codelineno-3-75"></a><span class="w">    </span><span class="k">end</span>
</span><span id="__span-3-76"><a id="__codelineno-3-76" name="__codelineno-3-76" href="#__codelineno-3-76"></a>
</span><span id="__span-3-77"><a id="__codelineno-3-77" name="__codelineno-3-77" href="#__codelineno-3-77"></a><span class="k">end</span>
</span><span id="__span-3-78"><a id="__codelineno-3-78" name="__codelineno-3-78" href="#__codelineno-3-78"></a>
</span><span id="__span-3-79"><a id="__codelineno-3-79" name="__codelineno-3-79" href="#__codelineno-3-79"></a><span class="c">% quantum numbers for even and odd iterations</span>
</span><span id="__span-3-80"><a id="__codelineno-3-80" name="__codelineno-3-80" href="#__codelineno-3-80"></a><span class="n">Qeven</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Quniq</span><span class="p">;</span>
</span><span id="__span-3-81"><a id="__codelineno-3-81" name="__codelineno-3-81" href="#__codelineno-3-81"></a><span class="n">Qodd</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Quniq</span><span class="p">;</span>
</span><span id="__span-3-82"><a id="__codelineno-3-82" name="__codelineno-3-82" href="#__codelineno-3-82"></a>
</span><span id="__span-3-83"><a id="__codelineno-3-83" name="__codelineno-3-83" href="#__codelineno-3-83"></a><span class="c">% delete all NaN sectors</span>
</span><span id="__span-3-84"><a id="__codelineno-3-84" name="__codelineno-3-84" href="#__codelineno-3-84"></a><span class="n">iQeven</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">cellfun</span><span class="p">(@(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="nb">all</span><span class="p">(</span><span class="nb">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">(:))),</span><span class="n">Eeven</span><span class="p">);</span>
</span><span id="__span-3-85"><a id="__codelineno-3-85" name="__codelineno-3-85" href="#__codelineno-3-85"></a><span class="n">Eeven</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Eeven</span><span class="p">(</span><span class="o">~</span><span class="n">iQeven</span><span class="p">);</span>
</span><span id="__span-3-86"><a id="__codelineno-3-86" name="__codelineno-3-86" href="#__codelineno-3-86"></a><span class="n">Qeven</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Qeven</span><span class="p">(</span><span class="o">~</span><span class="n">iQeven</span><span class="p">,:);</span>
</span><span id="__span-3-87"><a id="__codelineno-3-87" name="__codelineno-3-87" href="#__codelineno-3-87"></a>
</span><span id="__span-3-88"><a id="__codelineno-3-88" name="__codelineno-3-88" href="#__codelineno-3-88"></a><span class="n">iQodd</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">cellfun</span><span class="p">(@(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="nb">all</span><span class="p">(</span><span class="nb">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">(:))),</span><span class="n">Eodd</span><span class="p">);</span>
</span><span id="__span-3-89"><a id="__codelineno-3-89" name="__codelineno-3-89" href="#__codelineno-3-89"></a><span class="n">Eodd</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Eodd</span><span class="p">(</span><span class="o">~</span><span class="n">iQodd</span><span class="p">);</span>
</span><span id="__span-3-90"><a id="__codelineno-3-90" name="__codelineno-3-90" href="#__codelineno-3-90"></a><span class="n">Qodd</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Qodd</span><span class="p">(</span><span class="o">~</span><span class="n">iQodd</span><span class="p">,:);</span>
</span><span id="__span-3-91"><a id="__codelineno-3-91" name="__codelineno-3-91" href="#__codelineno-3-91"></a>
</span><span id="__span-3-92"><a id="__codelineno-3-92" name="__codelineno-3-92" href="#__codelineno-3-92"></a><span class="c">% sort by lowest energy at last iteration</span>
</span><span id="__span-3-93"><a id="__codelineno-3-93" name="__codelineno-3-93" href="#__codelineno-3-93"></a><span class="p">[</span><span class="o">~</span><span class="p">,</span><span class="n">sid</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sort</span><span class="p">(</span><span class="nb">cellfun</span><span class="p">(@(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">,:)),</span><span class="w"> </span><span class="n">Eeven</span><span class="p">),</span><span class="s">&#39;ascend&#39;</span><span class="p">);</span><span class="w"> </span><span class="c">% for &#39;min&#39; and &#39;sort&#39;, NaN is considered to be the largest</span>
</span><span id="__span-3-94"><a id="__codelineno-3-94" name="__codelineno-3-94" href="#__codelineno-3-94"></a><span class="n">Qeven</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Qeven</span><span class="p">(</span><span class="n">sid</span><span class="p">,:);</span>
</span><span id="__span-3-95"><a id="__codelineno-3-95" name="__codelineno-3-95" href="#__codelineno-3-95"></a><span class="n">Eeven</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Eeven</span><span class="p">(</span><span class="n">sid</span><span class="p">);</span>
</span><span id="__span-3-96"><a id="__codelineno-3-96" name="__codelineno-3-96" href="#__codelineno-3-96"></a>
</span><span id="__span-3-97"><a id="__codelineno-3-97" name="__codelineno-3-97" href="#__codelineno-3-97"></a><span class="p">[</span><span class="o">~</span><span class="p">,</span><span class="n">sid</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sort</span><span class="p">(</span><span class="nb">cellfun</span><span class="p">(@(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">,:)),</span><span class="w"> </span><span class="n">Eodd</span><span class="p">),</span><span class="s">&#39;ascend&#39;</span><span class="p">);</span><span class="w"> </span><span class="c">% for &#39;min&#39; and &#39;sort&#39;, NaN is considered to be the largest</span>
</span><span id="__span-3-98"><a id="__codelineno-3-98" name="__codelineno-3-98" href="#__codelineno-3-98"></a><span class="n">Qodd</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Qodd</span><span class="p">(</span><span class="n">sid</span><span class="p">,:);</span>
</span><span id="__span-3-99"><a id="__codelineno-3-99" name="__codelineno-3-99" href="#__codelineno-3-99"></a><span class="n">Eodd</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Eodd</span><span class="p">(</span><span class="n">sid</span><span class="p">);</span>
</span><span id="__span-3-100"><a id="__codelineno-3-100" name="__codelineno-3-100" href="#__codelineno-3-100"></a>
</span><span id="__span-3-101"><a id="__codelineno-3-101" name="__codelineno-3-101" href="#__codelineno-3-101"></a><span class="c">% colors:</span>
</span><span id="__span-3-102"><a id="__codelineno-3-102" name="__codelineno-3-102" href="#__codelineno-3-102"></a><span class="n">clrs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">228</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">28</span><span class="p">;</span><span class="k">...</span>
</span><span id="__span-3-103"><a id="__codelineno-3-103" name="__codelineno-3-103" href="#__codelineno-3-103"></a><span class="w">    </span><span class="mi">55</span><span class="p">,</span><span class="mi">126</span><span class="p">,</span><span class="mi">184</span><span class="p">;</span><span class="k">...</span>
</span><span id="__span-3-104"><a id="__codelineno-3-104" name="__codelineno-3-104" href="#__codelineno-3-104"></a><span class="w">    </span><span class="mi">77</span><span class="p">,</span><span class="mi">175</span><span class="p">,</span><span class="mi">74</span><span class="p">;</span><span class="k">...</span>
</span><span id="__span-3-105"><a id="__codelineno-3-105" name="__codelineno-3-105" href="#__codelineno-3-105"></a><span class="w">    </span><span class="mi">152</span><span class="p">,</span><span class="mi">78</span><span class="p">,</span><span class="mi">163</span><span class="p">;</span><span class="k">...</span>
</span><span id="__span-3-106"><a id="__codelineno-3-106" name="__codelineno-3-106" href="#__codelineno-3-106"></a><span class="w">    </span><span class="mi">255</span><span class="p">,</span><span class="mi">127</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">256</span><span class="p">;</span><span class="w"> </span><span class="c">% colors for lowest few energy levels</span>
</span><span id="__span-3-107"><a id="__codelineno-3-107" name="__codelineno-3-107" href="#__codelineno-3-107"></a><span class="w">                    </span><span class="c">% size(clrs,1) determines number of colored levels</span>
</span><span id="__span-3-108"><a id="__codelineno-3-108" name="__codelineno-3-108" href="#__codelineno-3-108"></a><span class="c">% default line color: gray</span>
</span><span id="__span-3-109"><a id="__codelineno-3-109" name="__codelineno-3-109" href="#__codelineno-3-109"></a><span class="n">clrs0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">0.7</span><span class="p">;</span>
</span><span id="__span-3-110"><a id="__codelineno-3-110" name="__codelineno-3-110" href="#__codelineno-3-110"></a>
</span><span id="__span-3-111"><a id="__codelineno-3-111" name="__codelineno-3-111" href="#__codelineno-3-111"></a><span class="c">% plot flow diagram:</span>
</span><span id="__span-3-112"><a id="__codelineno-3-112" name="__codelineno-3-112" href="#__codelineno-3-112"></a><span class="nb">figure</span><span class="p">;</span>
</span><span id="__span-3-113"><a id="__codelineno-3-113" name="__codelineno-3-113" href="#__codelineno-3-113"></a><span class="c">% upper panel</span>
</span><span id="__span-3-114"><a id="__codelineno-3-114" name="__codelineno-3-114" href="#__codelineno-3-114"></a><span class="nb">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-3-115"><a id="__codelineno-3-115" name="__codelineno-3-115" href="#__codelineno-3-115"></a><span class="n">hold</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
</span><span id="__span-3-116"><a id="__codelineno-3-116" name="__codelineno-3-116" href="#__codelineno-3-116"></a><span class="k">for</span><span class="w"> </span><span class="n">itq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">clrs</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span><span class="nb">size</span><span class="p">(</span><span class="n">Qeven</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="c">% first gray lines</span>
</span><span id="__span-3-117"><a id="__codelineno-3-117" name="__codelineno-3-117" href="#__codelineno-3-117"></a><span class="w">    </span><span class="nb">plot</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">((</span><span class="mi">1</span><span class="p">:</span><span class="nb">size</span><span class="p">(</span><span class="n">Eeven</span><span class="p">{</span><span class="n">itq</span><span class="p">},</span><span class="mi">1</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">Eeven</span><span class="p">{</span><span class="n">itq</span><span class="p">},</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;Color&#39;</span><span class="p">,</span><span class="n">clrs0</span><span class="p">);</span>
</span><span id="__span-3-118"><a id="__codelineno-3-118" name="__codelineno-3-118" href="#__codelineno-3-118"></a><span class="k">end</span>
</span><span id="__span-3-119"><a id="__codelineno-3-119" name="__codelineno-3-119" href="#__codelineno-3-119"></a><span class="n">hs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">size</span><span class="p">(</span><span class="n">clrs</span><span class="p">,</span><span class="mi">1</span><span class="p">));</span><span class="w"> </span><span class="c">% lines</span>
</span><span id="__span-3-120"><a id="__codelineno-3-120" name="__codelineno-3-120" href="#__codelineno-3-120"></a><span class="n">leg</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">size</span><span class="p">(</span><span class="n">clrs</span><span class="p">,</span><span class="mi">1</span><span class="p">));</span><span class="w"> </span><span class="c">% legend</span>
</span><span id="__span-3-121"><a id="__codelineno-3-121" name="__codelineno-3-121" href="#__codelineno-3-121"></a><span class="k">for</span><span class="w"> </span><span class="n">itq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">size</span><span class="p">(</span><span class="n">clrs</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="c">% first gray lines</span>
</span><span id="__span-3-122"><a id="__codelineno-3-122" name="__codelineno-3-122" href="#__codelineno-3-122"></a><span class="w">    </span><span class="n">hs</span><span class="p">{</span><span class="n">itq</span><span class="p">}</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">plot</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">((</span><span class="mi">1</span><span class="p">:</span><span class="nb">size</span><span class="p">(</span><span class="n">Eeven</span><span class="p">{</span><span class="n">itq</span><span class="p">},</span><span class="mi">1</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">Eeven</span><span class="p">{</span><span class="n">itq</span><span class="p">},</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;Color&#39;</span><span class="p">,</span><span class="n">clrs</span><span class="p">(</span><span class="n">itq</span><span class="p">,:));</span>
</span><span id="__span-3-123"><a id="__codelineno-3-123" name="__codelineno-3-123" href="#__codelineno-3-123"></a><span class="w">    </span><span class="n">leg</span><span class="p">{</span><span class="n">itq</span><span class="p">}</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="s">&#39;(&#39;</span><span class="p">,</span><span class="k">...</span>
</span><span id="__span-3-124"><a id="__codelineno-3-124" name="__codelineno-3-124" href="#__codelineno-3-124"></a><span class="w">        </span><span class="nb">sprintf</span><span class="p">([</span><span class="nb">repmat</span><span class="p">([</span><span class="s">&#39;%i &#39;</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="nb">size</span><span class="p">(</span><span class="n">Qeven</span><span class="p">(</span><span class="n">itq</span><span class="p">,:),</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span><span class="s">&#39;%i&#39;</span><span class="p">],</span><span class="n">Qeven</span><span class="p">(</span><span class="n">itq</span><span class="p">,:))</span><span class="k">...</span>
</span><span id="__span-3-125"><a id="__codelineno-3-125" name="__codelineno-3-125" href="#__codelineno-3-125"></a><span class="w">        </span><span class="p">,</span><span class="s">&#39;)&#39;</span><span class="p">];</span>
</span><span id="__span-3-126"><a id="__codelineno-3-126" name="__codelineno-3-126" href="#__codelineno-3-126"></a><span class="k">end</span>
</span><span id="__span-3-127"><a id="__codelineno-3-127" name="__codelineno-3-127" href="#__codelineno-3-127"></a><span class="n">hs2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-3-128"><a id="__codelineno-3-128" name="__codelineno-3-128" href="#__codelineno-3-128"></a><span class="k">for</span><span class="w"> </span><span class="n">it1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">numel</span><span class="p">(</span><span class="n">hs</span><span class="p">))</span><span class="w"> </span><span class="c">% for legend</span>
</span><span id="__span-3-129"><a id="__codelineno-3-129" name="__codelineno-3-129" href="#__codelineno-3-129"></a><span class="w">    </span><span class="n">hs2</span><span class="p">(</span><span class="n">it1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">hs</span><span class="p">{</span><span class="n">it1</span><span class="p">}(</span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-3-130"><a id="__codelineno-3-130" name="__codelineno-3-130" href="#__codelineno-3-130"></a><span class="k">end</span>
</span><span id="__span-3-131"><a id="__codelineno-3-131" name="__codelineno-3-131" href="#__codelineno-3-131"></a><span class="nb">legend</span><span class="p">(</span><span class="n">hs2</span><span class="p">,</span><span class="n">leg</span><span class="p">);</span>
</span><span id="__span-3-132"><a id="__codelineno-3-132" name="__codelineno-3-132" href="#__codelineno-3-132"></a><span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Even iterations&#39;</span><span class="p">);</span>
</span><span id="__span-3-133"><a id="__codelineno-3-133" name="__codelineno-3-133" href="#__codelineno-3-133"></a><span class="nb">xlim</span><span class="p">([</span><span class="mi">0</span><span class="w"> </span><span class="nb">numel</span><span class="p">(</span><span class="n">Inrg</span><span class="p">.</span><span class="n">HK</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
</span><span id="__span-3-134"><a id="__codelineno-3-134" name="__codelineno-3-134" href="#__codelineno-3-134"></a><span class="nb">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Eshow</span><span class="p">]);</span>
</span><span id="__span-3-135"><a id="__codelineno-3-135" name="__codelineno-3-135" href="#__codelineno-3-135"></a><span class="nb">set</span><span class="p">(</span><span class="nb">gca</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;FontSize&#39;</span><span class="p">,</span><span class="mi">13</span><span class="p">);</span>
</span><span id="__span-3-136"><a id="__codelineno-3-136" name="__codelineno-3-136" href="#__codelineno-3-136"></a><span class="n">hold</span><span class="w"> </span><span class="s">off</span><span class="p">;</span>
</span><span id="__span-3-137"><a id="__codelineno-3-137" name="__codelineno-3-137" href="#__codelineno-3-137"></a>
</span><span id="__span-3-138"><a id="__codelineno-3-138" name="__codelineno-3-138" href="#__codelineno-3-138"></a><span class="c">% lower panel</span>
</span><span id="__span-3-139"><a id="__codelineno-3-139" name="__codelineno-3-139" href="#__codelineno-3-139"></a><span class="nb">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
</span><span id="__span-3-140"><a id="__codelineno-3-140" name="__codelineno-3-140" href="#__codelineno-3-140"></a><span class="n">hold</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
</span><span id="__span-3-141"><a id="__codelineno-3-141" name="__codelineno-3-141" href="#__codelineno-3-141"></a><span class="k">for</span><span class="w"> </span><span class="n">itq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">clrs</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span><span class="nb">size</span><span class="p">(</span><span class="n">Qodd</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="c">% first gray lines</span>
</span><span id="__span-3-142"><a id="__codelineno-3-142" name="__codelineno-3-142" href="#__codelineno-3-142"></a><span class="w">    </span><span class="nb">plot</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">size</span><span class="p">(</span><span class="n">Eodd</span><span class="p">{</span><span class="n">itq</span><span class="p">},</span><span class="mi">1</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">Eodd</span><span class="p">{</span><span class="n">itq</span><span class="p">},</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;Color&#39;</span><span class="p">,</span><span class="n">clrs0</span><span class="p">);</span>
</span><span id="__span-3-143"><a id="__codelineno-3-143" name="__codelineno-3-143" href="#__codelineno-3-143"></a><span class="k">end</span>
</span><span id="__span-3-144"><a id="__codelineno-3-144" name="__codelineno-3-144" href="#__codelineno-3-144"></a><span class="n">hs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">size</span><span class="p">(</span><span class="n">clrs</span><span class="p">,</span><span class="mi">1</span><span class="p">));</span><span class="w"> </span><span class="c">% lines</span>
</span><span id="__span-3-145"><a id="__codelineno-3-145" name="__codelineno-3-145" href="#__codelineno-3-145"></a><span class="n">leg</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">size</span><span class="p">(</span><span class="n">clrs</span><span class="p">,</span><span class="mi">1</span><span class="p">));</span><span class="w"> </span><span class="c">% legend</span>
</span><span id="__span-3-146"><a id="__codelineno-3-146" name="__codelineno-3-146" href="#__codelineno-3-146"></a><span class="k">for</span><span class="w"> </span><span class="n">itq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">size</span><span class="p">(</span><span class="n">clrs</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="c">% first gray lines</span>
</span><span id="__span-3-147"><a id="__codelineno-3-147" name="__codelineno-3-147" href="#__codelineno-3-147"></a><span class="w">    </span><span class="n">hs</span><span class="p">{</span><span class="n">itq</span><span class="p">}</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">plot</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">size</span><span class="p">(</span><span class="n">Eodd</span><span class="p">{</span><span class="n">itq</span><span class="p">},</span><span class="mi">1</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">Eodd</span><span class="p">{</span><span class="n">itq</span><span class="p">},</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;Color&#39;</span><span class="p">,</span><span class="n">clrs</span><span class="p">(</span><span class="n">itq</span><span class="p">,:));</span>
</span><span id="__span-3-148"><a id="__codelineno-3-148" name="__codelineno-3-148" href="#__codelineno-3-148"></a><span class="w">    </span><span class="n">leg</span><span class="p">{</span><span class="n">itq</span><span class="p">}</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="s">&#39;(&#39;</span><span class="p">,</span><span class="k">...</span>
</span><span id="__span-3-149"><a id="__codelineno-3-149" name="__codelineno-3-149" href="#__codelineno-3-149"></a><span class="w">        </span><span class="nb">sprintf</span><span class="p">([</span><span class="nb">repmat</span><span class="p">([</span><span class="s">&#39;%i &#39;</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="nb">size</span><span class="p">(</span><span class="n">Qodd</span><span class="p">(</span><span class="n">itq</span><span class="p">,:),</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span><span class="s">&#39;%i&#39;</span><span class="p">],</span><span class="n">Qodd</span><span class="p">(</span><span class="n">itq</span><span class="p">,:))</span><span class="k">...</span>
</span><span id="__span-3-150"><a id="__codelineno-3-150" name="__codelineno-3-150" href="#__codelineno-3-150"></a><span class="w">        </span><span class="p">,</span><span class="s">&#39;)&#39;</span><span class="p">];</span>
</span><span id="__span-3-151"><a id="__codelineno-3-151" name="__codelineno-3-151" href="#__codelineno-3-151"></a><span class="k">end</span>
</span><span id="__span-3-152"><a id="__codelineno-3-152" name="__codelineno-3-152" href="#__codelineno-3-152"></a><span class="n">hs2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[];</span>
</span><span id="__span-3-153"><a id="__codelineno-3-153" name="__codelineno-3-153" href="#__codelineno-3-153"></a><span class="k">for</span><span class="w"> </span><span class="n">it1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">numel</span><span class="p">(</span><span class="n">hs</span><span class="p">))</span><span class="w"> </span><span class="c">% for legend</span>
</span><span id="__span-3-154"><a id="__codelineno-3-154" name="__codelineno-3-154" href="#__codelineno-3-154"></a><span class="w">    </span><span class="n">hs2</span><span class="p">(</span><span class="n">it1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">hs</span><span class="p">{</span><span class="n">it1</span><span class="p">}(</span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-3-155"><a id="__codelineno-3-155" name="__codelineno-3-155" href="#__codelineno-3-155"></a><span class="k">end</span>
</span><span id="__span-3-156"><a id="__codelineno-3-156" name="__codelineno-3-156" href="#__codelineno-3-156"></a><span class="nb">legend</span><span class="p">(</span><span class="n">hs2</span><span class="p">,</span><span class="n">leg</span><span class="p">);</span>
</span><span id="__span-3-157"><a id="__codelineno-3-157" name="__codelineno-3-157" href="#__codelineno-3-157"></a><span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Odd iterations&#39;</span><span class="p">);</span>
</span><span id="__span-3-158"><a id="__codelineno-3-158" name="__codelineno-3-158" href="#__codelineno-3-158"></a><span class="nb">xlim</span><span class="p">([</span><span class="mi">0</span><span class="w"> </span><span class="nb">numel</span><span class="p">(</span><span class="n">Inrg</span><span class="p">.</span><span class="n">HK</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
</span><span id="__span-3-159"><a id="__codelineno-3-159" name="__codelineno-3-159" href="#__codelineno-3-159"></a><span class="nb">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Eshow</span><span class="p">]);</span>
</span><span id="__span-3-160"><a id="__codelineno-3-160" name="__codelineno-3-160" href="#__codelineno-3-160"></a><span class="nb">set</span><span class="p">(</span><span class="nb">gca</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;FontSize&#39;</span><span class="p">,</span><span class="mi">13</span><span class="p">);</span>
</span><span id="__span-3-161"><a id="__codelineno-3-161" name="__codelineno-3-161" href="#__codelineno-3-161"></a><span class="n">hold</span><span class="w"> </span><span class="s">off</span><span class="p">;</span>
</span></code></pre></div>
<p align="center">
  <img src="../images/odd-even.png" alt="Alt Text" width = "70%">
</p>

<blockquote>
<p>Below is the demonstration in which the completed function is used. In the next section ("Double occupation vs. temperature"), the reduced density matrix at the impurity, which is the part of the output (<samp>Inrg.RK{1}</samp>) of the function <a href="../codes/getRhoFDMQS.m">getRhoFDMQS.m</a>, is computed and displayed for different temperatures.</p>
</blockquote>
<h2 id="double-occupation-vs-temperature"><strong>Double occupation vs. temperature</strong></h2>
<p>Let's compute the double occupation <span class="arithmatex">\(\langle {\hat{n} }_{d\uparrow } {\hat{n} }_{d\downarrow } \rangle\)</span> at the impurity, where <span class="arithmatex">\({\hat{n} }_{d\sigma }\)</span> is the number operator for spin- <span class="arithmatex">\(\sigma\)</span> electron at the impurity site. We obtain the reduced density matrix within the Hilbert space of the impurity (to be obtained as <samp>Inrg.RK{1}</samp>), where the bath sites are all traced out.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">Dop</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getsub</span><span class="p">(</span><span class="n">EF</span><span class="p">,[</span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c">% operator measuring for double occupation</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="c">% represent in kept basis at the impurity</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="n">Dop</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">contract</span><span class="p">(</span><span class="n">Inrg</span><span class="p">.</span><span class="n">AK</span><span class="p">{</span><span class="mi">1</span><span class="p">},</span><span class="s">&#39;!2*&#39;</span><span class="p">,{</span><span class="n">Dop</span><span class="p">,</span><span class="n">Inrg</span><span class="p">.</span><span class="n">AK</span><span class="p">{</span><span class="mi">1</span><span class="p">}});</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="n">T</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">10.</span>^<span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">7</span><span class="p">);</span><span class="w"> </span><span class="c">% temperature values</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="n">Dval</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">T</span><span class="p">));</span><span class="w"> </span><span class="c">% expectation value of Dop</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="k">for</span><span class="w"> </span><span class="n">itT</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">numel</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="w">    </span><span class="n">Inrg</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getRhoFDMQS</span><span class="p">(</span><span class="n">Inrg</span><span class="p">,</span><span class="n">T</span><span class="p">(</span><span class="n">itT</span><span class="p">));</span><span class="w"> </span><span class="c">% construct FDM</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="w">    </span><span class="c">% display the reduced density matrix at the impurity</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="w">    </span><span class="n">Inrg</span><span class="p">.</span><span class="n">RK</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="w">    </span><span class="c">% contract the reduced density matrix at the impurity </span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="w">    </span><span class="c">% with the operator</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="w">    </span><span class="n">Dval</span><span class="p">(</span><span class="n">itT</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">trace</span><span class="p">(</span><span class="n">contract</span><span class="p">(</span><span class="n">Inrg</span><span class="p">.</span><span class="n">RK</span><span class="p">{</span><span class="mi">1</span><span class="p">},</span><span class="n">Dop</span><span class="p">));</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="k">end</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>21-05-11 17:03:41 | Construct full density matrix @ T = 10 ...
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>Elapsed time: 2.374s, CPU time: 5.44s, Avg # of cores: 2.291
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>ans = 
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>     Q:  3x [2 2]  having &#39;A,SU2&#39;,   { K00, K00* }
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>  data:  2-D double (336 bytes)      3 x 3 =&gt; 4 x 4
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>1.  1x1        | 1x1        [ -1 0 ; -1 0 ]        0.25
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>     2.  1x1        | 2x2        [  0 1 ;  0 1 ]        0.25  {1.414}
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>     3.  1x1        | 1x1        [  1 0 ;  1 0 ]        0.25
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>21-05-11 17:03:43 | Construct full density matrix @ T = 1 ...
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>Elapsed time: 2.408s, CPU time: 5.42s, Avg # of cores: 2.25
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>ans = 
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>     Q:  3x [2 2]  having &#39;A,SU2&#39;,   { K00, K00* }
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>  data:  2-D double (336 bytes)      3 x 3 =&gt; 4 x 4
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>1.  1x1        | 1x1        [ -1 0 ; -1 0 ]      0.2497
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>     2.  1x1        | 2x2        [  0 1 ;  0 1 ]      0.2503  {1.414}
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>     3.  1x1        | 1x1        [  1 0 ;  1 0 ]      0.2497
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>21-05-11 17:03:46 | Construct full density matrix @ T = 0.1 ...
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>Elapsed time: 2.406s, CPU time: 5.41s, Avg # of cores: 2.249
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a>ans = 
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a>     Q:  3x [2 2]  having &#39;A,SU2&#39;,   { K00, K00* }
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a>  data:  2-D double (336 bytes)      3 x 3 =&gt; 4 x 4
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a>1.  1x1        | 1x1        [ -1 0 ; -1 0 ]       0.247
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a>     2.  1x1        | 2x2        [  0 1 ;  0 1 ]       0.253  {1.414}
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a>     3.  1x1        | 1x1        [  1 0 ;  1 0 ]       0.247
</span><span id="__span-5-25"><a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a>21-05-11 17:03:48 | Construct full density matrix @ T = 0.01 ...
</span><span id="__span-5-26"><a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a>Elapsed time: 2.194s, CPU time: 5.11s, Avg # of cores: 2.329
</span><span id="__span-5-27"><a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a>ans = 
</span><span id="__span-5-28"><a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a>     Q:  3x [2 2]  having &#39;A,SU2&#39;,   { K00, K00* }
</span><span id="__span-5-29"><a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a>  data:  2-D double (336 bytes)      3 x 3 =&gt; 4 x 4
</span><span id="__span-5-30"><a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a>1.  1x1        | 1x1        [ -1 0 ; -1 0 ]      0.2251
</span><span id="__span-5-31"><a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a>     2.  1x1        | 2x2        [  0 1 ;  0 1 ]      0.2749  {1.414}
</span><span id="__span-5-32"><a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a>     3.  1x1        | 1x1        [  1 0 ;  1 0 ]      0.2251
</span><span id="__span-5-33"><a id="__codelineno-5-33" name="__codelineno-5-33" href="#__codelineno-5-33"></a>21-05-11 17:03:51 | Construct full density matrix @ T = 0.001 ...
</span><span id="__span-5-34"><a id="__codelineno-5-34" name="__codelineno-5-34" href="#__codelineno-5-34"></a>Elapsed time: 2.169s, CPU time: 5.02s, Avg # of cores: 2.315
</span><span id="__span-5-35"><a id="__codelineno-5-35" name="__codelineno-5-35" href="#__codelineno-5-35"></a>ans = 
</span><span id="__span-5-36"><a id="__codelineno-5-36" name="__codelineno-5-36" href="#__codelineno-5-36"></a>     Q:  3x [2 2]  having &#39;A,SU2&#39;,   { K00, K00* }
</span><span id="__span-5-37"><a id="__codelineno-5-37" name="__codelineno-5-37" href="#__codelineno-5-37"></a>  data:  2-D double (336 bytes)      3 x 3 =&gt; 4 x 4
</span><span id="__span-5-38"><a id="__codelineno-5-38" name="__codelineno-5-38" href="#__codelineno-5-38"></a>1.  1x1        | 1x1        [ -1 0 ; -1 0 ]     0.09058
</span><span id="__span-5-39"><a id="__codelineno-5-39" name="__codelineno-5-39" href="#__codelineno-5-39"></a>     2.  1x1        | 2x2        [  0 1 ;  0 1 ]      0.4094  {1.414}
</span><span id="__span-5-40"><a id="__codelineno-5-40" name="__codelineno-5-40" href="#__codelineno-5-40"></a>     3.  1x1        | 1x1        [  1 0 ;  1 0 ]     0.09058
</span><span id="__span-5-41"><a id="__codelineno-5-41" name="__codelineno-5-41" href="#__codelineno-5-41"></a>21-05-11 17:03:53 | Construct full density matrix @ T = 0.0001 ...
</span><span id="__span-5-42"><a id="__codelineno-5-42" name="__codelineno-5-42" href="#__codelineno-5-42"></a>Elapsed time: 2.432s, CPU time: 5.51s, Avg # of cores: 2.265
</span><span id="__span-5-43"><a id="__codelineno-5-43" name="__codelineno-5-43" href="#__codelineno-5-43"></a>ans = 
</span><span id="__span-5-44"><a id="__codelineno-5-44" name="__codelineno-5-44" href="#__codelineno-5-44"></a>     Q:  3x [2 2]  having &#39;A,SU2&#39;,   { K00, K00* }
</span><span id="__span-5-45"><a id="__codelineno-5-45" name="__codelineno-5-45" href="#__codelineno-5-45"></a>  data:  2-D double (336 bytes)      3 x 3 =&gt; 4 x 4
</span><span id="__span-5-46"><a id="__codelineno-5-46" name="__codelineno-5-46" href="#__codelineno-5-46"></a>1.  1x1        | 1x1        [ -1 0 ; -1 0 ]     0.04448
</span><span id="__span-5-47"><a id="__codelineno-5-47" name="__codelineno-5-47" href="#__codelineno-5-47"></a>     2.  1x1        | 2x2        [  0 1 ;  0 1 ]      0.4555  {1.414}
</span><span id="__span-5-48"><a id="__codelineno-5-48" name="__codelineno-5-48" href="#__codelineno-5-48"></a>     3.  1x1        | 1x1        [  1 0 ;  1 0 ]     0.04448
</span><span id="__span-5-49"><a id="__codelineno-5-49" name="__codelineno-5-49" href="#__codelineno-5-49"></a>21-05-11 17:03:55 | Construct full density matrix @ T = 1e-05 ...
</span><span id="__span-5-50"><a id="__codelineno-5-50" name="__codelineno-5-50" href="#__codelineno-5-50"></a>Elapsed time: 2.061s, CPU time: 4.91s, Avg # of cores: 2.382
</span><span id="__span-5-51"><a id="__codelineno-5-51" name="__codelineno-5-51" href="#__codelineno-5-51"></a>ans = 
</span><span id="__span-5-52"><a id="__codelineno-5-52" name="__codelineno-5-52" href="#__codelineno-5-52"></a>     Q:  3x [2 2]  having &#39;A,SU2&#39;,   { K00, K00* }
</span><span id="__span-5-53"><a id="__codelineno-5-53" name="__codelineno-5-53" href="#__codelineno-5-53"></a>  data:  2-D double (336 bytes)      3 x 3 =&gt; 4 x 4
</span><span id="__span-5-54"><a id="__codelineno-5-54" name="__codelineno-5-54" href="#__codelineno-5-54"></a>1.  1x1        | 1x1        [ -1 0 ; -1 0 ]     0.04577
</span><span id="__span-5-55"><a id="__codelineno-5-55" name="__codelineno-5-55" href="#__codelineno-5-55"></a>     2.  1x1        | 2x2        [  0 1 ;  0 1 ]      0.4542  {1.414}
</span><span id="__span-5-56"><a id="__codelineno-5-56" name="__codelineno-5-56" href="#__codelineno-5-56"></a>     3.  1x1        | 1x1        [  1 0 ;  1 0 ]     0.04577
</span><span id="__span-5-57"><a id="__codelineno-5-57" name="__codelineno-5-57" href="#__codelineno-5-57"></a>21-05-11 17:03:57 | Construct full density matrix @ T = 1e-06 ...
</span><span id="__span-5-58"><a id="__codelineno-5-58" name="__codelineno-5-58" href="#__codelineno-5-58"></a>Elapsed time: 2.04s, CPU time: 4.79s, Avg # of cores: 2.348
</span><span id="__span-5-59"><a id="__codelineno-5-59" name="__codelineno-5-59" href="#__codelineno-5-59"></a>ans = 
</span><span id="__span-5-60"><a id="__codelineno-5-60" name="__codelineno-5-60" href="#__codelineno-5-60"></a>     Q:  3x [2 2]  having &#39;A,SU2&#39;,   { K00, K00* }
</span><span id="__span-5-61"><a id="__codelineno-5-61" name="__codelineno-5-61" href="#__codelineno-5-61"></a>  data:  2-D double (336 bytes)      3 x 3 =&gt; 4 x 4
</span><span id="__span-5-62"><a id="__codelineno-5-62" name="__codelineno-5-62" href="#__codelineno-5-62"></a>1.  1x1        | 1x1        [ -1 0 ; -1 0 ]     0.04655
</span><span id="__span-5-63"><a id="__codelineno-5-63" name="__codelineno-5-63" href="#__codelineno-5-63"></a>     2.  1x1        | 2x2        [  0 1 ;  0 1 ]      0.4534  {1.414}
</span><span id="__span-5-64"><a id="__codelineno-5-64" name="__codelineno-5-64" href="#__codelineno-5-64"></a>     3.  1x1        | 1x1        [  1 0 ;  1 0 ]     0.04655
</span><span id="__span-5-65"><a id="__codelineno-5-65" name="__codelineno-5-65" href="#__codelineno-5-65"></a>21-05-11 17:03:59 | Construct full density matrix @ T = 1e-07 ...
</span><span id="__span-5-66"><a id="__codelineno-5-66" name="__codelineno-5-66" href="#__codelineno-5-66"></a>Elapsed time: 2.081s, CPU time: 4.84s, Avg # of cores: 2.326
</span><span id="__span-5-67"><a id="__codelineno-5-67" name="__codelineno-5-67" href="#__codelineno-5-67"></a>ans = 
</span><span id="__span-5-68"><a id="__codelineno-5-68" name="__codelineno-5-68" href="#__codelineno-5-68"></a>     Q:  3x [2 2]  having &#39;A,SU2&#39;,   { K00, K00* }
</span><span id="__span-5-69"><a id="__codelineno-5-69" name="__codelineno-5-69" href="#__codelineno-5-69"></a>  data:  2-D double (336 bytes)      3 x 3 =&gt; 4 x 4
</span><span id="__span-5-70"><a id="__codelineno-5-70" name="__codelineno-5-70" href="#__codelineno-5-70"></a>1.  1x1        | 1x1        [ -1 0 ; -1 0 ]     0.04676
</span><span id="__span-5-71"><a id="__codelineno-5-71" name="__codelineno-5-71" href="#__codelineno-5-71"></a>     2.  1x1        | 2x2        [  0 1 ;  0 1 ]      0.4532  {1.414}
</span><span id="__span-5-72"><a id="__codelineno-5-72" name="__codelineno-5-72" href="#__codelineno-5-72"></a>     3.  1x1        | 1x1        [  1 0 ;  1 0 ]     0.04676
</span></code></pre></div>
<p>Plot the double occupation vs. temperature.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nb">figure</span><span class="p">;</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="nb">semilogx</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">U</span><span class="p">,</span><span class="n">Dval</span><span class="p">,</span><span class="s">&#39;Marker&#39;</span><span class="p">,</span><span class="s">&#39;x&#39;</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="nb">set</span><span class="p">(</span><span class="nb">gca</span><span class="p">,</span><span class="s">&#39;FontSize&#39;</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39; $T/U$ &#39;</span><span class="p">,</span><span class="s">&#39;Interpreter&#39;</span><span class="p">,</span><span class="s">&#39;latex&#39;</span><span class="p">);</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39; $\langle \hat{n}_{d \uparrow} \hat{n}_{d \downarrow} \rangle$ &#39;</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">    </span><span class="s">&#39;Interpreter&#39;</span><span class="p">,</span><span class="s">&#39;latex&#39;</span><span class="p">);</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="n">grid</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
</span></code></pre></div>
<p align="center">
  <img src="../images/nup-ndown.png" alt="Alt Text" width = "70%">
</p>

<p>We see that the double occupation <span class="arithmatex">\(\langle {\hat{n} }_{d\uparrow } {\hat{n} }_{d\downarrow } \rangle\)</span> decreases with decreasing <span class="arithmatex">\(T\)</span> with a crossover around <span class="arithmatex">\(T\sim U\)</span> . On the other hand, the double occupation saturates in the low-temperature regime <span class="arithmatex">\(T\ll U\)</span> : it means that the charge fluctuation is "frozen" by low temperature.</p>
<blockquote>
<p>To compute spectral function, <a href="../codes/getAdiscQS.m">getAdiscQS.m</a> will be used.</p>
</blockquote>
<h2 id="impurity-spectral-function-discrete-data"><strong>Impurity spectral function: discrete data</strong></h2>
<p>We compute the spectral function <span class="arithmatex">\(A_{ds} (\omega )\equiv (-1/\pi ){\mathrm{I}\mathrm{m}}\,G_{ds} (\omega )\)</span> , where <span class="arithmatex">\(G_{ds} (\omega )\)</span> is the Green's function of spin- <span class="arithmatex">\(s\)</span> electron at the impurity. That is, <span class="arithmatex">\(A_{ds} (\omega )\)</span> is obtained by substituting <span class="arithmatex">\({\hat{O} }_d ={\hat{d} }_s\)</span> to the above Eq. (1).</p>
<p>Choose the system temperature, and construct the density matrices in the kept and discarded spaces for every iteration.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">T</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">1e-8</span><span class="p">;</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="n">Inrg</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getRhoFDMQS</span><span class="p">(</span><span class="n">Inrg</span><span class="p">,</span><span class="n">T</span><span class="p">);</span><span class="w"> </span><span class="c">% construct full density matrix</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>21-05-11 17:04:02 | Construct full density matrix @ T = 1e-08 ...
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>Elapsed time: 2.044s, CPU time: 4.76s, Avg # of cores: 2.328
</span></code></pre></div>
<p>Then compute the discrete spectal data for the impurity spectral function. </p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c">% discrete spectral function of spin-up electron at the impurity</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="p">[</span><span class="n">odisc</span><span class="p">,</span><span class="n">Adisc</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getAdiscQS</span><span class="p">(</span><span class="n">Inrg</span><span class="p">,</span><span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Z</span><span class="p">);</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>21-05-11 17:04:04 | Correlation function for anti-commuting op.
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>21-05-11 17:04:04 | #01/55 : sum(Adisc) = 0
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>21-05-11 17:04:04 | #02/55 : sum(Adisc) = 0
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>21-05-11 17:04:04 | #03/55 : sum(Adisc) = 0
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>21-05-11 17:04:04 | #04/55 : sum(Adisc) = 9.292e-11
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>21-05-11 17:04:04 | #05/55 : sum(Adisc) = 1.266e-07
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>21-05-11 17:04:05 | #06/55 : sum(Adisc) = 1.202e-05
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>21-05-11 17:04:05 | #07/55 : sum(Adisc) = 0.0004482
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>21-05-11 17:04:05 | #08/55 : sum(Adisc) = 0.0004776
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>21-05-11 17:04:05 | #09/55 : sum(Adisc) = 0.001568
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>21-05-11 17:04:06 | #10/55 : sum(Adisc) = 0.001638
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>21-05-11 17:04:06 | #11/55 : sum(Adisc) = 0.004369
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>21-05-11 17:04:06 | #12/55 : sum(Adisc) = 0.004524
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>21-05-11 17:04:06 | #13/55 : sum(Adisc) = 0.01142
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>21-05-11 17:04:07 | #14/55 : sum(Adisc) = 0.0117
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>21-05-11 17:04:07 | #15/55 : sum(Adisc) = 0.02998
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a>21-05-11 17:04:07 | #16/55 : sum(Adisc) = 0.03072
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>21-05-11 17:04:07 | #17/55 : sum(Adisc) = 0.09208
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a>21-05-11 17:04:08 | #18/55 : sum(Adisc) = 0.1012
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a>21-05-11 17:04:08 | #19/55 : sum(Adisc) = 0.5312
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a>21-05-11 17:04:08 | #20/55 : sum(Adisc) = 1.461
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a>21-05-11 17:04:08 | #21/55 : sum(Adisc) = 1.545
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a>21-05-11 17:04:09 | #22/55 : sum(Adisc) = 1.756
</span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a>21-05-11 17:04:09 | #23/55 : sum(Adisc) = 1.801
</span><span id="__span-10-25"><a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a>21-05-11 17:04:09 | #24/55 : sum(Adisc) = 1.865
</span><span id="__span-10-26"><a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a>21-05-11 17:04:10 | #25/55 : sum(Adisc) = 1.895
</span><span id="__span-10-27"><a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a>21-05-11 17:04:10 | #26/55 : sum(Adisc) = 1.921
</span><span id="__span-10-28"><a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a>21-05-11 17:04:10 | #27/55 : sum(Adisc) = 1.941
</span><span id="__span-10-29"><a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a>21-05-11 17:04:10 | #28/55 : sum(Adisc) = 1.952
</span><span id="__span-10-30"><a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a>21-05-11 17:04:11 | #29/55 : sum(Adisc) = 1.965
</span><span id="__span-10-31"><a id="__codelineno-10-31" name="__codelineno-10-31" href="#__codelineno-10-31"></a>21-05-11 17:04:11 | #30/55 : sum(Adisc) = 1.97
</span><span id="__span-10-32"><a id="__codelineno-10-32" name="__codelineno-10-32" href="#__codelineno-10-32"></a>21-05-11 17:04:11 | #31/55 : sum(Adisc) = 1.979
</span><span id="__span-10-33"><a id="__codelineno-10-33" name="__codelineno-10-33" href="#__codelineno-10-33"></a>21-05-11 17:04:12 | #32/55 : sum(Adisc) = 1.981
</span><span id="__span-10-34"><a id="__codelineno-10-34" name="__codelineno-10-34" href="#__codelineno-10-34"></a>21-05-11 17:04:12 | #33/55 : sum(Adisc) = 1.988
</span><span id="__span-10-35"><a id="__codelineno-10-35" name="__codelineno-10-35" href="#__codelineno-10-35"></a>21-05-11 17:04:12 | #34/55 : sum(Adisc) = 1.989
</span><span id="__span-10-36"><a id="__codelineno-10-36" name="__codelineno-10-36" href="#__codelineno-10-36"></a>21-05-11 17:04:13 | #35/55 : sum(Adisc) = 1.994
</span><span id="__span-10-37"><a id="__codelineno-10-37" name="__codelineno-10-37" href="#__codelineno-10-37"></a>21-05-11 17:04:13 | #36/55 : sum(Adisc) = 1.994
</span><span id="__span-10-38"><a id="__codelineno-10-38" name="__codelineno-10-38" href="#__codelineno-10-38"></a>21-05-11 17:04:14 | #37/55 : sum(Adisc) = 1.997
</span><span id="__span-10-39"><a id="__codelineno-10-39" name="__codelineno-10-39" href="#__codelineno-10-39"></a>21-05-11 17:04:14 | #38/55 : sum(Adisc) = 1.997
</span><span id="__span-10-40"><a id="__codelineno-10-40" name="__codelineno-10-40" href="#__codelineno-10-40"></a>21-05-11 17:04:14 | #39/55 : sum(Adisc) = 1.999
</span><span id="__span-10-41"><a id="__codelineno-10-41" name="__codelineno-10-41" href="#__codelineno-10-41"></a>21-05-11 17:04:15 | #40/55 : sum(Adisc) = 1.999
</span><span id="__span-10-42"><a id="__codelineno-10-42" name="__codelineno-10-42" href="#__codelineno-10-42"></a>21-05-11 17:04:15 | #41/55 : sum(Adisc) = 1.999
</span><span id="__span-10-43"><a id="__codelineno-10-43" name="__codelineno-10-43" href="#__codelineno-10-43"></a>21-05-11 17:04:15 | #42/55 : sum(Adisc) = 2
</span><span id="__span-10-44"><a id="__codelineno-10-44" name="__codelineno-10-44" href="#__codelineno-10-44"></a>21-05-11 17:04:16 | #43/55 : sum(Adisc) = 2
</span><span id="__span-10-45"><a id="__codelineno-10-45" name="__codelineno-10-45" href="#__codelineno-10-45"></a>21-05-11 17:04:16 | #44/55 : sum(Adisc) = 2
</span><span id="__span-10-46"><a id="__codelineno-10-46" name="__codelineno-10-46" href="#__codelineno-10-46"></a>21-05-11 17:04:16 | #45/55 : sum(Adisc) = 2
</span><span id="__span-10-47"><a id="__codelineno-10-47" name="__codelineno-10-47" href="#__codelineno-10-47"></a>21-05-11 17:04:17 | #46/55 : sum(Adisc) = 2
</span><span id="__span-10-48"><a id="__codelineno-10-48" name="__codelineno-10-48" href="#__codelineno-10-48"></a>21-05-11 17:04:17 | #47/55 : sum(Adisc) = 2
</span><span id="__span-10-49"><a id="__codelineno-10-49" name="__codelineno-10-49" href="#__codelineno-10-49"></a>21-05-11 17:04:18 | #48/55 : sum(Adisc) = 2
</span><span id="__span-10-50"><a id="__codelineno-10-50" name="__codelineno-10-50" href="#__codelineno-10-50"></a>21-05-11 17:04:18 | #49/55 : sum(Adisc) = 2
</span><span id="__span-10-51"><a id="__codelineno-10-51" name="__codelineno-10-51" href="#__codelineno-10-51"></a>21-05-11 17:04:18 | #50/55 : sum(Adisc) = 2
</span><span id="__span-10-52"><a id="__codelineno-10-52" name="__codelineno-10-52" href="#__codelineno-10-52"></a>21-05-11 17:04:19 | #51/55 : sum(Adisc) = 2
</span><span id="__span-10-53"><a id="__codelineno-10-53" name="__codelineno-10-53" href="#__codelineno-10-53"></a>21-05-11 17:04:19 | #52/55 : sum(Adisc) = 2
</span><span id="__span-10-54"><a id="__codelineno-10-54" name="__codelineno-10-54" href="#__codelineno-10-54"></a>21-05-11 17:04:19 | #53/55 : sum(Adisc) = 2
</span><span id="__span-10-55"><a id="__codelineno-10-55" name="__codelineno-10-55" href="#__codelineno-10-55"></a>21-05-11 17:04:20 | #54/55 : sum(Adisc) = 2
</span><span id="__span-10-56"><a id="__codelineno-10-56" name="__codelineno-10-56" href="#__codelineno-10-56"></a>21-05-11 17:04:20 | #55/55 : sum(Adisc) = 2
</span><span id="__span-10-57"><a id="__codelineno-10-57" name="__codelineno-10-57" href="#__codelineno-10-57"></a>Elapsed time: 15.71s, CPU time: 26.18s, Avg # of cores: 1.667
</span><span id="__span-10-58"><a id="__codelineno-10-58" name="__codelineno-10-58" href="#__codelineno-10-58"></a>21-05-11 17:04:20 | Memory usage : 2.01GiB
</span></code></pre></div>
<p>Note that <samp>sum(Adisc)</samp> means the sum of the discrete spectral weights. The sum of the spectral weights is given by</p>
<div class="arithmatex">\[
 \sum_{\ell } \sum_{X,Y\not= KK} \sum_{\alpha \beta } A_{\alpha \beta }^{\ell XY} 
\]</div>
<!-- $$
 =\sum_{\ell } \sum_{X,Y\not= KK} \sum_{\alpha \beta } \sum_{e} _{\ell }^X \langle {\alpha} ,e|{\hat{O} }_d |\beta ,e\rangle_{\ell }^Y \left(_{\ell }^Y \langle {\beta} ,e|{\hat{O} }_d^{\dagger} \,\hat{\rho} |\alpha ,e\rangle_{\ell }^X \pm _{\ell }^Y \langle \beta ,e|\hat{\rho} \,{\hat{O} }_d^{\dagger} |\alpha ,e\rangle_{\ell }^X \right) 
$$  -->

<div class="arithmatex">\[
 ={\mathrm{T}\mathrm{r}}\left({\hat{O} }_d {\hat{O} }_d^{\dagger} \hat{\rho} \pm {\hat{O} }_d \hat{\rho} {\hat{O} }_d^{\dagger} \right)={\mathrm{T}\mathrm{r}}\left([{\hat{O} }_d ,{\hat{O} }_d^{\dagger} ]_{\pm } \hat{\rho} \right). 
\]</div>
<p>Here we have used the completeness of the basis <span class="arithmatex">\(\lbrace |\alpha ,e\rangle_{\ell_0 }^D \rbrace \cup \lbrace |\alpha ,e\rangle_{\ell_0 +1}^D \rbrace \cup \cdots \lbrace |\alpha ,e\rangle_{\ell }^D \rbrace \cup \lbrace |\alpha ,e\rangle_{\ell }^K \rbrace\)</span> , where <span class="arithmatex">\(\ell_0\)</span> is the first iteration at which the truncation of the Hilbert space happened. Since the standard anti-commutation relation gives <span class="arithmatex">\([{\hat{d} }_s ,{\hat{d} }_s^{\dagger} ]_+ =1\)</span> , <strong><samp>sum(Adisc)</samp></strong> <strong>should be 1. The</strong> <strong><samp>getAdiscQS</samp></strong> <strong>result satisfies this "spectral sum rule" up to double precision.</strong>  Indeed, this sum-preserving property is one of the key merits of fdmNRG; see the title of [<a href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.99.076402">A. Weichselbaum and J. von Delft, Phys. Rev. Lett. <strong>99</strong>, 076402 (2007)</a>]. Note that in case of SU(2) spin rotation symmetry, we compute <span class="arithmatex">\(A_{\uparrow } (\omega )+A_{\downarrow } (\omega )\)</span> . Therefore, sum(Adisc) is 2 in this case. </p>
<p>We use a technique called "rerouting Z-string" in <samp>getAdiscQS.m</samp>. With this, we don't need to contract Z operator, i.e., fermionic sign operator, at every iteration. It is enough to contract the Z operator only at the first iteration! For the detail of the rerouting technique, see the Appendix of [<a href="https://journals.aps.org/prb/abstract/10.1103/PhysRevB.86.245124">A. Weichselbaum, Phys. Rev. B <strong>86</strong>, 245124 (2012)</a>] or <a href="https://arxiv.org/abs/1209.2062">its arXiv version</a>.</p>
<h2 id="impurity-spectral-function-continuous-curve"><strong>Impurity spectral function: continuous curve</strong></h2>
<p>The results <samp>odisc</samp> and <samp>Adisc</samp> represent the collection of discrete spectral weights given by the Lehmann representation. To obtain a smooth curve, we need to broaden them.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c">% broaden the discrete data to have a continuous curve</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="p">[</span><span class="n">ocont</span><span class="p">,</span><span class="n">Acont</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getAcont</span><span class="p">(</span><span class="n">odisc</span><span class="p">,</span><span class="n">Adisc</span><span class="p">,</span><span class="nb">log</span><span class="p">(</span><span class="n">Lambda</span><span class="p">),</span><span class="n">T</span><span class="o">/</span><span class="mi">5</span><span class="p">);</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="k">if</span><span class="w"> </span><span class="nb">strcmp</span><span class="p">(</span><span class="n">symstr</span><span class="p">,</span><span class="s">&#39;Acharge,SU2spin&#39;</span><span class="p">)</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">    </span><span class="n">Acont</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Acont</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="c">% sum of spectral function for both spins is calculated</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="k">end</span>
</span></code></pre></div>
<p>Compute the Kondo temperature <span class="arithmatex">\(T_{{\mathrm{K}}}\)</span> to rescale frequencies.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c">% Kondo temperature from the Bethe ansatz</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="n">TK</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="n">U</span><span class="o">*</span><span class="n">Gamma</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="nb">pi</span><span class="o">*</span><span class="n">U</span><span class="o">/</span><span class="mi">8</span><span class="o">/</span><span class="n">Gamma</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">pi</span><span class="o">*</span><span class="n">Gamma</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">U</span><span class="p">);</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="nb">disp</span><span class="p">(</span><span class="n">TK</span><span class="p">);</span><span class="w"> </span><span class="c">% Kondo temperature</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>1.5106e-06
</span></code></pre></div>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="nb">figure</span><span class="p">;</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="n">hold</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="c">% positive frequency</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="nb">plot</span><span class="p">(</span><span class="n">ocont</span><span class="p">(</span><span class="n">ocont</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="n">TK</span><span class="p">,</span><span class="n">Acont</span><span class="p">(</span><span class="n">ocont</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">pi</span><span class="o">*</span><span class="n">Gamma</span><span class="p">),</span><span class="w"> </span><span class="k">...</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w">    </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;LineStyle&#39;</span><span class="p">,</span><span class="s">&#39;-&#39;</span><span class="p">);</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="c">% negative frequency</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="nb">plot</span><span class="p">(</span><span class="o">-</span><span class="n">ocont</span><span class="p">(</span><span class="n">ocont</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="n">TK</span><span class="p">,</span><span class="n">Acont</span><span class="p">(</span><span class="n">ocont</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">pi</span><span class="o">*</span><span class="n">Gamma</span><span class="p">),</span><span class="w"> </span><span class="k">...</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="w">    </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;LineStyle&#39;</span><span class="p">,</span><span class="s">&#39;--&#39;</span><span class="p">);</span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="nb">plot</span><span class="p">(</span><span class="n">U</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">TK</span><span class="o">*</span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;LineStyle&#39;</span><span class="p">,</span><span class="s">&#39;-.&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="w">    </span><span class="s">&#39;Color&#39;</span><span class="p">,[</span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">0.5</span><span class="p">);</span>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="nb">text</span><span class="p">(</span><span class="n">U</span><span class="o">/</span><span class="n">TK</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="s">&#39; !!!EQ_80!!! &#39;</span><span class="p">,</span><span class="s">&#39;FontSize&#39;</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="w">    </span><span class="s">&#39;Interpreter&#39;</span><span class="p">,</span><span class="s">&#39;latex&#39;</span><span class="p">,</span><span class="s">&#39;HorizontalAlignment&#39;</span><span class="p">,</span><span class="s">&#39;left&#39;</span><span class="p">);</span>
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="n">hold</span><span class="w"> </span><span class="s">off</span><span class="p">;</span>
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a><span class="nb">set</span><span class="p">(</span><span class="nb">gca</span><span class="p">,</span><span class="s">&#39;FontSize&#39;</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;XScale&#39;</span><span class="p">,</span><span class="s">&#39;log&#39;</span><span class="p">);</span>
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="nb">legend</span><span class="p">({</span><span class="s">&#39; !!!EQ_81!!! &#39;</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a><span class="w">    </span><span class="s">&#39; !!!EQ_82!!! &#39;</span><span class="p">},</span><span class="s">&#39;Interpreter&#39;</span><span class="p">,</span><span class="s">&#39;latex&#39;</span><span class="p">);</span>
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a><span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39; !!!EQ_83!!! &#39;</span><span class="p">,</span><span class="s">&#39;Interpreter&#39;</span><span class="p">,</span><span class="s">&#39;latex&#39;</span><span class="p">);</span>
</span><span id="__span-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39; !!!EQ_84!!! &#39;</span><span class="p">,</span><span class="s">&#39;Interpreter&#39;</span><span class="p">,</span><span class="s">&#39;latex&#39;</span><span class="p">);</span>
</span><span id="__span-14-19"><a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a><span class="nb">ylim</span><span class="p">([</span><span class="mi">0</span><span class="w"> </span><span class="mf">1.01</span><span class="p">]);</span>
</span><span id="__span-14-20"><a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a><span class="nb">xlim</span><span class="p">([</span><span class="mf">1e-6</span><span class="w"> </span><span class="mf">1e6</span><span class="p">]);</span>
</span><span id="__span-14-21"><a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a><span class="n">grid</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
</span></code></pre></div>
<p align="center">
  <img src="../images/Aw.png" alt="Alt Text" width = "70%">
</p>

<p>We observe several important features.</p>
<ol>
<li>As the spin symmetry is not broken (due to the absence of magnetic field) and the particle-hole symmetry is preserved, blue and red curves for positive and negative frequencies, respectively, lie top of each other.</li>
<li>There are side peaks at <span class="arithmatex">\(\omega =\pm U/2\)</span> , as marked by vertical dash-dotted line. They come from local excitations from singly occupied states to the double occupied state for the peak at <span class="arithmatex">\(\omega =U/2\)</span> (to the empty state for the peak at <span class="arithmatex">\(\omega =-U/2\)</span> ).</li>
<li>The full-width-half-maximum of the "Kondo peak" (peak centered at <span class="arithmatex">\(\omega =0\)</span> ) is roughly <span class="arithmatex">\(T_{{\mathrm{K}}}\)</span> .</li>
<li>There is a plateau for <span class="arithmatex">\(|\omega |\ll T_{{\mathrm{K}}}\)</span> which corresponds to the top of the Kondo peak. The height of the Kondo peak satisfies the Friedel sum rule, <span class="arithmatex">\(\pi \Gamma A_{d\uparrow } (\omega =0)=1\)</span> , up to a few percent error. Note that the Friedel sum rule is the exact relation holds at <span class="arithmatex">\(T=0\)</span> .</li>
</ol>
<p>The quality of the curve (e.g., frequency resolution) can be improved by using so-called <span class="arithmatex">\(z\)</span> -averaging, that is, by mixing the NRG results with the logarithmic discretization grid relatively shifted with respect to each other.</p>
<p>Also, the accuracy with respect to the Friedel sum rule can be further improved by using more advanced logarithmic discretization schemes (see e.g., [<a href="https://journals.aps.org/prb/abstract/10.1103/PhysRevB.79.085106">R. Zitko and Th. Pruschke, Phys. Rev. B <strong>79</strong>, 085106 (2009)</a>]) and by using the "self-energy trick" (see [<a href="https://iopscience.iop.org/article/10.1088/0953-8984/10/37/021/meta">R. Bulla, A. C. Hewson, and Th. Pruschke, J. Phys.: Condens. Matter <strong>10</strong>, 8365 (1998)</a>]).</p>
<h2 id="dynamical-impurity-spin-susceptibility"><strong>Dynamical impurity spin susceptibility</strong></h2>
<p>Some experimental probes such as neutron scattering can resolve the frequency dependence of the spin susceptibility. The frequency dependence encodes interesting information of the system.</p>
<p>We will consider the dynamical impurity spin susceptibility, which depends on frequency <span class="arithmatex">\(\omega\)</span> . It is the retarded-time correlation function of spin operators <span class="arithmatex">\({\hat{S} }_{d,z}\)</span> . That is, the imaginary part of the dynamical impurity spin susceptibility, say <span class="arithmatex">\(\chi_s^{\prime \prime } (\omega )\)</span> , is obtained by substituting <span class="arithmatex">\({\hat{O} }_d ={\hat{S} }_{d,z}\)</span> to the above Eq. (1).</p>
<blockquote>
<p><strong>Exercise</strong>: Compute <span class="arithmatex">\(\chi_s^{\prime \prime } (\omega )\)</span> for the SIAM with the same choice of parameters as in the above demonstration of the impurity spectral function. How does the curve <span class="arithmatex">\(\chi_s^{\prime \prime } (\omega )\)</span> look like? Can you interpret the location of the peak of the curve <span class="arithmatex">\(\chi_s^{\prime \prime } (\omega )\)</span> ?</p>
</blockquote>
<p>(<em>Hint 1</em>: Use <samp>getAdiscQS_Ex</samp> by setting the third input <samp>Z</samp> as <samp>[]</samp> (empty).)</p>
<p>(<em>Hint 2</em>: <span class="arithmatex">\(\chi_s^{\prime \prime } (\omega )\)</span> is an odd function, having peaks as <span class="arithmatex">\(\omega \simeq \pm T_{{\mathrm{K}}}\)</span> . Refer to Fig. 1 of [<a href="https://journals.aps.org/prb/abstract/10.1103/PhysRevB.89.075130">M. Hanl and A. Weichselbaum, Phys. Rev. B <strong>89</strong>, 075130 (2014)</a>] for the shape of <span class="arithmatex">\(\chi_s^{\prime \prime } (\omega )\)</span> for <span class="arithmatex">\(\omega &gt;0\)</span> .)</p>
<blockquote>
<p><strong>Solution to exercise</strong>: </p>
</blockquote>
<p>Perform the iterative diagonalization calculation, with the same parameters chosen in the demonstration of the tutorial.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="nb">clear</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="c">% Hamiltonian parameters</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="n">U</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">4e-3</span><span class="p">;</span><span class="w"> </span><span class="c">% Coulomb interaction at the impurity</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="n">epsd</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="c">% impurity on-site energy</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="n">Gamma</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">8e-5</span><span class="o">*</span><span class="nb">pi</span><span class="p">;</span><span class="w"> </span><span class="c">% hybridization strength</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="c">% NRG parameters</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="n">Lambda</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">2.5</span><span class="p">;</span><span class="w"> </span><span class="c">% discretization parameter</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="n">N</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">55</span><span class="p">;</span><span class="w"> </span><span class="c">% length of the Wilson chain</span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="n">Nkeep</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">300</span><span class="p">;</span>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="c">% Wilson chain</span>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="p">[</span><span class="n">ff</span><span class="p">,</span><span class="n">gg</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">doCLD</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Gamma</span><span class="o">/</span><span class="nb">pi</span><span class="p">,</span><span class="n">Lambda</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a><span class="c">% symmetries</span>
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a><span class="n">symstr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;Acharge,SU2spin&#39;</span><span class="p">;</span><span class="w"> </span><span class="c">% U(1) charge and SU(2) spin</span>
</span><span id="__span-15-18"><a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a><span class="c">% symstr = &#39;Acharge,Aspin&#39;; % U(1) charge and U(1) spin</span>
</span><span id="__span-15-19"><a id="__codelineno-15-19" name="__codelineno-15-19" href="#__codelineno-15-19"></a>
</span><span id="__span-15-20"><a id="__codelineno-15-20" name="__codelineno-15-20" href="#__codelineno-15-20"></a><span class="c">% Construct local operators</span>
</span><span id="__span-15-21"><a id="__codelineno-15-21" name="__codelineno-15-21" href="#__codelineno-15-21"></a><span class="p">[</span><span class="n">F</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">I</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getLocalSpace</span><span class="p">(</span><span class="s">&#39;FermionS&#39;</span><span class="p">,</span><span class="n">symstr</span><span class="p">,</span><span class="s">&#39;NC&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-15-22"><a id="__codelineno-15-22" name="__codelineno-15-22" href="#__codelineno-15-22"></a><span class="p">[</span><span class="n">F</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">EF</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">setItag</span><span class="p">(</span><span class="s">&#39;s00&#39;</span><span class="p">,</span><span class="s">&#39;op&#39;</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">);</span>
</span><span id="__span-15-23"><a id="__codelineno-15-23" name="__codelineno-15-23" href="#__codelineno-15-23"></a>
</span><span id="__span-15-24"><a id="__codelineno-15-24" name="__codelineno-15-24" href="#__codelineno-15-24"></a><span class="c">% particle number operator</span>
</span><span id="__span-15-25"><a id="__codelineno-15-25" name="__codelineno-15-25" href="#__codelineno-15-25"></a><span class="n">NF</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">QSpace</span><span class="p">;</span>
</span><span id="__span-15-26"><a id="__codelineno-15-26" name="__codelineno-15-26" href="#__codelineno-15-26"></a><span class="k">for</span><span class="w"> </span><span class="n">itF</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">numel</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
</span><span id="__span-15-27"><a id="__codelineno-15-27" name="__codelineno-15-27" href="#__codelineno-15-27"></a><span class="w">    </span><span class="n">NF</span><span class="p">(</span><span class="n">itF</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">contract</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">itF</span><span class="p">),</span><span class="s">&#39;!2*&#39;</span><span class="p">,</span><span class="n">F</span><span class="p">(</span><span class="n">itF</span><span class="p">));</span>
</span><span id="__span-15-28"><a id="__codelineno-15-28" name="__codelineno-15-28" href="#__codelineno-15-28"></a><span class="k">end</span>
</span><span id="__span-15-29"><a id="__codelineno-15-29" name="__codelineno-15-29" href="#__codelineno-15-29"></a>
</span><span id="__span-15-30"><a id="__codelineno-15-30" name="__codelineno-15-30" href="#__codelineno-15-30"></a><span class="c">% Impurity Hamiltonian</span>
</span><span id="__span-15-31"><a id="__codelineno-15-31" name="__codelineno-15-31" href="#__codelineno-15-31"></a><span class="n">H0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">U</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">NF</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">NF</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">epsd</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">NF</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1e-33</span><span class="o">*</span><span class="n">EF</span><span class="p">;</span>
</span><span id="__span-15-32"><a id="__codelineno-15-32" name="__codelineno-15-32" href="#__codelineno-15-32"></a>
</span><span id="__span-15-33"><a id="__codelineno-15-33" name="__codelineno-15-33" href="#__codelineno-15-33"></a><span class="c">% ket tensor for the impurity</span>
</span><span id="__span-15-34"><a id="__codelineno-15-34" name="__codelineno-15-34" href="#__codelineno-15-34"></a><span class="n">A0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getIdentity</span><span class="p">(</span><span class="n">setItag</span><span class="p">(</span><span class="s">&#39;L00&#39;</span><span class="p">,</span><span class="n">getvac</span><span class="p">(</span><span class="n">EF</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span><span class="mi">1</span><span class="p">,</span><span class="n">EF</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;K00&#39;</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]);</span>
</span><span id="__span-15-35"><a id="__codelineno-15-35" name="__codelineno-15-35" href="#__codelineno-15-35"></a>
</span><span id="__span-15-36"><a id="__codelineno-15-36" name="__codelineno-15-36" href="#__codelineno-15-36"></a><span class="n">H0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">contract</span><span class="p">(</span><span class="n">A0</span><span class="p">,</span><span class="s">&#39;!2*&#39;</span><span class="p">,{</span><span class="n">A0</span><span class="p">,</span><span class="n">H0</span><span class="p">});</span>
</span><span id="__span-15-37"><a id="__codelineno-15-37" name="__codelineno-15-37" href="#__codelineno-15-37"></a>
</span><span id="__span-15-38"><a id="__codelineno-15-38" name="__codelineno-15-38" href="#__codelineno-15-38"></a><span class="c">% same hopping amplitude and on-site energies for all flavors</span>
</span><span id="__span-15-39"><a id="__codelineno-15-39" name="__codelineno-15-39" href="#__codelineno-15-39"></a><span class="n">ff</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">repmat</span><span class="p">(</span><span class="n">ff</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="nb">numel</span><span class="p">(</span><span class="n">F</span><span class="p">)]);</span>
</span><span id="__span-15-40"><a id="__codelineno-15-40" name="__codelineno-15-40" href="#__codelineno-15-40"></a><span class="n">gg</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">repmat</span><span class="p">(</span><span class="n">gg</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="nb">numel</span><span class="p">(</span><span class="n">F</span><span class="p">)]);</span>
</span><span id="__span-15-41"><a id="__codelineno-15-41" name="__codelineno-15-41" href="#__codelineno-15-41"></a>
</span><span id="__span-15-42"><a id="__codelineno-15-42" name="__codelineno-15-42" href="#__codelineno-15-42"></a><span class="c">% iterative diagonalization</span>
</span><span id="__span-15-43"><a id="__codelineno-15-43" name="__codelineno-15-43" href="#__codelineno-15-43"></a><span class="n">Inrg</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">NRG_IterDiagQS</span><span class="p">(</span><span class="n">H0</span><span class="p">,</span><span class="n">A0</span><span class="p">,</span><span class="n">Lambda</span><span class="p">,</span><span class="n">ff</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">gg</span><span class="p">,</span><span class="n">NF</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">Nkeep</span><span class="p">);</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>21-05-11 17:09:20 | NRG: start
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>21-05-11 17:09:20 | #00/55 : NK=3/3, EK=1e-33/1e-33
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>21-05-11 17:09:20 | #01/55 : NK=10/10, EK=0.04894/0.04894
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>21-05-11 17:09:20 | #02/55 : NK=35/35, EK=3.209/3.209
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>21-05-11 17:09:20 | #03/55 : NK=126/126, EK=6.225/6.225
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>21-05-11 17:09:20 | #04/55 : NK=310/462, EK=7.499/13.02
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>21-05-11 17:09:20 | #05/55 : NK=310/1154, EK=7.033/13.08
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>21-05-11 17:09:20 | #06/55 : NK=318/1150, EK=7.243/13.62
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>21-05-11 17:09:20 | #07/55 : NK=310/1178, EK=7.047/13.09
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>21-05-11 17:09:21 | #08/55 : NK=318/1150, EK=7.248/13.61
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>21-05-11 17:09:21 | #09/55 : NK=310/1178, EK=7.073/13.13
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>21-05-11 17:09:21 | #10/55 : NK=318/1150, EK=7.274/13.59
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a>21-05-11 17:09:21 | #11/55 : NK=310/1178, EK=7.117/13.19
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a>21-05-11 17:09:21 | #12/55 : NK=318/1150, EK=7.359/13.59
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a>21-05-11 17:09:21 | #13/55 : NK=310/1178, EK=7.207/13.33
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a>21-05-11 17:09:21 | #14/55 : NK=322/1150, EK=7.688/13.9
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a>21-05-11 17:09:21 | #15/55 : NK=312/1192, EK=7.46/13.82
</span><span id="__span-16-18"><a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a>21-05-11 17:09:21 | #16/55 : NK=327/1166, EK=8.385/14.7
</span><span id="__span-16-19"><a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a>21-05-11 17:09:22 | #17/55 : NK=304/1218, EK=8.45/14.98
</span><span id="__span-16-20"><a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a>21-05-11 17:09:22 | #18/55 : NK=307/1136, EK=9.027/16.05
</span><span id="__span-16-21"><a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a>21-05-11 17:09:22 | #19/55 : NK=312/1148, EK=9.33/16.02
</span><span id="__span-16-22"><a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a>21-05-11 17:09:22 | #20/55 : NK=311/1170, EK=9.719/17.5
</span><span id="__span-16-23"><a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a>21-05-11 17:09:22 | #21/55 : NK=327/1174, EK=9.804/17.18
</span><span id="__span-16-24"><a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a>21-05-11 17:09:22 | #22/55 : NK=311/1231, EK=9.781/18.26
</span><span id="__span-16-25"><a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a>21-05-11 17:09:22 | #23/55 : NK=302/1174, EK=9.751/17.32
</span><span id="__span-16-26"><a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a>21-05-11 17:09:23 | #24/55 : NK=311/1134, EK=9.836/17.88
</span><span id="__span-16-27"><a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a>21-05-11 17:09:23 | #25/55 : NK=322/1174, EK=9.979/17.46
</span><span id="__span-16-28"><a id="__codelineno-16-28" name="__codelineno-16-28" href="#__codelineno-16-28"></a>21-05-11 17:09:23 | #26/55 : NK=311/1210, EK=9.916/18.36
</span><span id="__span-16-29"><a id="__codelineno-16-29" name="__codelineno-16-29" href="#__codelineno-16-29"></a>21-05-11 17:09:23 | #27/55 : NK=322/1174, EK=10.13/17.64
</span><span id="__span-16-30"><a id="__codelineno-16-30" name="__codelineno-16-30" href="#__codelineno-16-30"></a>21-05-11 17:09:23 | #28/55 : NK=325/1210, EK=10.18/18.32
</span><span id="__span-16-31"><a id="__codelineno-16-31" name="__codelineno-16-31" href="#__codelineno-16-31"></a>21-05-11 17:09:23 | #29/55 : NK=322/1224, EK=10.34/18.23
</span><span id="__span-16-32"><a id="__codelineno-16-32" name="__codelineno-16-32" href="#__codelineno-16-32"></a>21-05-11 17:09:23 | #30/55 : NK=315/1210, EK=10.19/18.35
</span><span id="__span-16-33"><a id="__codelineno-16-33" name="__codelineno-16-33" href="#__codelineno-16-33"></a>21-05-11 17:09:23 | #31/55 : NK=322/1184, EK=10.65/18.36
</span><span id="__span-16-34"><a id="__codelineno-16-34" name="__codelineno-16-34" href="#__codelineno-16-34"></a>21-05-11 17:09:24 | #32/55 : NK=303/1210, EK=10.33/18.76
</span><span id="__span-16-35"><a id="__codelineno-16-35" name="__codelineno-16-35" href="#__codelineno-16-35"></a>21-05-11 17:09:24 | #33/55 : NK=300/1136, EK=10.79/18.81
</span><span id="__span-16-36"><a id="__codelineno-16-36" name="__codelineno-16-36" href="#__codelineno-16-36"></a>21-05-11 17:09:24 | #34/55 : NK=318/1122, EK=10.94/18.84
</span><span id="__span-16-37"><a id="__codelineno-16-37" name="__codelineno-16-37" href="#__codelineno-16-37"></a>21-05-11 17:09:24 | #35/55 : NK=300/1190, EK=11.33/19.89
</span><span id="__span-16-38"><a id="__codelineno-16-38" name="__codelineno-16-38" href="#__codelineno-16-38"></a>21-05-11 17:09:24 | #36/55 : NK=301/1119, EK=11.16/19.39
</span><span id="__span-16-39"><a id="__codelineno-16-39" name="__codelineno-16-39" href="#__codelineno-16-39"></a>21-05-11 17:09:24 | #37/55 : NK=316/1118, EK=11.94/20.4
</span><span id="__span-16-40"><a id="__codelineno-16-40" name="__codelineno-16-40" href="#__codelineno-16-40"></a>21-05-11 17:09:24 | #38/55 : NK=306/1175, EK=11.61/20.4
</span><span id="__span-16-41"><a id="__codelineno-16-41" name="__codelineno-16-41" href="#__codelineno-16-41"></a>21-05-11 17:09:24 | #39/55 : NK=310/1136, EK=12.08/21.49
</span><span id="__span-16-42"><a id="__codelineno-16-42" name="__codelineno-16-42" href="#__codelineno-16-42"></a>21-05-11 17:09:24 | #40/55 : NK=306/1151, EK=11.76/20.7
</span><span id="__span-16-43"><a id="__codelineno-16-43" name="__codelineno-16-43" href="#__codelineno-16-43"></a>21-05-11 17:09:25 | #41/55 : NK=307/1136, EK=11.97/21.78
</span><span id="__span-16-44"><a id="__codelineno-16-44" name="__codelineno-16-44" href="#__codelineno-16-44"></a>21-05-11 17:09:25 | #42/55 : NK=306/1139, EK=11.82/20.14
</span><span id="__span-16-45"><a id="__codelineno-16-45" name="__codelineno-16-45" href="#__codelineno-16-45"></a>21-05-11 17:09:25 | #43/55 : NK=309/1136, EK=12.2/21.9
</span><span id="__span-16-46"><a id="__codelineno-16-46" name="__codelineno-16-46" href="#__codelineno-16-46"></a>21-05-11 17:09:25 | #44/55 : NK=306/1147, EK=11.85/20.88
</span><span id="__span-16-47"><a id="__codelineno-16-47" name="__codelineno-16-47" href="#__codelineno-16-47"></a>21-05-11 17:09:25 | #45/55 : NK=309/1136, EK=12.21/21.95
</span><span id="__span-16-48"><a id="__codelineno-16-48" name="__codelineno-16-48" href="#__codelineno-16-48"></a>21-05-11 17:09:25 | #46/55 : NK=306/1147, EK=11.86/20.9
</span><span id="__span-16-49"><a id="__codelineno-16-49" name="__codelineno-16-49" href="#__codelineno-16-49"></a>21-05-11 17:09:25 | #47/55 : NK=309/1136, EK=12.22/21.97
</span><span id="__span-16-50"><a id="__codelineno-16-50" name="__codelineno-16-50" href="#__codelineno-16-50"></a>21-05-11 17:09:25 | #48/55 : NK=306/1147, EK=11.86/20.91
</span><span id="__span-16-51"><a id="__codelineno-16-51" name="__codelineno-16-51" href="#__codelineno-16-51"></a>21-05-11 17:09:26 | #49/55 : NK=309/1136, EK=12.22/21.98
</span><span id="__span-16-52"><a id="__codelineno-16-52" name="__codelineno-16-52" href="#__codelineno-16-52"></a>21-05-11 17:09:26 | #50/55 : NK=306/1147, EK=11.86/20.91
</span><span id="__span-16-53"><a id="__codelineno-16-53" name="__codelineno-16-53" href="#__codelineno-16-53"></a>21-05-11 17:09:26 | #51/55 : NK=309/1136, EK=12.22/21.98
</span><span id="__span-16-54"><a id="__codelineno-16-54" name="__codelineno-16-54" href="#__codelineno-16-54"></a>21-05-11 17:09:26 | #52/55 : NK=306/1147, EK=11.86/20.91
</span><span id="__span-16-55"><a id="__codelineno-16-55" name="__codelineno-16-55" href="#__codelineno-16-55"></a>21-05-11 17:09:26 | #53/55 : NK=309/1136, EK=12.22/21.98
</span><span id="__span-16-56"><a id="__codelineno-16-56" name="__codelineno-16-56" href="#__codelineno-16-56"></a>21-05-11 17:09:26 | #54/55 : NK=306/1147, EK=11.86/20.91
</span><span id="__span-16-57"><a id="__codelineno-16-57" name="__codelineno-16-57" href="#__codelineno-16-57"></a>21-05-11 17:09:26 | #55/55 : NK=0/1136, EK=0/21.98
</span><span id="__span-16-58"><a id="__codelineno-16-58" name="__codelineno-16-58" href="#__codelineno-16-58"></a>21-05-11 17:09:26 | Memory usage : 3.00GiB
</span><span id="__span-16-59"><a id="__codelineno-16-59" name="__codelineno-16-59" href="#__codelineno-16-59"></a>Elapsed time: 6.543s, CPU time: 13.86s, Avg # of cores: 2.118
</span></code></pre></div>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="n">T</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">1e-8</span><span class="p">;</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="n">Inrg</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getRhoFDMQS</span><span class="p">(</span><span class="n">Inrg</span><span class="p">,</span><span class="n">T</span><span class="p">);</span><span class="w"> </span><span class="c">% construct full density matrix</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>21-05-11 17:09:26 | Construct full density matrix @ T = 1e-08 ...
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>Elapsed time: 1.907s, CPU time: 4.88s, Avg # of cores: 2.559
</span></code></pre></div>
<p>Compute the discrete spectral data of the dynamical impurity spin susceptibility <span class="arithmatex">\(\chi_s (\omega )\)</span> . Here, we use the spin-z operator <samp>S(3)</samp> in case of U(1) spin symmetry or <samp>S</samp> in case of SU(2) spin symmetry. Note that in case of SU(2) spin symmetry, we compute the sum of spin correlations in all three spatial directions, which are all identical. To obtain only the z-component, we therefore have to divide by 3. By setting the third input as empty (<samp>[]</samp>), the <samp>getAdiscQS</samp> routine understands that the input operator is <strong>bosonic</strong>. For fermionic operators, the so-called Z string should be considered, and the sign factor between two terms in the anti-commutator is <span class="arithmatex">\(+\)</span> . On the other hand, for bosonic operators, Z operators do not involve, and the sign factor is <span class="arithmatex">\(-\)</span> due to commutator.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c">% dynamical impurity spin susceptibility</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="k">if</span><span class="w"> </span><span class="nb">numel</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="w"> </span><span class="c">% U(1) spin</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="w">    </span><span class="p">[</span><span class="n">odisc</span><span class="p">,</span><span class="n">Adisc</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getAdiscQS</span><span class="p">(</span><span class="n">Inrg</span><span class="p">,</span><span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">),[]);</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="k">else</span><span class="w"> </span><span class="c">% SU(2) spin</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="w">    </span><span class="p">[</span><span class="n">odisc</span><span class="p">,</span><span class="n">Adisc</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getAdiscQS</span><span class="p">(</span><span class="n">Inrg</span><span class="p">,</span><span class="n">S</span><span class="p">,[]);</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="w">    </span><span class="n">Adisc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Adisc</span><span class="o">/</span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="c">% divide by 3 to consider only z-direction</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="k">end</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>21-05-11 17:09:28 | Correlation function for commuting op.
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>21-05-11 17:09:28 | #01/55 : sum(Adisc) = 0
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>21-05-11 17:09:28 | #02/55 : sum(Adisc) = 0
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>21-05-11 17:09:28 | #03/55 : sum(Adisc) = 0
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>21-05-11 17:09:28 | #04/55 : sum(Adisc) = 8.754e-24
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>21-05-11 17:09:29 | #05/55 : sum(Adisc) = 4.048e-21
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>21-05-11 17:09:29 | #06/55 : sum(Adisc) = -3.268e-20
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>21-05-11 17:09:29 | #07/55 : sum(Adisc) = -5.5e-19
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>21-05-11 17:09:30 | #08/55 : sum(Adisc) = -6.042e-19
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>21-05-11 17:09:30 | #09/55 : sum(Adisc) = -3.233e-18
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a>21-05-11 17:09:30 | #10/55 : sum(Adisc) = -3.667e-18
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a>21-05-11 17:09:30 | #11/55 : sum(Adisc) = -6.703e-18
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a>21-05-11 17:09:31 | #12/55 : sum(Adisc) = -7.353e-18
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a>21-05-11 17:09:31 | #13/55 : sum(Adisc) = -7.57e-18
</span><span id="__span-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a>21-05-11 17:09:31 | #14/55 : sum(Adisc) = -7.57e-18
</span><span id="__span-20-16"><a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a>21-05-11 17:09:31 | #15/55 : sum(Adisc) = -3.706e-17
</span><span id="__span-20-17"><a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a>21-05-11 17:09:32 | #16/55 : sum(Adisc) = -2.492e-17
</span><span id="__span-20-18"><a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a>21-05-11 17:09:32 | #17/55 : sum(Adisc) = -1.971e-17
</span><span id="__span-20-19"><a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a>21-05-11 17:09:32 | #18/55 : sum(Adisc) = -5.094e-17
</span><span id="__span-20-20"><a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a>21-05-11 17:09:33 | #19/55 : sum(Adisc) = -8.563e-17
</span><span id="__span-20-21"><a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a>21-05-11 17:09:33 | #20/55 : sum(Adisc) = -7.869e-17
</span><span id="__span-20-22"><a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a>21-05-11 17:09:33 | #21/55 : sum(Adisc) = 9.478e-17
</span><span id="__span-20-23"><a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a>21-05-11 17:09:34 | #22/55 : sum(Adisc) = 1.017e-16
</span><span id="__span-20-24"><a id="__codelineno-20-24" name="__codelineno-20-24" href="#__codelineno-20-24"></a>21-05-11 17:09:34 | #23/55 : sum(Adisc) = 7.396e-17
</span><span id="__span-20-25"><a id="__codelineno-20-25" name="__codelineno-20-25" href="#__codelineno-20-25"></a>21-05-11 17:09:34 | #24/55 : sum(Adisc) = -2.318e-17
</span><span id="__span-20-26"><a id="__codelineno-20-26" name="__codelineno-20-26" href="#__codelineno-20-26"></a>21-05-11 17:09:34 | #25/55 : sum(Adisc) = 1.85e-16
</span><span id="__span-20-27"><a id="__codelineno-20-27" name="__codelineno-20-27" href="#__codelineno-20-27"></a>21-05-11 17:09:35 | #26/55 : sum(Adisc) = -3.706e-17
</span><span id="__span-20-28"><a id="__codelineno-20-28" name="__codelineno-20-28" href="#__codelineno-20-28"></a>21-05-11 17:09:35 | #27/55 : sum(Adisc) = 7.396e-17
</span><span id="__span-20-29"><a id="__codelineno-20-29" name="__codelineno-20-29" href="#__codelineno-20-29"></a>21-05-11 17:09:35 | #28/55 : sum(Adisc) = 2.405e-16
</span><span id="__span-20-30"><a id="__codelineno-20-30" name="__codelineno-20-30" href="#__codelineno-20-30"></a>21-05-11 17:09:36 | #29/55 : sum(Adisc) = -9.257e-17
</span><span id="__span-20-31"><a id="__codelineno-20-31" name="__codelineno-20-31" href="#__codelineno-20-31"></a>21-05-11 17:09:36 | #30/55 : sum(Adisc) = 6.291e-16
</span><span id="__span-20-32"><a id="__codelineno-20-32" name="__codelineno-20-32" href="#__codelineno-20-32"></a>21-05-11 17:09:36 | #31/55 : sum(Adisc) = 2.405e-16
</span><span id="__span-20-33"><a id="__codelineno-20-33" name="__codelineno-20-33" href="#__codelineno-20-33"></a>21-05-11 17:09:36 | #32/55 : sum(Adisc) = 9.066e-16
</span><span id="__span-20-34"><a id="__codelineno-20-34" name="__codelineno-20-34" href="#__codelineno-20-34"></a>21-05-11 17:09:37 | #33/55 : sum(Adisc) = 4.625e-16
</span><span id="__span-20-35"><a id="__codelineno-20-35" name="__codelineno-20-35" href="#__codelineno-20-35"></a>21-05-11 17:09:37 | #34/55 : sum(Adisc) = 1.24e-15
</span><span id="__span-20-36"><a id="__codelineno-20-36" name="__codelineno-20-36" href="#__codelineno-20-36"></a>21-05-11 17:09:38 | #35/55 : sum(Adisc) = 1.85e-16
</span><span id="__span-20-37"><a id="__codelineno-20-37" name="__codelineno-20-37" href="#__codelineno-20-37"></a>21-05-11 17:09:38 | #36/55 : sum(Adisc) = -8.142e-16
</span><span id="__span-20-38"><a id="__codelineno-20-38" name="__codelineno-20-38" href="#__codelineno-20-38"></a>21-05-11 17:09:38 | #37/55 : sum(Adisc) = -9.252e-16
</span><span id="__span-20-39"><a id="__codelineno-20-39" name="__codelineno-20-39" href="#__codelineno-20-39"></a>21-05-11 17:09:39 | #38/55 : sum(Adisc) = -1.481e-16
</span><span id="__span-20-40"><a id="__codelineno-20-40" name="__codelineno-20-40" href="#__codelineno-20-40"></a>21-05-11 17:09:39 | #39/55 : sum(Adisc) = 5.181e-16
</span><span id="__span-20-41"><a id="__codelineno-20-41" name="__codelineno-20-41" href="#__codelineno-20-41"></a>21-05-11 17:09:40 | #40/55 : sum(Adisc) = -1.813e-15
</span><span id="__span-20-42"><a id="__codelineno-20-42" name="__codelineno-20-42" href="#__codelineno-20-42"></a>21-05-11 17:09:40 | #41/55 : sum(Adisc) = 1.85e-16
</span><span id="__span-20-43"><a id="__codelineno-20-43" name="__codelineno-20-43" href="#__codelineno-20-43"></a>21-05-11 17:09:40 | #42/55 : sum(Adisc) = -1.481e-16
</span><span id="__span-20-44"><a id="__codelineno-20-44" name="__codelineno-20-44" href="#__codelineno-20-44"></a>21-05-11 17:09:41 | #43/55 : sum(Adisc) = -3.706e-17
</span><span id="__span-20-45"><a id="__codelineno-20-45" name="__codelineno-20-45" href="#__codelineno-20-45"></a>21-05-11 17:09:41 | #44/55 : sum(Adisc) = -1.702e-15
</span><span id="__span-20-46"><a id="__codelineno-20-46" name="__codelineno-20-46" href="#__codelineno-20-46"></a>21-05-11 17:09:41 | #45/55 : sum(Adisc) = 8.511e-16
</span><span id="__span-20-47"><a id="__codelineno-20-47" name="__codelineno-20-47" href="#__codelineno-20-47"></a>21-05-11 17:09:42 | #46/55 : sum(Adisc) = -3.706e-17
</span><span id="__span-20-48"><a id="__codelineno-20-48" name="__codelineno-20-48" href="#__codelineno-20-48"></a>21-05-11 17:09:42 | #47/55 : sum(Adisc) = 1.295e-15
</span><span id="__span-20-49"><a id="__codelineno-20-49" name="__codelineno-20-49" href="#__codelineno-20-49"></a>21-05-11 17:09:42 | #48/55 : sum(Adisc) = 1.628e-15
</span><span id="__span-20-50"><a id="__codelineno-20-50" name="__codelineno-20-50" href="#__codelineno-20-50"></a>21-05-11 17:09:43 | #49/55 : sum(Adisc) = 7.396e-17
</span><span id="__span-20-51"><a id="__codelineno-20-51" name="__codelineno-20-51" href="#__codelineno-20-51"></a>21-05-11 17:09:43 | #50/55 : sum(Adisc) = 4.07e-16
</span><span id="__span-20-52"><a id="__codelineno-20-52" name="__codelineno-20-52" href="#__codelineno-20-52"></a>21-05-11 17:09:44 | #51/55 : sum(Adisc) = 5.181e-16
</span><span id="__span-20-53"><a id="__codelineno-20-53" name="__codelineno-20-53" href="#__codelineno-20-53"></a>21-05-11 17:09:44 | #52/55 : sum(Adisc) = 7.401e-16
</span><span id="__span-20-54"><a id="__codelineno-20-54" name="__codelineno-20-54" href="#__codelineno-20-54"></a>21-05-11 17:09:44 | #53/55 : sum(Adisc) = 9.621e-16
</span><span id="__span-20-55"><a id="__codelineno-20-55" name="__codelineno-20-55" href="#__codelineno-20-55"></a>21-05-11 17:09:45 | #54/55 : sum(Adisc) = 1.073e-15
</span><span id="__span-20-56"><a id="__codelineno-20-56" name="__codelineno-20-56" href="#__codelineno-20-56"></a>21-05-11 17:09:45 | #55/55 : sum(Adisc) = 9.621e-16
</span><span id="__span-20-57"><a id="__codelineno-20-57" name="__codelineno-20-57" href="#__codelineno-20-57"></a>Elapsed time: 16.61s, CPU time: 28.66s, Avg # of cores: 1.725
</span><span id="__span-20-58"><a id="__codelineno-20-58" name="__codelineno-20-58" href="#__codelineno-20-58"></a>21-05-11 17:09:45 | Memory usage : 3.00GiB
</span></code></pre></div>
<p>Broaden the discrete data.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="w">    </span><span class="c">% broaden the discrete data to have a continuous curve</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="w">    </span><span class="p">[</span><span class="n">ocont</span><span class="p">,</span><span class="n">Acont</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getAcont</span><span class="p">(</span><span class="n">odisc</span><span class="p">,</span><span class="n">Adisc</span><span class="p">,</span><span class="nb">log</span><span class="p">(</span><span class="n">Lambda</span><span class="p">),</span><span class="n">T</span><span class="o">/</span><span class="mi">5</span><span class="p">);</span>
</span></code></pre></div>
<p>Plot the result.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="w">    </span><span class="nb">figure</span><span class="p">;</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="w">    </span><span class="n">hold</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="w">    </span><span class="c">% positive frequency</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="w">    </span><span class="nb">plot</span><span class="p">(</span><span class="n">ocont</span><span class="p">(</span><span class="n">ocont</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">),</span><span class="n">Acont</span><span class="p">(</span><span class="n">ocont</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="k">...</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="w">        </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;LineStyle&#39;</span><span class="p">,</span><span class="s">&#39;-&#39;</span><span class="p">);</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="w">    </span><span class="c">% negative frequency</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="w">    </span><span class="nb">plot</span><span class="p">(</span><span class="o">-</span><span class="n">ocont</span><span class="p">(</span><span class="n">ocont</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">),</span><span class="o">-</span><span class="n">Acont</span><span class="p">(</span><span class="n">ocont</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="k">...</span>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="w">        </span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;LineStyle&#39;</span><span class="p">,</span><span class="s">&#39;--&#39;</span><span class="p">);</span>
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="w">    </span><span class="n">hold</span><span class="w"> </span><span class="s">off</span><span class="p">;</span>
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="w">    </span><span class="nb">set</span><span class="p">(</span><span class="nb">gca</span><span class="p">,</span><span class="s">&#39;FontSize&#39;</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="s">&#39;LineWidth&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;XScale&#39;</span><span class="p">,</span><span class="s">&#39;log&#39;</span><span class="p">,</span><span class="s">&#39;YScale&#39;</span><span class="p">,</span><span class="s">&#39;log&#39;</span><span class="p">);</span>
</span><span id="__span-22-11"><a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a><span class="w">    </span><span class="nb">legend</span><span class="p">({</span><span class="s">&#39; $\chi&#39;&#39;&#39;&#39;_s(\omega &gt; 0)$ &#39;</span><span class="p">,</span><span class="s">&#39; $-\chi&#39;&#39;&#39;&#39;_s(\omega &lt; 0)$ &#39;</span><span class="p">},</span><span class="w"> </span><span class="k">...</span>
</span><span id="__span-22-12"><a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a><span class="w">        </span><span class="s">&#39;Interpreter&#39;</span><span class="p">,</span><span class="s">&#39;latex&#39;</span><span class="p">);</span>
</span><span id="__span-22-13"><a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a><span class="w">    </span><span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39; $| \omega |$ &#39;</span><span class="p">,</span><span class="s">&#39;Interpreter&#39;</span><span class="p">,</span><span class="s">&#39;latex&#39;</span><span class="p">);</span>
</span><span id="__span-22-14"><a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a><span class="w">    </span><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39; $\chi&#39;&#39;&#39;&#39;_s$ &#39;</span><span class="p">,</span><span class="s">&#39;Interpreter&#39;</span><span class="p">,</span><span class="s">&#39;latex&#39;</span><span class="p">);</span>
</span><span id="__span-22-15"><a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a><span class="w">    </span><span class="nb">xlim</span><span class="p">([</span><span class="mf">1e-11</span><span class="w"> </span><span class="mi">1</span><span class="p">]);</span>
</span><span id="__span-22-16"><a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a><span class="w">    </span><span class="n">grid</span><span class="w"> </span><span class="s">on</span><span class="p">;</span>
</span></code></pre></div>
<p align="center">
  <img src="../images/chipp.png" alt="Alt Text" width = "70%">
</p>

<p>Note that the minus sign prefactor in <span class="arithmatex">\(-\chi_s^{\prime \prime } (\omega &lt;0)\)</span> to visualize the data for negative frequency. We see that the curve is an odd function, i.e., <span class="arithmatex">\(\chi_s^{\prime \prime } (\omega )=-\chi_s^{\prime \prime } (-\omega )\)</span> . It is the generic property of the imaginary part of the correlation functions of bosonic operators.</p>
<p>Identify the peak position of the curve.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="w">    </span><span class="p">[</span><span class="o">~</span><span class="p">,</span><span class="n">maxid</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="n">Acont</span><span class="p">);</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="w">    </span><span class="nb">disp</span><span class="p">(</span><span class="n">ocont</span><span class="p">(</span><span class="n">maxid</span><span class="p">));</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>   8.0353e-07
</span></code></pre></div>
<p>This value is similar to the Kondo temperature <span class="arithmatex">\(T_{{\mathrm{K}}}\)</span> that we obtained from the Bethe ansatz solution. (Note that there are various ways of computing the Kondo temperature, and these ways give similar but different values.)</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="w">    </span><span class="n">TK</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="n">U</span><span class="o">*</span><span class="n">Gamma</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="nb">pi</span><span class="o">*</span><span class="n">U</span><span class="o">/</span><span class="mi">8</span><span class="o">/</span><span class="n">Gamma</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">pi</span><span class="o">*</span><span class="n">Gamma</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">U</span><span class="p">);</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="w">    </span><span class="nb">disp</span><span class="p">(</span><span class="n">TK</span><span class="p">);</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>1.5106e-06
</span></code></pre></div>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="w">    </span><span class="nb">disp</span><span class="p">(</span><span class="n">ocont</span><span class="p">(</span><span class="n">maxid</span><span class="p">)</span><span class="o">/</span><span class="n">TK</span><span class="p">);</span><span class="w"> </span><span class="c">% ratio</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>    0.5319
</span></code></pre></div>
<p>Indeed, the peak position of <span class="arithmatex">\(\chi_s^{\prime \prime } (\omega )\)</span> is the method of choice to determine the Kondo temperature for general quantum impurity systems! This method is especially useful when analytical approaches (such as poor man's scaling and the Bethe ansatz) are not applicable due to the complexity of the system.</p>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2024-05-08T15:01:05+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-05-08</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2024-04-23T08:40:49+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-04-23</span>
  </span>

    
    
    
      
  <span class="md-source-file__fact">
    
      
  <span class="md-icon" title="Contributors">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg>
  </span>
  <span>GitHub</span>

    
    <nav>
      
        <a href="https://github.com/RubiscoP" class="md-author" title="@RubiscoP">
          
          <img src="https://avatars.githubusercontent.com/u/47628396?v=4&size=72" alt="RubiscoP">
        </a>
      
        <a href="https://github.com/Phy-David-Zhang" class="md-author" title="@Phy-David-Zhang">
          
          <img src="https://avatars.githubusercontent.com/u/20659726?v=4&size=72" alt="Phy-David-Zhang">
        </a>
      
      
      
    </nav>
  </span>

    
  </aside>


  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              Thanks for your feedback! Help us improve this page by raising issues in our <a href="https://github.com/Open-Source-QSpace/QSpace-Documentation/issues" target="_blank" rel="noopener">repository</a>.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../NRG2_ImpThermo/" class="md-footer__link md-footer__link--prev" aria-label="Previous: NRG-2: Impurity Contribution  to Thermaldynamic  Properties">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                NRG-2: Impurity Contribution  to Thermaldynamic  Properties
              </div>
            </div>
          </a>
        
        
          
          <a href="../NRG_Kondo/" class="md-footer__link md-footer__link--next" aria-label="Next: NRG for SIKM">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                NRG for SIKM
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Open Source QSpace Organization
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/Open-Source-QSpace" target="_blank" rel="noopener" title="Organization" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="https://bitbucket.org/qspace4u" target="_blank" rel="noopener" title="QSpace4u" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M22.2 32A16 16 0 0 0 6 47.8a26 26 0 0 0 .2 2.8l67.9 412.1a21.77 21.77 0 0 0 21.3 18.2h325.7a16 16 0 0 0 16-13.4L505 50.7a16 16 0 0 0-13.2-18.3 25 25 0 0 0-2.8-.2zm285.9 297.8h-104l-28.1-147h157.3z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://arxiv.org/abs/2405.06632" target="_blank" rel="noopener" title="Technicality" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://www.mathworks.com/products/matlab.html" target="_blank" rel="noopener" title="MATLAB" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M224 373.12c-25.24-31.67-40.08-59.43-45-83.18-22.55-88 112.61-88 90.06 0-5.45 24.25-20.29 52-45 83.18zm138.15 73.23c-42.06 18.31-83.67-10.88-119.3-50.47 103.9-130.07 46.11-200-18.85-200-54.92 0-85.16 46.51-73.28 100.5 6.93 29.19 25.23 62.39 54.43 99.5-32.53 36.05-60.55 52.69-85.15 54.92-50 7.43-89.11-41.06-71.3-91.09 15.1-39.16 111.72-231.18 115.87-241.56 15.75-30.07 25.56-57.4 59.38-57.4 32.34 0 43.4 25.94 60.37 59.87 36 70.62 89.35 177.48 114.84 239.09 13.17 33.07-1.37 71.29-37.01 86.64m47-136.12C280.27 35.93 273.13 32 224 32c-45.52 0-64.87 31.67-84.66 72.79C33.18 317.1 22.89 347.19 22 349.81-3.22 419.14 48.74 480 111.63 480c21.71 0 60.61-6.06 112.37-62.4 58.68 63.78 101.26 62.4 112.37 62.4 62.89.05 114.85-60.86 89.61-130.19.02-3.89-16.82-38.9-16.82-39.58z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.sections", "navigation.footer", "content.action.edit", "content.action.view", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../../js/timeago.min.js"></script>
      
        <script src="../../../js/timeago_mkdocs_material.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="../../../javascripts/feedback.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>