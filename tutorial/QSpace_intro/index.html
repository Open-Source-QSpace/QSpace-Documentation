
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../macOS/">
      
      
        <link rel="next" href="../getLocalSpace/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.14">
    
    
      
        <title>Get to Know QSpace - QSpace Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.fad675c6.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M64 32C28.7 32 0 60.7 0 96v320c0 35.3 28.7 64 64 64h224V368c0-26.5 21.5-48 48-48h112V96c0-35.3-28.7-64-64-64H64zm384 320H336c-8.8 0-16 7.2-16 16v112l32-32 64-64 32-32z"/></svg>');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M96 0C43 0 0 43 0 96v320c0 53 43 96 96 96h320c17.7 0 32-14.3 32-32s-14.3-32-32-32v-64c17.7 0 32-14.3 32-32V32c0-17.7-14.3-32-32-32H96zm0 384h256v64H96c-17.7 0-32-14.3-32-32s14.3-32 32-32zm32-240c0-8.8 7.2-16 16-16h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16zm16 48h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16s7.2-16 16-16z"/></svg>');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M256 512a256 256 0 1 0 0-512 256 256 0 1 0 0 512zm-40-176h24v-64h-24c-13.3 0-24-10.7-24-24s10.7-24 24-24h48c13.3 0 24 10.7 24 24v88h8c13.3 0 24 10.7 24 24s-10.7 24-24 24h-80c-13.3 0-24-10.7-24-24s10.7-24 24-24zm40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"/></svg>');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M480 32c0-12.9-7.8-24.6-19.8-29.6S434.5.2 425.3 9.3L381.7 53c-48 48-113.1 75-181 75H64c-35.3 0-64 28.7-64 64v96c0 35.3 28.7 64 64 64v128c0 17.7 14.3 32 32 32h64c17.7 0 32-14.3 32-32V352h8.7c67.9 0 133 27 181 75l43.6 43.6c9.2 9.2 22.9 11.9 34.9 6.9s19.8-16.6 19.8-29.6V300.4c18.6-8.8 32-32.5 32-60.4s-13.4-51.6-32-60.4V32zm-64 76.7v262.6C357.2 317.8 280.5 288 200.7 288H192v-96h8.7c79.8 0 156.5-29.8 215.3-83.3z"/></svg>');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7l233.4-233.3c12.5-12.5 32.8-12.5 45.3 0z"/></svg>');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M256 512a256 256 0 1 0 0-512 256 256 0 1 0 0 512zm-86.2-346.7c7.9-22.3 29.1-37.3 52.8-37.3h58.3c34.9 0 63.1 28.3 63.1 63.1 0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6-13.3 0-24-10.7-24-24v-13.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1 0-8.4-6.8-15.1-15.1-15.1h-58.3c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM224 352a32 32 0 1 1 64 0 32 32 0 1 1-64 0z"/></svg>');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7.2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8.2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24v112c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0-64 0 32 32 0 1 0 64 0z"/></svg>');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.1 52.4 442.6 6.5c-1.9-3.9-6.1-6.5-10.5-6.5s-8.5 2.6-10.4 6.5l-16.5 45.9-46 16.8c-4.3 1.6-7.3 5.9-7.2 10.4 0 4.5 3 8.7 7.2 10.2l45.7 16.8 16.8 45.8c1.5 4.4 5.8 7.5 10.4 7.5s8.9-3.1 10.4-7.5l16.5-45.8 45.7-16.8c4.2-1.5 7.2-5.7 7.2-10.2 0-4.6-3-8.9-7.2-10.4l-45.6-16.8zm-132.4 53c-12.5-12.5-32.8-12.5-45.3 0l-2.9 2.9c-22-8-45.8-12.3-70.5-12.3C93.1 96 0 189.1 0 304s93.1 208 208 208 208-93.1 208-208c0-24.7-4.3-48.5-12.2-70.5l2.9-2.9c12.5-12.5 12.5-32.8 0-45.3l-80-80zM200 192c-57.4 0-104 46.6-104 104v8c0 8.8-7.2 16-16 16s-16-7.2-16-16v-8c0-75.1 60.9-136 136-136h8c8.8 0 16 7.2 16 16s-7.2 16-16 16h-8z"/></svg>');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 398.9c58.5-41.1 96-104.1 96-174.9C512 100.3 397.4 0 256 0S0 100.3 0 224c0 70.7 37.5 133.8 96 174.9V464c0 26.5 21.5 48 48 48h48v-48c0-8.8 7.2-16 16-16s16 7.2 16 16v48h64v-48c0-8.8 7.2-16 16-16s16 7.2 16 16v48h48c26.5 0 48-21.5 48-48v-65.1zM96 256a64 64 0 1 1 128 0 64 64 0 1 1-128 0zm256-64a64 64 0 1 1 0 128 64 64 0 1 1 0-128z"/></svg>');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M320 0c17.7 0 32 14.3 32 32v64h120c39.8 0 72 32.2 72 72v272c0 39.8-32.2 72-72 72H168c-39.8 0-72-32.2-72-72V168c0-39.8 32.2-72 72-72h120V32c0-17.7 14.3-32 32-32zM208 384c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16h-32zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16h-32zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16h-32zM264 256a40 40 0 1 0-80 0 40 40 0 1 0 80 0zm152 40a40 40 0 1 0 0-80 40 40 0 1 0 0 80zM48 224h16v192H48c-26.5 0-48-21.5-48-48v-96c0-26.5 21.5-48 48-48zm544 0c26.5 0 48 21.5 48 48v96c0 26.5-21.5 48-48 48h-16V224h16z"/></svg>');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M288 0H128c-17.7 0-32 14.3-32 32s14.3 32 32 32v132.8c0 11.8-3.3 23.5-9.5 33.5L10.3 406.2C3.6 417.2 0 429.7 0 442.6 0 480.9 31.1 512 69.4 512h309.2c38.3 0 69.4-31.1 69.4-69.4 0-12.8-3.6-25.4-10.3-36.4L329.5 230.4c-6.2-10.1-9.5-21.7-9.5-33.5V64c17.7 0 32-14.3 32-32S337.7 0 320 0h-32zm-96 196.8V64h64v132.8c0 23.7 6.6 46.9 19 67.1l34.5 56.1h-171l34.5-56.1c12.4-20.2 19-43.4 19-67.1z"/></svg>');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M0 216C0 149.7 53.7 96 120 96h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V216zm256 0c0-66.3 53.7-120 120-120h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64h-64c-35.3 0-64-28.7-64-64V216z"/></svg>');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#get-to-know-qspace" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="QSpace Documentation" class="md-header__button md-logo" aria-label="QSpace Documentation" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            QSpace Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Get to Know QSpace
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_3" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8v2m9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.71-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_3">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Open-Source-QSpace/QSpace-Documentation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    QSpace Documentation
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  Getting started

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  Tutorial

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../iterdiag/" class="md-tabs__link">
          
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../reference/getLocalSpace/" class="md-tabs__link">
          
  
  Reference

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../contribg/" class="md-tabs__link">
          
  
  Contribute

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="QSpace Documentation" class="md-nav__button md-logo" aria-label="QSpace Documentation" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    QSpace Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Open-Source-QSpace/QSpace-Documentation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    QSpace Documentation
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Getting started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What is QSpace?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2" >
        
          
          <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Installation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2">
            <span class="md-nav__icon md-icon"></span>
            Installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install on Linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../macOS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install on macOS
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Tutorial
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorial
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Get to Know QSpace
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Get to Know QSpace
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#clebsch-gordan-coefficient-data" class="md-nav__link">
    <span class="md-ellipsis">
      Clebsch-Gordan coefficient data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generate-local-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Generate local operators
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#differences-from-the-tn-tutorial-materials" class="md-nav__link">
    <span class="md-ellipsis">
      Differences from the TN tutorial materials
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understand-qspace-objects" class="md-nav__link">
    <span class="md-ellipsis">
      Understand QSpace objects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access-data-in-qspace-objects" class="md-nav__link">
    <span class="md-ellipsis">
      Access data in QSpace objects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Basic operations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#select-subspace" class="md-nav__link">
    <span class="md-ellipsis">
      Select subspace
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contraction" class="md-nav__link">
    <span class="md-ellipsis">
      Contraction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rank-2-tensors" class="md-nav__link">
    <span class="md-ellipsis">
      Rank-2 tensors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vacuum-space" class="md-nav__link">
    <span class="md-ellipsis">
      Vacuum space
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generate-identity-operators-and-isometries" class="md-nav__link">
    <span class="md-ellipsis">
      Generate identity operators and isometries
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#automatic-truncation-of-all-zero-sectors" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic truncation of all-zero sectors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eigendecomposition" class="md-nav__link">
    <span class="md-ellipsis">
      Eigendecomposition
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#singular-value-decomposition" class="md-nav__link">
    <span class="md-ellipsis">
      Singular value decomposition
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#normalization-convention" class="md-nav__link">
    <span class="md-ellipsis">
      Normalization convention
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outer-multiplicity" class="md-nav__link">
    <span class="md-ellipsis">
      Outer multiplicity
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getLocalSpace/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Starting Point: getLocalSpace
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../iterdiag/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Iterative Diagonalization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    NRG Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            NRG Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/NRG/NRG_Eflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NRG Energy Flow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/NRG/NRG_Kondo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NRG for SIKM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/NRG/NRG_Kondo_Thermal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SIKM Thermal Properties
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/NRG/NRG_SpecFunc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NRG for Spectral Functions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    DMRG Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            DMRG Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/DMRG/DMRGHubbard2D/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2D Hubbard Model
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/getLocalSpace/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    getLocalSpace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/contractQS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    contractQS
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Contribute
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Contribute
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contribg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to Contribute
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mdref/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Markdown Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mkdocsg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MkDocs Guide
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#clebsch-gordan-coefficient-data" class="md-nav__link">
    <span class="md-ellipsis">
      Clebsch-Gordan coefficient data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generate-local-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Generate local operators
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#differences-from-the-tn-tutorial-materials" class="md-nav__link">
    <span class="md-ellipsis">
      Differences from the TN tutorial materials
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understand-qspace-objects" class="md-nav__link">
    <span class="md-ellipsis">
      Understand QSpace objects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access-data-in-qspace-objects" class="md-nav__link">
    <span class="md-ellipsis">
      Access data in QSpace objects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Basic operations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#select-subspace" class="md-nav__link">
    <span class="md-ellipsis">
      Select subspace
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contraction" class="md-nav__link">
    <span class="md-ellipsis">
      Contraction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rank-2-tensors" class="md-nav__link">
    <span class="md-ellipsis">
      Rank-2 tensors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vacuum-space" class="md-nav__link">
    <span class="md-ellipsis">
      Vacuum space
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generate-identity-operators-and-isometries" class="md-nav__link">
    <span class="md-ellipsis">
      Generate identity operators and isometries
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#automatic-truncation-of-all-zero-sectors" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic truncation of all-zero sectors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eigendecomposition" class="md-nav__link">
    <span class="md-ellipsis">
      Eigendecomposition
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#singular-value-decomposition" class="md-nav__link">
    <span class="md-ellipsis">
      Singular value decomposition
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#normalization-convention" class="md-nav__link">
    <span class="md-ellipsis">
      Normalization convention
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outer-multiplicity" class="md-nav__link">
    <span class="md-ellipsis">
      Outer multiplicity
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/Open-Source-QSpace/QSpace-Documentation/edit/main/docs/tutorial/QSpace_intro.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/Open-Source-QSpace/QSpace-Documentation/raw/main/docs/tutorial/QSpace_intro.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
    </a>
  


<h1 id="get-to-know-qspace">Get to Know QSpace</h1>
<p>Author: <a href="https://www.theorie.physik.uni-muenchen.de/lsvondelft/members/sci_mem/seung_sup-lee/index.html">Seung-Sup Lee</a></p>
<p><strong>QSpace</strong> is a powerful tensor network library developed by <a href="https://homepages.physik.uni-muenchen.de/~Andreas.Weichselbaum/">Andreas Weichselbaum</a>, a long-term colleague of our group. This library enables the generation and manipulation of tensors that respect general Abelian and non-Abelian symmetries. It consists of many MATLAB functions (<span style="font-family: monospace; font-size:.85em">.m</span>), as well as MEX functions (<span style="font-family: monospace; font-size:.85em">.mexa64</span> or <span style="font-family: monospace; font-size:.85em">.mexamaci64</span>) that are binary files written in C++. These MEX functions are used for computationally demanding jobs, such as contraction and eigendecomposition. Thus using the QSpace library can be more efficient, even without exploiting symmetries, than the bare MATLAB code!</p>
<p>The goal of this tutorial is to provide the practical knowledge on using the QSpace library and understanding QSpace objects. For the details of physical and mathematical concepts (e.g., IROP, IREP), please refer to <a href="https://www.sciencedirect.com/science/article/pii/S0003491612001121?via%3Dihub">A. Weichselbaum, Ann. Phys. <em>327</em>, 2972 (2012)</a> and <a href="https://journals.aps.org/prresearch/abstract/10.1103/PhysRevResearch.2.023385">A. Weichselbaum, Phys. Rev. Research <strong>2</strong>, 023385 (2020)</a>.</p>
<h2 id="clebsch-gordan-coefficient-data">Clebsch-Gordan coefficient data</h2>
<p>The key idea of QSpace is to decompose the tensor into two parts, Clebsch-Gordan coefficients and reduced matrix elements, and to treat them separately. The reduced matrix elements may change depending on the system parameters, while the Clebsch-Gordan coefficients are generic. For example, two spin-1/2's should be always combined anti-symmetrically to make the spin singlet, independent of system parameters. So, once the coefficients are generated, they can be recycled for the next calculations.</p>
<p>In this regard, the QSpace library generates Clebsch-Gordan coefficient data on the fly, e.g., when tensors are manipulated. The Clebsch-Gordan coefficients are tensors by themselves, and stored in a disk drive. The path to the directory in which the data is stored is saved as a MATLAB environment variable (<strong>not</strong> a shell variable) <span style="font-family: monospace; font-size:.85em">RC_STORE</span>. To see the path, type in the MATLAB Command Window:</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nb">getenv</span><span class="p">(</span><span class="s">&#39;RC_STORE&#39;</span><span class="p">)</span>
</span></code></pre></div>
<p><span style="font-family: monospace; font-size:.85em">ans =<br>
'/Users/S.Lee/data/RCStore' </span></p>
<p><span style="font-family: monospace; font-size:.85em">startup.m</span>which we provided automatically sets the path and creates the corresponding directory, if not exists.</p>
<p>The Clebsch-Gordan data generated on the fly are indexed depending on their order of appearance. Therefore, it is possible that the same Clebsch-Gordan coefficients are indexed differently, or vice versa. So manipulating (e.g., contracting) one QSpace object generated from the calculation on one machine and another QSpace objected generated from the other calculation on the other machine can lead to the inconsistency of the Clebsch-Gordan coefficients. Therefore, it is advised to generate large enough set of the Clebsch-Gordan data and use the data set for different calculations. However, for the tutorial here, this is not important: The Clebsch-Gordan coefficients relevant to this tutorial can be generated from scratch with very small computational cost.</p>
<h2 id="generate-local-operators">Generate local operators</h2>
<p>The first step of using QSpace is to identify which symmetries in the system are to be exploited. Then we generate the tensors that respect such symmetries. The tensors for a local space (e.g., one lattice site) are generated by <span style="font-family: monospace; font-size:.85em">getLocalSpace</span>. For example, we obtain the operators that act on a <strong>spin-1/2</strong> site and respect SU(2) spin symmetry:</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nb">clear</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="p">[</span><span class="n">S</span><span class="p">,</span><span class="n">I</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getLocalSpace</span><span class="p">(</span><span class="s">&#39;Spin&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="n">S</span><span class="w">  </span><span class="s">%</span><span class="w"> </span><span class="s">spin</span><span class="w"> </span><span class="s">operator</span>
</span></code></pre></div>
<p><span style="font-family: monospace; font-size:.85em">S =<br>
&nbsp;&nbsp;&nbsp;Q:  1x [1 1 1] having 'SU2',&nbsp;&nbsp;&nbsp;operator, &nbsp;&nbsp;&nbsp;{ , * , * }<br>
  data:  3-D double (112 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 x 1 x 1 =&gt; 2 x 2 x 3<br>
  <br>
&nbsp;&nbsp;&nbsp;1.  1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 2x2x3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 1 ; 1 ; 2 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.225</span>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">I</span><span class="w">  </span><span class="s">%</span><span class="w"> </span><span class="s">struct</span><span class="w"> </span><span class="s">that</span><span class="w"> </span><span class="s">contains</span><span class="w"> </span><span class="s">various</span><span class="w"> </span><span class="s">information</span>
</span></code></pre></div></p>
<p><span style="font-family: monospace; font-size:.85em">I = struct with fields:<br>
&nbsp;&nbsp;&nbsp;&nbsp;Sloc: 0.5000<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SOP: [1x1 struct]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sym: 'SpinS'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;U: [2x2 double]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Is: [1x1 struct]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E: [1x1 QSpace]</span></p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="w">  </span><span class="c">% Identity operator</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 1x [1 1] having 'SU2',&nbsp;&nbsp;&nbsp;{ , * }<br>
&nbsp;data: 2-D double (112 bytes)&nbsp;&nbsp;&nbsp;&nbsp;1 x 1 =&gt; 2 x 2<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 1 ; 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;&nbsp;{1.414}</span></p>
<p>Meaning of the displayed information will be explained in the next section.</p>
<p>On the other hand, the operators for one <strong>spinful fermionic site</strong>, which respect U(1) charge and SU(2) spin symmetries, are generated by:</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="p">[</span><span class="n">F</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">I</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getLocalSpace</span><span class="p">(</span><span class="s">&#39;FermionS&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Acharge,SU2spin&#39;</span><span class="p">,</span><span class="s">&#39;NC&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span></code></pre></div>
<p>Here <span style="font-family: monospace; font-size:.85em">'FermionS'</span> means <strong>s</strong>pinful <strong>f</strong>ermion, <span style="font-family: monospace; font-size:.85em">'Acharge,SU2spin'</span> means U(1) charge (A from <strong>A</strong>belian) and SU(2) spin symmetries, and <span style="font-family: monospace; font-size:.85em">'NC',1'</span> means that there is only one channel (NC from <strong>n</strong>umber of <strong>c</strong>hannels).</p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">F</span><span class="w"> </span><span class="s">%</span><span class="w"> </span><span class="s">particle</span><span class="w"> </span><span class="s">annihilation</span><span class="w"> </span><span class="s">operator</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">F = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 2x [2 2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;operator&nbsp;&nbsp;&nbsp;{ , * , * }<br>
&nbsp;data: 3-D double (224 bytes)&nbsp;&nbsp;&nbsp;&nbsp;2 x 2 x 1 =&gt; 3 x 3 x 2<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; 0 1 ; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.414<br>
&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x1x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; 1 0 ; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.414</span></p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">Z</span><span class="w"> </span><span class="s">%</span><span class="w"> </span><span class="s">fermionic</span><span class="w"> </span><span class="s">sign</span><span class="w"> </span><span class="s">operator</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">Z = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 3x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ , * }<br>
&nbsp;data: 2-D double (336 bytes)&nbsp;&nbsp;&nbsp;&nbsp;3 x 3 =&gt; 4 x 4<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; -1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; 0 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1&nbsp;(1.414)
&nbsp;&nbsp;&nbsp;&nbsp;3. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 1 0 ; 1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br></span></p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">S</span><span class="w"> </span><span class="s">%</span><span class="w"> </span><span class="s">spin</span><span class="w"> </span><span class="s">operator</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">S = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 1x [2 2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp; operator, &nbsp;&nbsp;{  , * , * }<br>
&nbsp;data: 3-D double (112 bytes)&nbsp;&nbsp;&nbsp;&nbsp;1 x 1 x 1 =&gt; 2 x 2 x 3<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2x3 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 0 1 ; 0 1 ; 0 2  ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.225<br></span></p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="w"> </span><span class="c">% identity operator</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 3x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ , * }<br>
&nbsp;data: 2-D double (336 bytes)&nbsp;&nbsp;&nbsp;&nbsp;3 x 3 =&gt; 4 x 4<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; -1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; 0 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;(1.414)<br>
&nbsp;&nbsp;&nbsp;&nbsp;3. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 1 0 ; 1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br></span></p>
<p><span style="font-family: monospace; font-size:.85em">F</span> and <span style="font-family: monospace; font-size:.85em">S</span> are rank-3 tensors, since they change charge and spin quantum numbers. On the other hand, <span style="font-family: monospace; font-size:.85em">Z</span>and <span style="font-family: monospace; font-size:.85em">I.E</span> are rank-2 tensors, since they do not change quantum numbers; that is, they are scalars in terms of the Clebsch-Gordan coefficients.</p>
<p><span style="font-family: monospace; font-size:.85em">getLocalSpace</span> can deal with general situations. For details, type in the MATLAB command window: <span style="font-family: monospace; font-size:.85em">'help getLocalSpace'</span>.</p>
<h2 id="differences-from-the-tn-tutorial-materials">Differences from the TN tutorial materials</h2>
<p>Careful readers might have realized that the syntax of <span style="font-family: monospace; font-size:.85em">getLocalSpace</span> here is similar to that of <span style="font-family: monospace; font-size:.85em">TN/Tensor/getLocalSpace</span> which has been used for the previous tutorials. Actually, the TN tutorial materials are designed to be consistent with the syntax convention of the QSpace library. Here by TN, I mean the tutorial materials that we have used so far during the course, whose computational routines are pure MATLAB .m files.</p>
<p>There are, however, a few differences between the conventions of TN and QSpace that need to be kept in mind. </p>
<p><strong>1.</strong> The last output <span style="font-family: monospace; font-size:.85em">I</span> of <span style="font-family: monospace; font-size:.85em">getLocalSpace</span> in the TN material is the identity operator, while <span style="font-family: monospace; font-size:.85em">I</span> from the QSpace function is the struct variable that contains the identity operator.</p>
<p><strong>2. The leg order convention is different.</strong> For the rank-2 tensors (e.g., identity <span style="font-family: monospace; font-size:.85em">I</span> and fermion sign <span style="font-family: monospace; font-size:.85em">Z</span>), the convention is the same as in the TN material.</p>
<p align="center">
  <img src="../images/image_0.png" alt="Alt Text" width = "5.5%">
</p>

<p>The numbers attached to the legs are the order of legs. The first (bottom) and second (top) legs are to be contracted with bra and ket states, respectively. On the other hand, the QSpace convention for the rank-3 tensors (e.g., fermion annihilation <span style="font-family: monospace; font-size:.85em">F</span> and spin <span style="font-family: monospace; font-size:.85em">S</span>) generated by <span style="font-family: monospace; font-size:.85em">getLocalSpace</span> is different:</p>
<p align="center">
  <img src="../images/image_1.png" alt="Alt Text" width = "10%">
</p>

<p>Here the first and second legs have the same roles as for the rank-2 tensors, while the third leg indicates the nature of operator (e.g., spin-raising, annihilating particle of a specific spin at a specific channel). In the TN convention, the top leg is at the third place and the operator leg is at the second place.</p>
<p>While the TN convention is better compatible with covariant formulation of tensors, the QSpace convention has practical advantage. Typically, the bottom and top legs of tensors can involve large dimensions. For example, consider a situation when we compute correlator of two operators acting on different sites in a one-dimensional system. We should contract the bra and ket tensors and the local operators iteratively, all the way from one site to the other. At each iteration, the dimensions of the bottom and top legs are bond dimensions, while the operator leg has small dimensions (e.g., 1 for a single spin-<span class="arithmatex">\(z\)</span> operator and 3 for a full spin operator). Practically, it is better to place the legs of the largest dimensions to the front; then in most cases the tensors are matrices, not multi-dimensional arrays.</p>
<p><strong>3. The leg directions are incorporated in QSpace objects</strong>, while the leg directions are rather bookkeeping in the TN materials. The tensors in the TN materials are just matrices or multi-dimensional arrays that cannot bring the information of leg directions. On the other hand, since the legs of QSpace objects are associated with quantum numbers, the directions of legs (inward or outward) are crucial.</p>
<h2 id="understand-qspace-objects">Understand QSpace objects</h2>
<p>Let me explain how to interpret the displayed information, with the example of identity operator <span style="font-family: monospace; font-size:.85em">I.E</span> and particle annihilation operator <code>F</code>.
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">I</span><span class="p">.</span><span class="n">E</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 3x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ , * }<br>
&nbsp;data: 2-D double (336 bytes)&nbsp;&nbsp;&nbsp;&nbsp;3 x 3 =&gt; 4 x 4<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; -1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; 0 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;{1.414}<br>
&nbsp;&nbsp;&nbsp;&nbsp;3. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 1 0 ; 1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br></span></p>
<p>The identity operator <span style="font-family: monospace; font-size:.85em">I.E</span> shows that there are three symmetry sectors: <span style="font-family: monospace; font-size:.85em">[-1 0]</span> is for empty state (no charge, no spin), <span style="font-family: monospace; font-size:.85em">[0 1]</span> is for singly occupied doublets (one charge, total spin 1/2; doublet means for two states <span class="arithmatex">\(S_z =\pm 1/2\)</span>), and <span style="font-family: monospace; font-size:.85em">[1 0]</span> is for doubly occupied state (two charges, total spin 0; the doubly occupied state for a single orbital should be spin singlet, due to Pauli exclusion principle).</p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">F</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">F = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 2x [2 2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;operator&nbsp;&nbsp;&nbsp;{ , * , * }<br>
&nbsp;data: 3-D double (224 bytes)&nbsp;&nbsp;&nbsp;&nbsp;2 x 2 x 1 =&gt; 3 x 3 x 2<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; 0 1; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.414<br>
&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x1x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 0 1 ; 1 0; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.414<br></span></p>
<p>From top left to bottom right:</p>
<ul>
<li><span style="font-family: monospace; font-size:.85em">Q: 2x [2 2 2]</span> : first <span style="font-family: monospace; font-size:.85em">2x</span> means that there are two symmetry sectors. <span style="font-family: monospace; font-size:.85em">[2 2 2]</span> means that there are three legs (so three 2's) and each leg has two quantum numbers (so 2 each). </li>
<li><span style="font-family: monospace; font-size:.85em">having 'A,SU2'</span> : two quantum numbers are for U(1) (Abelian, so <span style="font-family: monospace; font-size:.85em">A</span>) and SU(2) symmetries, respectively. </li>
<li><span style="font-family: monospace; font-size:.85em">operator</span>: FF is an operator with three legs. </li>
<li><span style="font-family: monospace; font-size:.85em">{, * , * }</span> : <strong>itag (index tag)</strong> for each leg. The itag indcates the name and the direction of legs. Here the names are not given (since it is just generated from <span style="font-family: monospace; font-size:.85em">getLocalSpace</span>), while indicating the directions. Empty for the first leg means inward, and <span style="font-family: monospace; font-size:.85em">*</span> for the second and third legs means outward. See the next sections for the detail of itags. </li>
<li><span style="font-family: monospace; font-size:.85em">data: 3-D double (240 bytes)</span>: the data sector (i.e. reduced matrix elements) are three-dimensional array (since <span style="font-family: monospace; font-size:.85em">FF</span> is rank-3), and occupies 240 bytes. </li>
<li><span style="font-family: monospace; font-size:.85em">2 x 2 x 1</span> : Hilbert space dimension, in terms of symmetry multiplets. It means that there are 2, 2, and 1 multiplets for the first, second, and third legs, respectively. </li>
<li><span style="font-family: monospace; font-size:.85em">3 x 3 x 2</span> : Hilbert space dimension, in terms of bare states (not multiplets). It means that there are 3, 3, and 2 states for the first, second, and third legs, respectively. </li>
<li><span style="font-family: monospace; font-size:.85em">1. 1x1x1 | 1x2x2</span>: The first symmetry sector (so <span style="font-family: monospace; font-size:.85em">1.</span>) has the reduced matrix elements as <span style="font-family: monospace; font-size:.85em">1x1x1</span> array in the multiplet basis. And a single multiplet representing the sector has multiplet dimension <span style="font-family: monospace; font-size:.85em">1x2x2</span>, that is, the multiplet corresponds to one state for the first leg and two states for the second and third legs, respectively. </li>
<li><span style="font-family: monospace; font-size:.85em">[ -1 0 ; 0 1; -1 1 ]</span> : Quantum numbers for each symmetry sector. Each chunk separated by <span style="font-family: monospace; font-size:.85em">;</span> indicates the quantum number for each leg. As we used <span style="font-family: monospace; font-size:.85em">'Acharge,SU2spin'</span> option for <span style="font-family: monospace; font-size:.85em">getLocalSpace</span>, the first number for each chunk is the charge quantum number (number of charges with respect to half filling) and the second number is the spin quantum number (total spin multiplied by 2). So we see that, for this first symmetry sector, the first leg space has no charge (charge quantum number -1, since half filling has one charge), and no spin (spin quantum number 0). And the second leg space has one charge (charge quantum number 0) and total spin 1/2 (spin quantum number 1). Finally the quantum number [-1 1] of the third chunk shows how the operator <span style="font-family: monospace; font-size:.85em">FF</span> changes quantum number; it decreases charge quantum number by 1 (since it is an annihilation operator) and it is indeed a spinor of total spin 1/2 (spin quantum number is the total spin multiplied by 2) </li>
<li><span style="font-family: monospace; font-size:.85em">-1.414</span> : It is the reduced matrix element for the first symmetry sector. </li>
</ul>
<h2 id="access-data-in-qspace-objects">Access data in QSpace objects</h2>
<p>The information of QSpace objects can be accessed in a similar way as for struct variables. The quantum numbers of <span style="font-family: monospace; font-size:.85em">F</span> are accessed by:
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">F</span><span class="p">.</span><span class="n">Q</span><span class="w"> </span><span class="c">% cell array of quantum numbers</span>
</span></code></pre></div></p>
<p><span style="font-family: monospace; font-size:.85em">ans = 1x3 cell <br></p>
<table>
  <tr>
    <th style="background-color: lightgray; color: gray; border: 1px solid gray;"></th>
   <th style="background-color: lightgray; color: gray; border: 1px solid gray;">1</th>
    <th style="background-color: lightgray; color: gray; border: 1px solid gray;">2</th>
    <th style="background-color: lightgray; color: gray; border: 1px solid gray;">3</th>
  </tr>
  <tr>
    <td style="background-color: lightgray; color: gray; border: 1px solid gray;">1</td>
    <td style="border: 1px solid gray;">[-1,0;0,1]</td>
    <td style="border: 1px solid gray;">[0,1;1,0]</td>
    <td style="border: 1px solid gray;">[-1,1;-1...]</td>
  </tr>
</table>
<p></span></p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">F</span><span class="p">.</span><span class="n">Q</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="w"> </span><span class="c">% first leg</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans = 2x2 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br>
</span></p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">F</span><span class="p">.</span><span class="n">Q</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span><span class="w"> </span><span class="c">% second leg</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans = 2x2 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0<br>
</span>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="n">F</span><span class="p">.</span><span class="n">Q</span><span class="p">{</span><span class="mi">3</span><span class="p">}</span><span class="w"> </span><span class="c">% third leg</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans = 2x2 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<br>
</span></p>
<p>A <span style="font-family: monospace; font-size:.85em">m</span>-th row of <span style="font-family: monospace; font-size:.85em">F.Q{n}</span> indicates the quantum number of the <span style="font-family: monospace; font-size:.85em">m</span>-th symmetry sector for the <span style="font-family: monospace; font-size:.85em">n</span>-th leg space.</p>
<p>The reduced matrix elements are accessed by:
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">F</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="c">% cell array of reduced matrix element data</span>
</span></code></pre></div></p>
<p><span style="font-family: monospace; font-size:.85em">ans = 2x1 cell <br></p>
<table>
  <tr>
    <th style="background-color: lightgray; color: gray; border: 1px solid gray;"></th>
    <th style="background-color: lightgray; color: gray; border: 1px solid gray;">1</th>

  </tr>
  <tr>
    <td style="background-color: lightgray; color: gray; border: 1px solid gray;">1</td>
    <td style="border: 1px solid gray;">-1.4142</td>
  </tr>
  <tr>
    <td style="background-color: lightgray; color: gray; border: 1px solid gray;">2</td>
    <td style="border: 1px solid gray;">-1.4142</td>
  </tr>
</table>
<p></span></p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="nb">celldisp</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="c">% display the contents of a cell array</span>
</span></code></pre></div>
Of course, we can change the values of the data sector. For example,
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="n">F2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F</span><span class="p">;</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="n">F2</span><span class="p">.</span><span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="n">F2</span>
</span></code></pre></div></p>
<p><span style="font-family: monospace; font-size:.85em">F2 = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 2x [2 2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;operator&nbsp;&nbsp;&nbsp;{ , * , * }<br>
&nbsp;data: 3-D double (224 bytes)&nbsp;&nbsp;&nbsp;&nbsp;2 x 2 x 1 =&gt; 3 x 3 x 2<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; 0 1; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.<br>
&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x1x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 0 1 ; 1 0; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.414<br></span></p>
<p>Also we can set and edit the <strong>itags (index tags)</strong>. The itags are saved as the cell array <span style="font-family: monospace; font-size:.85em">.info.itags</span>. Each cell element is a char array, which should be consistent with the direction of each leg. When the itag of a leg ends with <span style="font-family: monospace; font-size:.85em"><em></span>, it means that the leg is outward. Otherwise, the leg is inward. Since the original direction was in-out-out, the first itag should not include <span style="font-family: monospace; font-size:.85em"></em></span> and the second and third itags should end with <span style="font-family: monospace; font-size:.85em">*</span>.</p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="n">F2</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="n">itags</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;s00&#39;</span><span class="p">,</span><span class="s">&#39;s00*&#39;</span><span class="p">,</span><span class="s">&#39;op*&#39;</span><span class="p">}</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">F2 = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 2x [2 2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;operator&nbsp;&nbsp;&nbsp;{ s00, s00<em> , op</em> }<br>
&nbsp;data: 3-D double (224 bytes)&nbsp;&nbsp;&nbsp;&nbsp;2 x 2 x 1 =&gt; 3 x 3 x 2<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; 0 1; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.<br>
&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x1x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 0 1 ; 1 0; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.414<br></span></p>
<p>Here the name of the space, <span style="font-family: monospace; font-size:.85em">s00</span>, for the first and second legs means that the legs act on the space of the local site <span style="font-family: monospace; font-size:.85em">s00</span>. And the name <span style="font-family: monospace; font-size:.85em">op</span> for the third leg means that it indicates the nature of the operator, not acting on the physical space.</p>
<p>One can try to set the itags to be <strong>in</strong>consistent with the original itags. Then the QSpace library detects the inconsistency in the data and gives error message.</p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="k">try</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="w">    </span><span class="n">F2</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="n">itags</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;s00&#39;</span><span class="p">,</span><span class="s">&#39;s00&#39;&#39;,&#39;</span><span class="n">op</span><span class="o">*</span><span class="s">&#39;</span><span class="err">};</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="w">    </span><span class="n">F2</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="s">catch</span><span class="w"> </span><span class="s">e</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="w">    </span><span class="nb">getReport</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="k">end</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">F2 = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 2x [2 2 2]&nbsp;&nbsp; having 'A,SU2',&nbsp;&nbsp;&nbsp;operator&nbsp;&nbsp;&nbsp;{ s00, s00 , op* }<br>
./clebsch.cc:3605&nbsp;&nbsp; 15:29:54&nbsp;ERR init() got CGR QSet mismatch
./clebsch.cc:3605&nbsp;&nbsp;15:29:54&nbsp;ERR&nbsp;U(1) (-1,0,-1) &lt;&gt; U(1) 
</span></p>
<p>The itags are really useful when we treat many tensors at the same time. For example, when many tensors are contracted sequentially (as in TN<span style="font-family: monospace; font-size:.85em">/Tensor/updateLeft</span>), tracking down the leg order at each contraction step is quite tedious job, and is often the source of bug, if one makes a mistake in counting the leg order. By using itags, however, the QSpace library performs the sanity check for the compatibility of legs, and enables the contraction multiple tensors/legs with simple syntax!</p>
<p>We emphasize that one can directly edit <strong>only the reduced matrix elements</strong> (<span style="font-family: monospace; font-size:.85em">.data</span>) <strong>and itags</strong> (<span style="font-family: monospace; font-size:.85em">.info.itags</span>) of QSpace objects. Tinkering any other part of QSpace object may break the consistency of data; and the QSpace library detects such consistency, as you see from the above example of wrong itags.</p>
<h2 id="basic-operations">Basic operations</h2>
<p>QSpace library provides an efficient way of manipulating the tensors, in a similar way as the standard numerical arrays of MATLAB.</p>
<p>First, one can generate the array of empty QSpace objects, similarly as <span style="font-family: monospace; font-size:.85em">zeros</span>.
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="n">M</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">QSpace</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">M = (empty QSpace)
</span>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="n">M</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">QSpace</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">M = (empty QSpace)<br>
...<br>
M(3) = (empty QSpace)
</span>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="nb">size</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans = 1x2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;1
</span></p>
<p>And we can add and subtract QSpace objects.
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="n">Z</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">Z = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 3x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;{ , * }<br>
&nbsp;data: 2-D double (336 bytes)&nbsp;&nbsp;&nbsp;&nbsp;3 x 3 =&gt; 4 x 4<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; -1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; &nbsp;0 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;3. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp; 1 0 ; &nbsp;1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.<br></span>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="n">I</span><span class="p">.</span><span class="n">E</span>
</span></code></pre></div></p>
<p><span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 3x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;{ , * }<br>
&nbsp;data: 2-D double (336 bytes)&nbsp;&nbsp;&nbsp;&nbsp;3 x 3 =&gt; 4 x 4<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; -1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.<br>
&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; &nbsp;0 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.&nbsp;&nbsp;{1.414}<br>
&nbsp;&nbsp;&nbsp;&nbsp;3. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp; 1 0 ; &nbsp;1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.<br></span></p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="n">Z</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="w"> </span><span class="c">% minus</span>
</span></code></pre></div>
<p><span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 3x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;{ , * }<br>
&nbsp;data: 2-D double (336 bytes)&nbsp;&nbsp;&nbsp;&nbsp;3 x 3 =&gt; 4 x 4<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; -1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; &nbsp;0 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-2.&nbsp;&nbsp;{1.414}<br>
&nbsp;&nbsp;&nbsp;&nbsp;3. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp; 1 0 ; &nbsp;1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.<br></span></p>
<p>Multiply a number to QSpace object.
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="n">Z</span><span class="o">*</span><span class="mi">3</span><span class="w"> </span><span class="c">% multiply number</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 3x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;{ , * }<br>
&nbsp;data: 2-D double (336 bytes)&nbsp;&nbsp;&nbsp;&nbsp;3 x 3 =&gt; 4 x 4<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; -1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.<br>
&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ;&nbsp; 0 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-3.&nbsp;&nbsp;{1.414}<br>
&nbsp;&nbsp;&nbsp;&nbsp;3. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp; 1 0 ;&nbsp; 1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.<br></span></p>
<p>Take complex conjugation.
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="n">F</span>
</span></code></pre></div></p>
<p><span style="font-family: monospace; font-size:.85em">F = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 2x [2 2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;operator,&nbsp;&nbsp;&nbsp;{ , *, *  }<br>
&nbsp;data: 3-D double (224 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 x 2 x 1 =&gt; 3 x 3 x 2<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; -1 0 ; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.414.<br>
&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x1x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp; 0 1 ; &nbsp;1 0 ; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.414.<br></span></p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="nb">conj</span><span class="p">(</span><span class="n">F</span><span class="p">)</span><span class="w"> </span><span class="c">% complex conjugation</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 2x [2 2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;operator,&nbsp;&nbsp;&nbsp;{ *, ,  }<br>
&nbsp;data: 3-D double (224 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 x 2 x 1 =&gt; 3 x 3 x 2<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; 0 1 ; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.414.<br>
&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x1x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp; 0 1 ; 1 0 ; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.414.<br></span></p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="n">F1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F</span><span class="p">;</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="n">F1</span><span class="p">.</span><span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="w"> </span><span class="p">=</span><span class="w"> </span>1<span class="nb">i</span><span class="p">;</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="nb">conj</span><span class="p">(</span><span class="n">F1</span><span class="p">)</span>
</span></code></pre></div>
<p><span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 2x [2 2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;operator,&nbsp;&nbsp;&nbsp;{ *, ,  }&nbsp;&nbsp;&nbsp;complex<br>
&nbsp;data: 3-D double (232 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 x 2 x 1 =&gt; 3 x 3 x 2<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; 0 1 ; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1i<br>
&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x1x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp; 0 1 ; 1 0 ; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.414<br></span></p>
<p>We see that the complex conjugation of QSpace object flips all the leg directions (inward vs. outward) and takes the complex conjugate to the reduced matrix elements (numerical arrays in <span style="font-family: monospace; font-size:.85em">.data{..}</span>).</p>
<p>The permutation of the legs can be done by <span style="font-family: monospace; font-size:.85em">permute</span>, which is the wrap-up routine for the binary MEX function <span style="font-family: monospace; font-size:.85em">permuteQS</span>.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="nb">permute</span><span class="p">(</span><span class="n">F</span><span class="p">,[</span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">3</span><span class="p">])</span><span class="w"> </span><span class="c">% permute top and bottom legs </span>
</span></code></pre></div>
<p><span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 2x [2 2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;operator,&nbsp;&nbsp;&nbsp;{ * , ,* }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 3-D double (224 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 x 2 x 1 =&gt; 3 x 3 x 2<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x1x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 0 1 ; -1 0 ; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.414<br>
&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 1 0 ; &nbsp;0 1 ; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.414<br></span></p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="nb">permute</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="s">&#39;213&#39;</span><span class="p">)</span><span class="w"> </span><span class="c">% equivalent expression to the above </span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 2x [2 2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;operator,&nbsp;&nbsp;&nbsp;{ * , ,* }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 3-D double (224 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 x 2 x 1 =&gt; 3 x 3 x 2<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x1x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 0 1 ; -1 0 ; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.414<br>
&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 1 0 ; &nbsp;0 1 ; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.414<br></span></p>
<p>Also the complex conjugation can be done together with permutation, by setting the option <span style="font-family: monospace; font-size:.85em">'conj'</span> in the syntax of <span style="font-family: monospace; font-size:.85em">permute</span>. Then the Hermitian conjugate, which is the combination of the complex conjugate and transpose, to the particle annihilation operator <span style="font-family: monospace; font-size:.85em">F</span> is obtained by:</p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="nb">permute</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span><span class="s">&#39;conj&#39;</span><span class="p">)</span><span class="w"> </span><span class="c">% creation operator </span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 2x [2 2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;operator,&nbsp;&nbsp;&nbsp;{  , *, }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 3-D double (224 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 x 2 x 1 =&gt; 3 x 3 x 2<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x1x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 0 1 ; -1 0 ; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.414<br>
&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 1 0 ; &nbsp;0 1 ; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.414<br></span></p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="nb">permute</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="s">&#39;213*&#39;</span><span class="p">)</span><span class="w"> </span><span class="c">% equivalent expression to the above </span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 2x [2 2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;operator,&nbsp;&nbsp;&nbsp;{  , *, }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 3-D double (224 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 x 2 x 1 =&gt; 3 x 3 x 2<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x1x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 0 1 ; -1 0 ; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.414<br>
&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 1 0 ; &nbsp;0 1 ; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.414<br></span></p>
<p>That is, it becomes the particle creation operator. The tensor network diagram for this is:</p>
<p align="center">
  <img src="../images/image_2.png" alt="Alt Text" width = "10%">
</p>

<p>The Hermitian conjugation for rank-2 operator is:</p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="nb">permute</span><span class="p">(</span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">,[</span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="s">&#39;conj&#39;</span><span class="p">)</span><span class="w"> </span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 3x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ , * }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (336 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 x 3 =&gt; 4 x 4<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; -1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; &nbsp;0 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.&nbsp;&nbsp;{-1.414}<br>
&nbsp;&nbsp;&nbsp;&nbsp;3. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;1 0 ; &nbsp;1 0  ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.<br></span></p>
<p>We see that the identity operator is Hermtian:</p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">permute</span><span class="p">(</span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">,[</span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="s">&#39;conj&#39;</span><span class="p">)</span><span class="w"> </span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 3x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ , * }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (336 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 x 3 =&gt; 4 x 4<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; -1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; &nbsp;0 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.&nbsp;&nbsp;{-1.414}<br>
&nbsp;&nbsp;&nbsp;&nbsp;3. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;1 0 ; &nbsp;1 0  ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.<br></span></p>
<p>Interestingly, the wrap-up function has the same name as the MATLAB bulit-in <span style="font-family: monospace; font-size:.85em">permute</span>. Will it be a problem? Answer is no. MATLAB finds and executes a proper routine depending on the type of input variables. When it detects QSpace objects as input, it calls the routine <span style="font-family: monospace; font-size:.85em">QSpace/Class/@QSpace/permute</span> which is the wrap-up of the MEX function <span style="font-family: monospace; font-size:.85em">QSpace/bin/permuteQS</span> .</p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="nb">which</span><span class="w"> </span><span class="nb">permute</span><span class="p">(</span><span class="n">F</span><span class="p">)</span><span class="w"> </span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">/Users/S.Lee/Documents/MATLAB/QSpace_v3/Class/@QSpace/permute.m &nbsp; % QSpace method</span></p>
<p>On the other hand, if we give a numeric array, then MATLAB calls the built-in function.</p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="n">M</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">;</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">];</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="n">which</span><span class="w"> </span><span class="s">permute(F)</span><span class="w"> </span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">built-in (/Applications/MATLAB_R220a.app/toolbox/matlab/elmat/@double/permute) &nbsp; % double method</span></p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="nb">permute</span><span class="p">(</span><span class="n">M</span><span class="p">,[</span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="c">% transpose </span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans =  2 x 2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4
</span></p>
<p>To see the documentations for MEX functions (which are binary files stored in <span style="font-family: monospace; font-size:.85em">QSpace/bin</span>), type in the MATLAB Command Window:</p>
<p><span style="font-family: monospace; font-size:.85em">&gt;&gt;Name_of_MEX_function -?</span></p>
<p>For example, for permuteQS, type:</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="n">permuteQS</span><span class="w">   </span><span class="o">-</span>?<span class="w"> </span>
</span></code></pre></div>
<p><span style="font-family: monospace; font-size:.85em">Usage: A = <strong>permuteQS</strong>(A, P [,'conj'])<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permute input QSpace using given permutation P.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Optional trailing 'conj' also applies (complex) conjugation<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(note that this also affects real QSpaces in that qdir and<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;itags are altered!).<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For convenience, P[,'conj'] may also be represented as<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single string, e.e. [2 1],'conj' is equivalent to '2,1;<em>'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or '21</em>' where the convention on string notation<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;follows that of contraction indices [ctrIdx]<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NB! [06/02/2019] the provided permutation can be shorter<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;than the rank of the QSpace; in this case it only affects the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;leading range of indices, i.e., acts like an identity<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on the remainder of indices.<br>
<br>
AW (C) Aug 2006 ; May 2010 ; Oct 2014
</span></p>
<h2 id="select-subspace">Select subspace</h2>
<p>We can select part of symmetry sectors, by using <span style="font-family: monospace; font-size:.85em">getsub</span>.
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="n">I</span><span class="p">.</span><span class="n">E</span>
</span></code></pre></div></p>
<p><span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 3x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ , * }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (336 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 x 3 =&gt; 4 x 4<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; -1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; &nbsp;0 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;&nbsp;{-1.414}<br>
&nbsp;&nbsp;&nbsp;&nbsp;3. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;1 0 ; &nbsp;1 0  ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.<br></span></p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="n">getsub</span><span class="p">(</span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w">  </span><span class="c">% select the second sector </span>
</span></code></pre></div>
<p><span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 1x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ , * }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (112 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 x 1 =&gt; 2 x 2<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 0 1 ; 0 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;&nbsp;{-1.414}</span>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="n">getsub</span><span class="p">(</span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">,[</span><span class="mi">1</span><span class="w"> </span><span class="mi">3</span><span class="p">])</span><span class="w">  </span><span class="c">% select the first and third sectors </span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 2x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ , * }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (224 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 x 2 =&gt; 2 x 2<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; -1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.<br>&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;1 0 ; &nbsp;1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.</span></p>
<p>To choose the sectors of specific quantum numbers, we can combine <span style="font-family: monospace; font-size:.85em">getsub</span>, <span style="font-family: monospace; font-size:.85em">find</span>, and <span style="font-family: monospace; font-size:.85em">ismember</span> (the latter two are MATLAB built-ins.)
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="n">getsub</span><span class="p">(</span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">,</span><span class="nb">find</span><span class="p">(</span><span class="nb">ismember</span><span class="p">(</span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">.</span><span class="n">Q</span><span class="p">{</span><span class="mi">1</span><span class="p">},[</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="s">&#39;rows&#39;</span><span class="p">)))</span><span class="w"> </span><span class="c">% choose [0 1] sector </span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 1x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ , * }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (112 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 x 1 =&gt; 2 x 2<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 0 1 ; 0 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;&nbsp;{1.414}</span></p>
<p>It can be done also with <span style="font-family: monospace; font-size:.85em">all</span> and <span style="font-family: monospace; font-size:.85em">bsxfun</span>.
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="n">getsub</span><span class="p">(</span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">,</span><span class="nb">find</span><span class="p">(</span><span class="nb">all</span><span class="p">(</span><span class="nb">bsxfun</span><span class="p">(@</span><span class="nb">eq</span><span class="p">,</span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">.</span><span class="n">Q</span><span class="p">{</span><span class="mi">1</span><span class="p">},[</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">]),</span><span class="mi">2</span><span class="p">)))</span><span class="w"> </span><span class="c">% the same </span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 1x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ , * }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (112 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 x 1 =&gt; 2 x 2<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 0 1 ; 0 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;&nbsp;{1.414}</span></p>
<h2 id="contraction">Contraction</h2>
<p>The contraction of tensors can be done by <span style="font-family: monospace; font-size:.85em">contract</span> (which is the wrap-up of MEX function <span style="font-family: monospace; font-size:.85em">contractQS</span>). By exploiting symmetries, the contraction of QSpace objects is done for every symmetry sectors. <strong>Only the sectors of two tensors, whose quantum numbers are identical, are to be contracted.</strong> And the QSpace library automatically and seamlessly treats the contraction of the Clebsch-Gordan coefficients; we users need to only care about reduced matrix elements.</p>
<p>For example, the particle number operator <span class="arithmatex">\(\hat{n} =\sum_{\sigma } {\hat{f} }_{\sigma }^{\dagger } {\hat{f} }_{\sigma }\)</span> can be obtained by:</p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="n">NF</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">contract</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;1,3;*&#39;</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;1,3&#39;</span><span class="p">)</span><span class="w"> </span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">NF = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 2x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ , * }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (224 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 x 2 =&gt; 3 x 3<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 0 1 ; 0 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;&nbsp;{1.414}<br>&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 1 0 ; 1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.</span></p>
<p>We see that the sector of quantum number <span style="font-family: monospace; font-size:.85em">[0 1]</span>has one particle (see <span style="font-family: monospace; font-size:.85em">.data{1}</span> is 1) and the sector of <span style="font-family: monospace; font-size:.85em">[1 0]</span> has two (see <span style="font-family: monospace; font-size:.85em">.data{2}</span> is 2).</p>
<p>In the usage of <span style="font-family: monospace; font-size:.85em">contract</span>, * at the end of the second input <span style="font-family: monospace; font-size:.85em">'1,3;*'</span>means that the first input <span style="font-family: monospace; font-size:.85em">F</span> is complex conjugated before contraction. And <span style="font-family: monospace; font-size:.85em">'1,3'</span> in the second and fourth inputs mean that the first legs (<span style="font-family: monospace; font-size:.85em">'1'</span> and <span style="font-family: monospace; font-size:.85em">'1'</span> each) and the third legs (<span style="font-family: monospace; font-size:.85em">'3'</span> and <span style="font-family: monospace; font-size:.85em">'3'</span>each) are contracted, respectively. The tensor network diagram for this is:</p>
<p align="center">
  <img src="../images/image_3.png" alt="Alt Text" width = "30%">
</p>

<p>Here <span style="font-family: monospace; font-size:.85em">F</span>* means the complex conjugate to <span style="font-family: monospace; font-size:.85em">F</span>.</p>
<p>By using itags, the contraction can be made simpler. For example, the number operator can be obtained by:
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="n">F1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F</span><span class="p">;</span>
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a><span class="n">F1</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="n">itags</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&#39;s00&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;s00*&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;op*&#39;</span><span class="p">};</span>
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a><span class="n">NF</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">contract</span><span class="p">(</span><span class="n">F1</span><span class="p">,</span><span class="s">&#39;!2*&#39;</span><span class="p">,</span><span class="n">F1</span><span class="p">)</span><span class="w"> </span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">NF = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 2x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ s00, s00* }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (224 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 x 2 =&gt; 3 x 3<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 0 1 ; 0 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;&nbsp;{1.414}<br>&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 1 0 ; 1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.</span></p>
<p>In the usage of <span style="font-family: monospace; font-size:.85em">contract</span> here, <span style="font-family: monospace; font-size:.85em">'*'</span> at the end of the second input <span style="font-family: monospace; font-size:.85em"> '!2*' </span>means that the first input <span style="font-family: monospace; font-size:.85em">F</span> is complex conjugated, and <span style="font-family: monospace; font-size:.85em">'!2'</span> in the second input means that all the legs of the first input except the second leg are contracted to the legs of the third input, as long as their itags match. <strong>Only the pair of outward leg (e.g., with itag <span style="font-family: monospace; font-size:.85em">'s00*'</span>) and inward leg (e.g., with itag <span style="font-family: monospace; font-size:.85em">'s00'</span></strong>) of the same name can be contracted.** Here, the first legs and the third legs have compatible itags, so they are contracted.</p>
<p>Also, the <span style="font-family: monospace; font-size:.85em">contract</span> function supports multiple contractions in a single line syntax. For example, the squared number operator <span class="arithmatex">\(\sum_{\sigma \sigma^{\prime } } {\hat{f} }_{\sigma }^{\dagger } {\hat{f} }_{\sigma } {\hat{f} }_{\sigma^{\prime } }^{\dagger } {\hat{f} }_{\sigma^{\prime } }\)</span> can be obtained by:</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="n">N2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">contract</span><span class="p">(</span><span class="n">F1</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;!2*&#39;</span><span class="p">,{</span><span class="n">F1</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;!1&#39;</span><span class="p">,{</span><span class="n">F1</span><span class="p">,</span><span class="w">  </span><span class="s">&#39;!2*&#39;</span><span class="p">,</span><span class="n">F1</span><span class="p">}});</span>
</span></code></pre></div>
<p><span style="font-family: monospace; font-size:.85em">N2 = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 2x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ s00, s00* }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (224 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 x 2 =&gt; 3 x 3<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 0 1 ; 0 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;&nbsp;{1.414}<br>&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 1 0 ; 1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.</span></p>
<p>In such syntax, the contraction inside the inner-most parenthesis <span style="font-family: monospace; font-size:.85em">{ }</span> is performed first, and then the contraction for the next inner-most parenthesis is done, and so on. In the above example, the parenthesis are given so that the contraction is performed over two right-most tensors, and contract the left ones iteratively. For details, type:</p>
<p><span style="font-family: monospace; font-size:.85em">&gt;&gt; contractQS -?</span></p>
<h2 id="rank-2-tensors">Rank-2 tensors</h2>
<p>Rank-2 tensors are of the simplest type. (<strong>Quick exercise</strong>: Why not rank-1?) They are scalar in terms of Clebsch-Gordan coefficients and there is no (outer) multiplicity of symmetry sectors. And their reduced matrix elements form matrices.</p>
<p>So the QSpace library enables to treat rank-2 QSpace objects, in a way that usual matrices are treated by MATLAB built-in functions.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="n">Z</span><span class="p">.</span><span class="o">&#39;</span><span class="w">  </span><span class="c">% transpose</span>
</span></code></pre></div>
<p><span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 3x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ *,  }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (336 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 x 3 =&gt; 4 x 4<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; -1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.<br>&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; &nbsp;0 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.&nbsp;&nbsp;{1.414}<br>&nbsp;&nbsp;&nbsp;&nbsp;3. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;1 0 ; &nbsp;1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.</span></p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="n">Z</span><span class="o">&#39;</span><span class="w">  </span><span class="c">% Hermitian conjugate</span>
</span></code></pre></div>
<p><span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 3x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ *,  }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (336 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 x 3 =&gt; 4 x 4<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; -1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.<br>&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; &nbsp;0 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.&nbsp;&nbsp;{1.414}<br>&nbsp;&nbsp;&nbsp;&nbsp;3. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;1 0 ; &nbsp;1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.</span></p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="n">Z</span><span class="o">&#39;</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Z</span><span class="w">  </span><span class="c">% Z is Hermitian</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 3x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ *,  }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (336 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 x 3 =&gt; 4 x 4<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; -1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.<br>&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; &nbsp;0 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.&nbsp;&nbsp;{1.414}<br>&nbsp;&nbsp;&nbsp;&nbsp;3. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;1 0 ; &nbsp;1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.</span></p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="n">Z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="w">  </span><span class="c">% matrix multiplication as contraction</span>
</span></code></pre></div>
<p><span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 3x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ *,  }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (336 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 x 3 =&gt; 4 x 4<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; -1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.<br>&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; &nbsp;0 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.&nbsp;&nbsp;{1.414}<br>&nbsp;&nbsp;&nbsp;&nbsp;3. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;1 0 ; &nbsp;1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.</span></p>
<p>As in the case of <span style="font-family: monospace; font-size:.85em">permute</span> explained above, MATLAB can execute different functions depending on the type of inputs. That is, there are several QSpace functions that override the MATLAB built-in functions.</p>
<p>This simplification also works for some rank-3 tensors (whose <span style="font-family: monospace; font-size:.85em">.info.otype</span> is set as <span style="font-family: monospace; font-size:.85em">'operator''</span>).</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="n">F</span><span class="w">  </span><span class="s">%</span><span class="w"> </span><span class="s">Hermitian</span><span class="w"> </span><span class="s">conjugate,</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">result</span><span class="w"> </span><span class="s">is</span><span class="w"> </span><span class="s">particle</span><span class="w"> </span><span class="s">creation</span><span class="w"> </span><span class="s">operators</span>
</span></code></pre></div>
<p><span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 2x [2 2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;operator,&nbsp;&nbsp;&nbsp;{  , *,  }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 3-D double (224 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 x 2 x 1 =&gt; 3 x 3 x 2<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x1x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 0 1 ; -1 0 ; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.414<br>&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 1 0 ; &nbsp;0 1 ; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.414</span></p>
<p>However, it is advisable to use <span style="font-family: monospace; font-size:.85em">permute</span> and  <span style="font-family: monospace; font-size:.85em">contract</span> in general, to avoid any mistake.</p>
<h2 id="vacuum-space">Vacuum space</h2>
<p>The left end and the right end of the matrix product states (MPS) are dummy legs of dimension 1. These dummy legs are introduced to represent all the constituent tensors (so-called A and B tensors) as being rank-3. Thus the dummy legs point to the space which has nothing, i.e., vacuum. The vacuum space carries no quantum number at all, and it is different from the empty state which has specific quantum number. The vacuum space for given set of symmetries is obtained by using <span style="font-family: monospace; font-size:.85em">getvac</span>:</p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="n">getvac</span><span class="p">(</span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">)</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 1x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ , * }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (112 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 x 1 =&gt; 1 x 1<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 0 0 ; 0 0  ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.</span></p>
<h2 id="generate-identity-operators-and-isometries">Generate identity operators and isometries</h2>
<p>We can obtain identity operators and isometries by using <span style="font-family: monospace; font-size:.85em">getIdentity</span>(which is the wrap-up of MEX function <span style="font-family: monospace; font-size:.85em">getIdentityQS</span>). There are three contexts of using <span style="font-family: monospace; font-size:.85em">getIdentity</span>.</p>
<p><strong>1. Obtain the identity operator for a given leg space.</strong></p>
<p>For example, the following provides the identity operator for the Hilbert space of the second leg of <span style="font-family: monospace; font-size:.85em">F</span>.
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="n">FE2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getIdentity</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></code></pre></div></p>
<p><span style="font-family: monospace; font-size:.85em">FE2 = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 2x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ , * }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (224 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 x 2 =&gt; 3 x 3<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 0 1 ; 0 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;&nbsp;{1.414}<br>&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 1 0 ; 1 0  ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.</span></p>
<p>Note that FE2 is different from the identity operator <span style="font-family: monospace; font-size:.85em">I.E</span> that is for the whole Hilbert space of a spinful fermionic site, since <span style="font-family: monospace; font-size:.85em">FE2</span> does not contain the subspace in which there is no particle (with quantum number <span style="font-family: monospace; font-size:.85em">[-1 0]</span>).</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">FE2</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></code></pre></div>
<p><span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 3x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ , * }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (336 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 x 3 =&gt; 4 x 4<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; -1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.<br>&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; &nbsp;0 1  ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-2.22e-16&nbsp;&nbsp;{1.414}<br>&nbsp;&nbsp;&nbsp;&nbsp;3. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;1 0 ; &nbsp;1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.</span></p>
<p><strong>2. Generate the isometry that combines the spaces of two legs.</strong></p>
<p>Let's create the isometry (so-called A tensors) which combines two local spaces (each of which spans for a spinful fermionic site) to span the product space. In this case, to distinguish different local spaces, it is advised to use itags.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="n">E1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">;</span>
</span><span id="__span-56-2"><a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a><span class="n">E1</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="n">itags</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&#39;s00&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;s00*&#39;</span><span class="p">};</span>
</span><span id="__span-56-3"><a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a><span class="n">E2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">;</span>
</span><span id="__span-56-4"><a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a><span class="n">E2</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="n">itags</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&#39;s01&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;s01*&#39;</span><span class="p">};</span>
</span><span id="__span-56-5"><a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a><span class="n">A</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getIdentity</span><span class="p">(</span><span class="n">E1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">E2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span>
</span></code></pre></div>
<p><span style="font-family: monospace; font-size:.85em">A = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 10x [2 2 1] having 'A,SU2',&nbsp;&nbsp;&nbsp;A-matrix,&nbsp;&nbsp;&nbsp;{ s00, s01, * }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 3-D double (1200 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 x 3 x 10 =&gt; 4 x 4 x 16<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; -1 0 ; -2 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.<br>&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1x2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; &nbsp;0 1 ; -1 1 ]&nbsp;&nbsp;16 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;3. 1x1x2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x1x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; -1 0 ; -1 1 ]&nbsp;&nbsp;16 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;4. 1x1x3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; &nbsp;1 0 ; &nbsp;0 0 ]&nbsp;&nbsp;24 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;5. 1x1x3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; &nbsp;0 1 ; &nbsp;0 0 ]&nbsp;&nbsp;24 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;6. 1x1x3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;1 0 ; -1 0 ; &nbsp;0 0 ]&nbsp;&nbsp;24 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;7. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2x3 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; &nbsp;0 1 ; &nbsp;0 2 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.732<br>&nbsp;&nbsp;&nbsp;&nbsp;8. 1x1x2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x1x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; &nbsp;1 0 ; &nbsp;1 1 ]&nbsp;&nbsp;16 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;9. 1x1x2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;1 0 ; &nbsp;0 1 ; &nbsp;1 1 ]&nbsp;&nbsp;16 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;10. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;1 0 ; &nbsp;1 0 ; &nbsp;2 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.<br>
</span></p>
<p>The corresponding diagram is:</p>
<p align="center">
  <img src="../images/image_4.png" alt="Alt Text" width = "20%">
</p>

<p>This isometry is left-normalized. (<strong>Quick exercise</strong>: check this!) Such isometries are the building blocks of the MPS.</p>
<p>In the lecture course, the convention for ordering the legs of isometries is left-bottom-right, as <span style="font-family: monospace; font-size:.85em">A</span> is so here. However, many functions and programs in and based on the QSpace library use different convention: left-right-bottom. The same reason, explained in the previous section on the convention differences, applies here as well. Typically the left and right legs have the largest dimensions, while the bottom leg acts on low-dimensional local space. So placing the left and right legs before the bottom leg is more practical.</p>
<p><span style="font-family: monospace; font-size:.85em">getIdentity</span> also supports (i) setting the itag for a newly generated leg spanning the product space and (ii) permuting legs in a single line.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a><span class="n">A</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getIdentity</span><span class="p">(</span><span class="n">E1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">E2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;A01*&#39;</span><span class="p">,[</span><span class="mi">1</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">2</span><span class="p">]);</span>
</span></code></pre></div>
<p><span style="font-family: monospace; font-size:.85em">A = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 10x [2 2 1] having 'A,SU2',&nbsp;&nbsp;&nbsp;A-matrix,&nbsp;&nbsp;&nbsp;{ s00, A01*, s01 }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 3-D double (1200 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 x 3 x 10 =&gt; 4 x 4 x 16<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; -2 0 ; -1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.<br>&nbsp;&nbsp;&nbsp;&nbsp;2. 1x2x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; -1 1 ; &nbsp;0 1 ]&nbsp;&nbsp;16 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;3. 1x2x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; -1 1 ; -1 0 ]&nbsp;&nbsp;16 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;4. 1x3x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; &nbsp;0 0 ; &nbsp;1 0 ]&nbsp;&nbsp;24 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;5. 1x3x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x1x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; &nbsp;0 0 ; &nbsp;0 1 ]&nbsp;&nbsp;24 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;6. 1x3x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;1 0 ; &nbsp;0 0 ; -1 0 ]&nbsp;&nbsp;24 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;7. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x3x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; &nbsp;0 2 ; &nbsp;0 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.732<br>&nbsp;&nbsp;&nbsp;&nbsp;8. 1x2x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; &nbsp;1 1 ; &nbsp;1 0 ]&nbsp;&nbsp;16 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;9. 1x2x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;1 0 ; &nbsp;1 1 ; &nbsp;0 1 ]&nbsp;&nbsp;16 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;10. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;1 0 ; &nbsp;2 0 ; &nbsp;1 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.<br>
</span></p>
<p>Here the 5th input is the itag, and the 6th input is the permutation indices.</p>
<p><strong>3. Generate a </strong><span class="arithmatex">\(1j\)</span><strong> symbol to invert the direction of the legs.</strong></p>
<p>As we have learned from the lecture, it is crucial to flip the leg directions to bring the MPS into different canonical forms (see the material for Tutorial T02a). While inverting leg directions was of mere bookkeeping purpose in the TN materials, it should be performed explicitly for the QSpace objects.</p>
<p>For example, let's invert the third leg of particle annihilation operator.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a><span class="n">F1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F</span><span class="p">;</span>
</span><span id="__span-58-2"><a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a><span class="n">F1</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="n">itags</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&#39;s00&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;s00*&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;op*&#39;</span><span class="p">};</span>
</span><span id="__span-58-3"><a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a><span class="n">F1</span>
</span></code></pre></div>
<p><span style="font-family: monospace; font-size:.85em">F1 = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 2x [2 2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;operator,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ s00, s00*, op* }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 3-D double (224 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 x 2 x 1 =&gt; 3 x 3 x 2<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; 0 &nbsp;1 ; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.414<br>&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x1x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; 1 &nbsp;0 ; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.414</span></p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a><span class="n">I0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getIdentity</span><span class="p">(</span><span class="n">F1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;-0&#39;</span><span class="p">)</span>
</span></code></pre></div>
<p><span style="font-family: monospace; font-size:.85em">I0 = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 1x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ op, op }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (112 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 x 1 =&gt; 2 x 2<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 1 ; 1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;&nbsp;{1.414}</span></p>
<p>The generated operator <span style="font-family: monospace; font-size:.85em">I'</span> is rank-2, and has all-in legs. By looking at the quantum numbers associated with the third leg of <span style="font-family: monospace; font-size:.85em">F1</span>, we see that the first leg of <span style="font-family: monospace; font-size:.85em">I0</span> corresponds the third leg of <span style="font-family: monospace; font-size:.85em">F1</span>. The tensor network diagram for <span style="font-family: monospace; font-size:.85em">I0</span> is:</p>
<p align="center">
  <img src="../images/image_5.png" alt="Alt Text" width = "12%">
</p>

<p>Here the left and right legs in solid lines are the first and second legs, respectively.</p>
<p>In this diagram, we see an implicit leg drawn in dashed line, which does <strong>not</strong> appear in the display information above. This implicit leg carries <strong>all zero quantum numbers</strong> since the sum of the quantum numbers of incoming legs should be the same as the sum of those of outgoing legs (i.e., Kirchoff's law for quantum numbers). Note that the second quantum number is spin quantum number (multiplied by 2) associated with the SU(2) symmetry, and the spin quantum number for the implicit leg is zero (which means spin singlet). In other words, the Hilbert space for this implicit leg is vacuum; that's why the leg does not show up explicitly in the numerical object.</p>
<p>In the space of explicit legs, the <span class="arithmatex">\(1j\)</span> symbol behaves as unitary operation. So the tensor network state on which <span class="arithmatex">\(1j\)</span> symbol is acted can <strong>differ</strong> from the original state. One exception is that the explicit leg to be flipped acts on one-dimensional Hilbert space, where the unitary operation reduces to a single prefactor. Therefore, in general, it is required to consider the pair of <span class="arithmatex">\(1j\)</span> symbol and its conjugate. When a <span class="arithmatex">\(1j\)</span> symbol is acted, then its conjugate should be introduced at some point. This notion of pair can be understood intuitively by considering implicit legs that need to be contracted at last:</p>
<p align="center">
  <img src="../images/image_6.png" alt="Alt Text" width = "30%">
</p>

<p>Let's return to the example of inverting the third leg of <span style="font-family: monospace; font-size:.85em">F1</span>. We invert the leg by contracting the <span class="arithmatex">\(1j\)</span> symbol.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a><span class="n">F1I</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">contract</span><span class="p">(</span><span class="n">F1</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;!1&#39;</span><span class="p">,</span><span class="n">I0</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;!2&#39;</span><span class="p">)</span>
</span></code></pre></div>
<p><span style="font-family: monospace; font-size:.85em">F1I = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 2x [2 2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ s00, s00*, op }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 3-D double (224 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 x 2 x 1 =&gt; 3 x 3 x 2<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; 0 &nbsp;1 ; 1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.414<br>&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x1x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; 1 &nbsp;0 ; 1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.414</span></p>
<p>The resulting <span style="font-family: monospace; font-size:.85em">F1I</span> is also an annihilation operator, but it has the inward third leg.</p>
<p>For details, type: <span style="font-family: monospace; font-size:.85em">getIdentityQS -?</span></p>
<h2 id="automatic-truncation-of-all-zero-sectors">Automatic truncation of all-zero sectors</h2>
<p>The <span style="font-family: monospace; font-size:.85em">contract</span> (and some other functions) of the QSpace library <strong>may</strong> remove the sectors whose reduced matrix elements (elements of <span style="font-family: monospace; font-size:.85em">.data{..}</span>) are all zeros. For example, consider the following case.
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a><span class="p">[</span><span class="n">F</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">I</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getLocalSpace</span><span class="p">(</span><span class="w"> </span><span class="s">&#39;FermionS&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Acharge&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;SU2spin&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;NC&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-61-2"><a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a><span class="n">M1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">;</span><span class="w"> </span><span class="n">M1</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="n">itags</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&#39;s00&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;s00*&#39;</span><span class="p">};</span>
</span><span id="__span-61-3"><a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a><span class="n">M2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">;</span><span class="w"> </span><span class="n">M2</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="n">itags</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&#39;s01&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;s01*&#39;</span><span class="p">};</span>
</span><span id="__span-61-4"><a id="__codelineno-61-4" name="__codelineno-61-4" href="#__codelineno-61-4"></a><span class="n">A</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getIdentity</span><span class="p">(</span><span class="n">M1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">M2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;A01*&#39;</span><span class="p">,[</span><span class="mi">1</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">2</span><span class="p">]);</span>
</span><span id="__span-61-5"><a id="__codelineno-61-5" name="__codelineno-61-5" href="#__codelineno-61-5"></a><span class="n">contract</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;!2*&#39;</span><span class="p">,{</span><span class="n">M1</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;!1&#39;</span><span class="p">,{</span><span class="n">M2</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;!1&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">}})</span>
</span></code></pre></div></p>
<p><span style="font-family: monospace; font-size:.85em">A = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 6x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ A01, A01* }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (784 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10 x 10 =&gt; 16 x 16<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; -2 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.<br>&nbsp;&nbsp;&nbsp;&nbsp;2. 2x2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; -1 1 ]&nbsp;&nbsp;32 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{1.414}<br>&nbsp;&nbsp;&nbsp;&nbsp;3. 3x3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; -1 1 ]&nbsp;&nbsp;72 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;4. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;3x3 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; &nbsp;0 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;&nbsp;&nbsp;&nbsp;{1.732}<br>&nbsp;&nbsp;&nbsp;&nbsp;5. 2x2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; &nbsp;0 0 ]&nbsp;&nbsp;32 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{1.414}<br>&nbsp;&nbsp;&nbsp;&nbsp;6. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;1 0 ; &nbsp;0 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.</span></p>
<p>This is the normal contraction of the identity tensors. The result acts on 16-dimensional space of two spinful fermionic sites.</p>
<p>What happens if we replace one sector of <span style="font-family: monospace; font-size:.85em">A</span> with all-zero reduced matrix elements?</p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a><span class="n">A</span><span class="p">.</span><span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}));</span>
</span><span id="__span-62-2"><a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a><span class="n">contract</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;!2*&#39;</span><span class="p">,{</span><span class="n">M1</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;!1&#39;</span><span class="p">,{</span><span class="n">M2</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;!1&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">}});</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">A = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 5x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ A01, A01* }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (672 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9 x 9 =&gt; 15 x 15<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 2x2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; -2 0 ]&nbsp;&nbsp;32 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{1.414}<br>&nbsp;&nbsp;&nbsp;&nbsp;2. 3x3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; -1 1 ]&nbsp;&nbsp;72 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;3. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;3x3 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;&nbsp;{1.732}<br>&nbsp;&nbsp;&nbsp;&nbsp;4. 2x2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 0 ; &nbsp;0 0 ]&nbsp;&nbsp;32 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{1.414}<br>&nbsp;&nbsp;&nbsp;&nbsp;5. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 1 ; &nbsp;0 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.<br>&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p>Then we have the sector <span style="font-family: monospace; font-size:.85em">[-2 0]</span> is missing, and the result acts on 15-dimensional space.</p>
<p>It is an intended feature rather than a bug. When contract tensors over the tensor network, the all-zero sectors in the constituent tensors do not contribute to the result. So the truncation of such all-zero sectors yields better computational efficiency.</p>
<p>However, when we consider the Hamiltonian in effective basis, the Hamiltonian may have the sectors of all zero matrix elements, and such sectors should be kept. All the energy eigenvalues, whether zero or finite, have meaning! For this, we should enforce to keep all-zero sectors. One trick is to add the identity operator, multiplied by very small number smaller than double precision (e.g., <span class="arithmatex">\(10^{-30}\)</span>), to the Hamiltonian. Such small number should not change the physical results, but prevents unwanted truncation.</p>
<h2 id="eigendecomposition">Eigendecomposition</h2>
<p>Let's construct the hopping term <span class="arithmatex">\(\sum_{\sigma } {\hat{f} }_{2\sigma }^{\dagger } {\hat{f} }_{1\sigma } +{\hat{f} }_{1\sigma }^{\dagger } {\hat{f} }_{2\sigma }\)</span> acting on two spinful fermionic sites.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a><span class="c">% for site s00</span>
</span><span id="__span-63-2"><a id="__codelineno-63-2" name="__codelineno-63-2" href="#__codelineno-63-2"></a><span class="n">F1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F</span><span class="p">;</span><span class="w"> </span><span class="n">F1</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="n">itags</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&#39;s00&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;s00*&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;op*&#39;</span><span class="p">};</span>
</span><span id="__span-63-3"><a id="__codelineno-63-3" name="__codelineno-63-3" href="#__codelineno-63-3"></a><span class="n">E1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">;</span><span class="w"> </span><span class="n">E1</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="n">itags</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&#39;s00&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;s00*&#39;</span><span class="p">};</span>
</span><span id="__span-63-4"><a id="__codelineno-63-4" name="__codelineno-63-4" href="#__codelineno-63-4"></a><span class="c">% for site s01</span>
</span><span id="__span-63-5"><a id="__codelineno-63-5" name="__codelineno-63-5" href="#__codelineno-63-5"></a><span class="n">F2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F</span><span class="p">;</span><span class="w"> </span><span class="n">F2</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="n">itags</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&#39;s01&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;s01*&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;op*&#39;</span><span class="p">};</span>
</span><span id="__span-63-6"><a id="__codelineno-63-6" name="__codelineno-63-6" href="#__codelineno-63-6"></a><span class="n">E2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">;</span><span class="w"> </span><span class="n">E2</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="n">itags</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&#39;s01&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;s01*&#39;</span><span class="p">};</span>
</span><span id="__span-63-7"><a id="__codelineno-63-7" name="__codelineno-63-7" href="#__codelineno-63-7"></a><span class="n">Z2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Z</span><span class="p">;</span><span class="w"> </span><span class="n">Z2</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="n">itags</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&#39;s01&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;s01*&#39;</span><span class="p">};</span>
</span><span id="__span-63-8"><a id="__codelineno-63-8" name="__codelineno-63-8" href="#__codelineno-63-8"></a><span class="n">A</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getIdentity</span><span class="p">(</span><span class="n">E1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">E2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;A01*&#39;</span><span class="p">,[</span><span class="mi">1</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">2</span><span class="p">]);</span>
</span><span id="__span-63-9"><a id="__codelineno-63-9" name="__codelineno-63-9" href="#__codelineno-63-9"></a>
</span><span id="__span-63-10"><a id="__codelineno-63-10" name="__codelineno-63-10" href="#__codelineno-63-10"></a><span class="n">H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">contract</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;!2*&#39;</span><span class="p">,{</span><span class="n">F1</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;!1&#39;</span><span class="p">,{</span><span class="n">F2</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;!2*&#39;</span><span class="p">,{</span><span class="n">Z2</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;!1&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">}}})</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">...</span>
</span><span id="__span-63-11"><a id="__codelineno-63-11" name="__codelineno-63-11" href="#__codelineno-63-11"></a><span class="w">    </span><span class="n">contract</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;!2*&#39;</span><span class="p">,{</span><span class="n">F1</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;!2*&#39;</span><span class="p">,{</span><span class="n">Z2</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;!1&#39;</span><span class="p">,{</span><span class="n">F2</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;!1&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">}}})</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">...</span>
</span><span id="__span-63-12"><a id="__codelineno-63-12" name="__codelineno-63-12" href="#__codelineno-63-12"></a><span class="w">    </span><span class="n">getIdentity</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-40</span>
</span></code></pre></div>
<p>The first line of defining H means <span class="arithmatex">\(\sum_{\sigma } {\hat{f} }_{2\sigma }^{\dagger } {\hat{f} }_{1\sigma }\)</span>, and the second line means its Hermitian conjugate. And in the third line, we added the identity multiplied by a small number, to let <code>H</code> have all the sectors (that amount to 16 dimensional space).</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a><span class="nb">celldisp</span><span class="p">(</span><span class="n">H</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>
</span></code></pre></div>
<p><span style="font-family: monospace; font-size:.85em">ans{1} = <br>
&nbsp;&nbsp;&nbsp;1.0000e-40<br>
<br>
<br>
ans{2} = <br>
&nbsp;&nbsp;&nbsp;0.0000&nbsp;&nbsp;&nbsp;&nbsp;1.0000<br>
&nbsp;&nbsp;&nbsp;1.0000&nbsp;&nbsp;&nbsp;&nbsp;0.0000
<br>
<br>
ans{3} = <br>
&nbsp;&nbsp;&nbsp;&nbsp;0.0000&nbsp;&nbsp;&nbsp;-1.4142&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0<br>
&nbsp;&nbsp;&nbsp;-1.4142&nbsp;&nbsp;&nbsp;&nbsp;0.0000&nbsp;&nbsp;&nbsp;&nbsp;-1.4142<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;-1.4142&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0000
<br>
<br>
ans{4} = <br>
&nbsp;&nbsp;&nbsp;1.0000e-40<br>
<br>
<br>
ans{5} = <br>
&nbsp;&nbsp;&nbsp;&nbsp;0.0000&nbsp;&nbsp;&nbsp;-1.0000<br>
&nbsp;&nbsp;&nbsp;-1.0000&nbsp;&nbsp;&nbsp;&nbsp;0.0000
<br>
<br>
ans{6} = <br>
&nbsp;&nbsp;&nbsp;1.0000e-40<br>
</span></p>
<p>The eigenvalues and eigenvectors of <span style="font-family: monospace; font-size:.85em">H</span> can be obtained by <span style="font-family: monospace; font-size:.85em">eig</span> which is the wrap-up of <span style="font-family: monospace; font-size:.85em">eigQS</span>.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a><span class="p">[</span><span class="n">V</span><span class="p">,</span><span class="n">D</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">eig</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
</span></code></pre></div>
<p><span style="font-family: monospace; font-size:.85em">V = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 6x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ A01, A01<em> }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (784 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10 x 10 =&gt; 16 x 16<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -2 0 ; -2 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.<br>&nbsp;&nbsp;&nbsp;&nbsp;2. 2x2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 1 ; -1 1 ]&nbsp;&nbsp;32 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{1.414}<br>&nbsp;&nbsp;&nbsp;&nbsp;3. 3x3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 0 ; &nbsp;0 0 ]&nbsp;&nbsp;72 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;4. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;3x3 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 2 ; &nbsp;0 2 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;&nbsp;{1.732}<br>&nbsp;&nbsp;&nbsp;&nbsp;5. 2x2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;1 1 ; &nbsp;1 1 ]&nbsp;&nbsp;32 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{1.414}<br>&nbsp;&nbsp;&nbsp;&nbsp;6. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;2 0 ; &nbsp;2 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.<br>
<br>
D = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 6x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ A01, A01</em> }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (704 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6 x 10 =&gt; 10 x 16<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -2 0 ; -2 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1e-40<br>&nbsp;&nbsp;&nbsp;&nbsp;2. 2x2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 1 ; -1 1 ]&nbsp;&nbsp;16 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{1.414}<br>&nbsp;&nbsp;&nbsp;&nbsp;3. 1x3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 0 ; &nbsp;0 0 ]&nbsp;&nbsp;24 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;4. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;3x3 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 2 ; &nbsp;0 2 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1e-40&nbsp;&nbsp;{1.732}<br>&nbsp;&nbsp;&nbsp;&nbsp;5. 1x2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;1 1 ; &nbsp;1 1 ]&nbsp;&nbsp;16 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{1.414}<br>&nbsp;&nbsp;&nbsp;&nbsp;6. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;2 0 ; &nbsp;2 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1e-40<br>
<br>
</span>
<span style="font-family: monospace; font-size:.85em">F</span> and <span style="font-family: monospace; font-size:.85em">D</span> are QSpace objects. Each data of <span style="font-family: monospace; font-size:.85em">V</span> is the unitary matrix whose columns are eigenvectors:
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-66-1"><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a><span class="nb">celldisp</span><span class="p">(</span><span class="n">V</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>
</span></code></pre></div></p>
<p><span style="font-family: monospace; font-size:.85em">ans{1} = <br>
&nbsp;&nbsp;&nbsp;1<br>
<br>
<br>
ans{2} = <br>
&nbsp;&nbsp;-0.7071&nbsp;&nbsp;&nbsp;&nbsp;0.7071<br>
&nbsp;&nbsp;&nbsp;0.7071&nbsp;&nbsp;&nbsp;&nbsp;0.7071
<br>
<br>
ans{3} = <br>
&nbsp;&nbsp;&nbsp;-0.5000&nbsp;&nbsp;&nbsp;-0.7071&nbsp;&nbsp;&nbsp;&nbsp;-0.5000<br>
&nbsp;&nbsp;&nbsp;-0.7071&nbsp;&nbsp;&nbsp;-0.0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.7071<br>&nbsp;&nbsp;&nbsp;-0.5000&nbsp;&nbsp;&nbsp;&nbsp;0.7071&nbsp;&nbsp;&nbsp;&nbsp;-0.5000
<br>
<br>
ans{4} = <br>
&nbsp;&nbsp;&nbsp;1<br>
<br>
<br>
ans{5} = <br>
&nbsp;&nbsp;&nbsp;-0.7071&nbsp;&nbsp;&nbsp;-0.7071<br>
&nbsp;&nbsp;&nbsp;-0.7071&nbsp;&nbsp;&nbsp;-0.7071
<br>
<br>
ans{6} = <br>
&nbsp;&nbsp;&nbsp;1<br>
</span></p>
<p>We can check the unitarity of <span style="font-family: monospace; font-size:.85em">V </span>by</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-67-1"><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a><span class="n">V2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">contract</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;!2*&#39;</span><span class="p">,</span><span class="n">V</span><span class="p">);</span>
</span><span id="__span-67-2"><a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a><span class="n">sameas</span><span class="p">(</span><span class="n">V2</span><span class="p">,</span><span class="n">getIdentity</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</span></code></pre></div>
<p><span style="font-family: monospace; font-size:.85em">ans =  logical<br>
&nbsp;&nbsp;&nbsp;1
</span></p>
<p>Each data of <span style="font-family: monospace; font-size:.85em">D</span> is the row vector of eigenvalues:</p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-68-1"><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a><span class="nb">celldisp</span><span class="p">(</span><span class="n">D</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans{1} =<br>
&nbsp;&nbsp;&nbsp;1.0000e-40<br>
<br>
<br>
ans{2} = <br>
&nbsp;&nbsp;-1.0000&nbsp;&nbsp;&nbsp;&nbsp;-1.0000<br>
<br>
<br>
ans{3} = <br>
&nbsp;&nbsp;-2.0000&nbsp;&nbsp;&nbsp;&nbsp;-0.0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.0000<br>
<br>
<br>
ans{4} =<br>
&nbsp;&nbsp;&nbsp;1.0000e-40<br>
<br>
<br>
ans{5} = <br>
&nbsp;&nbsp;-1.0000&nbsp;&nbsp;&nbsp;&nbsp;-1.0000<br>
<br>
<br>
ans{6} =<br>
&nbsp;&nbsp;&nbsp;1.0000e-40<br>
</span></p>
<p>(<strong>Quick exercise</strong>: Explain the eigenvalues.)</p>
<p>To make <span style="font-family: monospace; font-size:.85em">D</span> as an operator representing a diagonal matrix,</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-69-1"><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a><span class="n">D2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">diag</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
</span></code></pre></div>
<p><span style="font-family: monospace; font-size:.85em">V = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 6x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ A01, A01* }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (784 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10 x 10 =&gt; 16 x 16<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -2 0 ; -2 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1e-40<br>&nbsp;&nbsp;&nbsp;&nbsp;2. 2x2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 1 ; -1 1 ]&nbsp;&nbsp;32 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{1.414}<br>&nbsp;&nbsp;&nbsp;&nbsp;3. 3x3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 0 ; &nbsp;0 0 ]&nbsp;&nbsp;72 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;4. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;3x3 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 2 ; &nbsp;0 2 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1e-40&nbsp;&nbsp;{1.732}<br>&nbsp;&nbsp;&nbsp;&nbsp;5. 2x2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;1 1 ; &nbsp;1 1 ]&nbsp;&nbsp;32 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{1.414}<br>&nbsp;&nbsp;&nbsp;&nbsp;6. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;2 0 ; &nbsp;2 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1e-40<br>
<br>
</span></p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-70-1"><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a><span class="nb">celldisp</span><span class="p">(</span><span class="n">D2</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>
</span></code></pre></div>
<p><span style="font-family: monospace; font-size:.85em">ans{1} = <br>
&nbsp;&nbsp;&nbsp;1.0000e-40<br>
<br>
<br>
ans{2} = <br>
&nbsp;&nbsp;-1.0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;1.0000
<br>
<br>
ans{3} = <br>
&nbsp;&nbsp;&nbsp;-2.0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;-0.0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.0000
<br>
<br>
ans{4} = <br>
&nbsp;&nbsp;&nbsp;1.0000e-40<br>
<br>
<br>
ans{5} = <br>
&nbsp;&nbsp;&nbsp;-1.0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;-1.0000
<br>
<br>
ans{6} = <br>
&nbsp;&nbsp;&nbsp;1.0000e-40<br>
</span></p>
<p>One may also directly use the original MEX function <span style="font-family: monospace; font-size:.85em">eigQS</span>.
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-71-1"><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a><span class="p">[</span><span class="n">E</span><span class="p">,</span><span class="n">Ieig</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">eigQS</span><span class="p">(</span><span class="n">H</span><span class="p">);</span>
</span></code></pre></div></p>
<p>Note that the syntax is a bit different from the wrap-up <span style="font-family: monospace; font-size:.85em">eig</span>. <span style="font-family: monospace; font-size:.85em">E</span> is two-column matrix whose first column is the energy eigenvalues (sorted in ascending order) and second column indicates the multiplet dimensions (i.e., degeneracy due to non-Abelian symmetry) associated with the eigenvalues. When only the Abelian symmetries are used, <span style="font-family: monospace; font-size:.85em">E</span> becomes a column vector, without having the second column for the multiplet dimensions.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-72-1"><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a><span class="n">E</span>
</span></code></pre></div>
<p><span style="font-family: monospace; font-size:.85em">ans = 10x2 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-2.0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.0000<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.0000<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.0000<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-0.0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.0000<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.0000<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.0000<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0000<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.0000<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.0000<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.0000<br>
</span></p>
<p>And <span style="font-family: monospace; font-size:.85em">Inrg</span> is the struct that contains more result of the eigendecomposition, including the eigenvectors (<span style="font-family: monospace; font-size:.85em">.AK</span> and <span style="font-family: monospace; font-size:.85em">.AT</span>) and eigenvalues (<span style="font-family: monospace; font-size:.85em">.EK</span> and <span style="font-family: monospace; font-size:.85em">.ET</span>).
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-73-1"><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a><span class="n">Ieig</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans = struct with fields: <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AK: [1x1 struct]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AD: [1x1 struct]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EK: [1x1 struct]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ED: [1x1 struct]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB: [6x2 struct]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NK: 10<br>
&nbsp;&nbsp;&nbsp;Etrunc: 0<br>
</span></p>
<p>Becasue of the MATLAB policy, the direct result of MEX functions should be of MATLAB built-in types, while the QSpace is the user-defined data type. Here <span style="font-family: monospace; font-size:.85em">.AK</span>, <span style="font-family: monospace; font-size:.85em">.AT</span>, <span style="font-family: monospace; font-size:.85em">.EK</span>, and <span style="font-family: monospace; font-size:.85em">.ET</span> are struct variables that are compatible with QSpace. So we wrap them up as QSpace objects:</p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-74-1"><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a><span class="n">Ieig</span><span class="p">.</span><span class="n">EK</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">QSpace</span><span class="p">(</span><span class="n">Ieig</span><span class="p">.</span><span class="n">EK</span><span class="p">);</span>
</span><span id="__span-74-2"><a id="__codelineno-74-2" name="__codelineno-74-2" href="#__codelineno-74-2"></a><span class="n">Ieig</span><span class="p">.</span><span class="n">AK</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">QSpace</span><span class="p">(</span><span class="n">Ieig</span><span class="p">.</span><span class="n">AK</span><span class="p">);</span>
</span><span id="__span-74-3"><a id="__codelineno-74-3" name="__codelineno-74-3" href="#__codelineno-74-3"></a><span class="n">Ieig</span><span class="p">.</span><span class="n">EK</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 6x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ A01, A01<em> }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (784 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10 x 10 =&gt; 16 x 16<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -2 0 ; -2 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1e-40<br>&nbsp;&nbsp;&nbsp;&nbsp;2. 2x2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 1 ; -1 1 ]&nbsp;&nbsp;32 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{1.414}<br>&nbsp;&nbsp;&nbsp;&nbsp;3. 3x3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 0 ; &nbsp;0 0 ]&nbsp;&nbsp;72 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;4. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;3x3 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 2 ; &nbsp;0 2 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1e-40&nbsp;&nbsp;{1.732}<br>&nbsp;&nbsp;&nbsp;&nbsp;5. 2x2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;1 1 ; &nbsp;1 1 ]&nbsp;&nbsp;32 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{1.414}<br>&nbsp;&nbsp;&nbsp;&nbsp;6. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;2 0 ; &nbsp;2 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1e-40<br>
<br>
</span>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-75-1"><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a><span class="n">Ieig</span><span class="p">.</span><span class="n">AK</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 6x [2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ A01, A01</em> }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (784 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10 x 10 =&gt; 16 x 16<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -2 0 ; -2 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.<br>&nbsp;&nbsp;&nbsp;&nbsp;2. 2x2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ -1 1 ; -1 1 ]&nbsp;&nbsp;32 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{1.414}<br>&nbsp;&nbsp;&nbsp;&nbsp;3. 3x3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 0 ; &nbsp;0 0 ]&nbsp;&nbsp;72 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;4. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;3x3 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;0 2 ; &nbsp;0 2 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;&nbsp;{1.732}<br>&nbsp;&nbsp;&nbsp;&nbsp;5. 2x2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;1 1 ; &nbsp;1 1 ]&nbsp;&nbsp;32 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{1.414}<br>&nbsp;&nbsp;&nbsp;&nbsp;6. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;1x1 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &nbsp;2 0 ; &nbsp;2 0 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.<br>
<br>
</span></p>
<p>We can set several options for <span style="font-family: monospace; font-size:.85em">eigQS</span>, such as <span style="font-family: monospace; font-size:.85em">Nkeep</span> (number of <strong>multiplets</strong> to be kept) and <span style="font-family: monospace; font-size:.85em">Etrunc</span> (threshold energy such that the energy eigenvalues below the value are to be kept). For details, type: <span style="font-family: monospace; font-size:.85em">eigQS -?</span></p>
<h2 id="singular-value-decomposition">Singular value decomposition</h2>
<p>We can perform the singular value decomposition (SVD) of QSpace objects, by using MEX function <span style="font-family: monospace; font-size:.85em">svdQS</span>. The first input to <span style="font-family: monospace; font-size:.85em">svdQS</span>is a QSpace object whose legs are <strong>all in</strong>. Indeed, this notion of decomposing all-in tensor is consistent with the diagrammatic expresssion of the Schmidt decomposition.</p>
<p>And the second input is the leg indices. The corresponding legs are to be the legs of the third output <span style="font-family: monospace; font-size:.85em">Vd</span> for right singular vectors. When non-Abelian symmetry is used, it is allowed to choose only one or <span class="arithmatex">\(r-1\)</span> indices, where <span class="arithmatex">\(r\)</span> is the rank of the first input. To "split off" different number of legs (to be associated with <span style="font-family: monospace; font-size:.85em">Vd</span>), we need to fuse the legs by using the isometry generated by <span style="font-family: monospace; font-size:.85em">getIdentity</span>; then perform the SVD; then split the legs by appling the conjugate of the iseometry used to fuse the legs.</p>
<p>For example, consider an isometry:</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-76-1"><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a><span class="p">[</span><span class="n">S</span><span class="p">,</span><span class="n">I</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getLocalSpace</span><span class="p">(</span><span class="w"> </span><span class="s">&#39;Spin&#39;</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
</span><span id="__span-76-2"><a id="__codelineno-76-2" name="__codelineno-76-2" href="#__codelineno-76-2"></a><span class="n">E1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">;</span><span class="w"> </span><span class="n">E1</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="n">itags</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&#39;s00&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;s00*&#39;</span><span class="p">};</span>
</span><span id="__span-76-3"><a id="__codelineno-76-3" name="__codelineno-76-3" href="#__codelineno-76-3"></a><span class="n">E2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">;</span><span class="w"> </span><span class="n">E2</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="n">itags</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&#39;s01&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;s01*&#39;</span><span class="p">};</span>
</span><span id="__span-76-4"><a id="__codelineno-76-4" name="__codelineno-76-4" href="#__codelineno-76-4"></a><span class="n">A</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getIdentity</span><span class="p">(</span><span class="n">E1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">E2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;A01*&#39;</span><span class="p">,[</span><span class="mi">1</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">2</span><span class="p">]);</span>
</span></code></pre></div>
<p>We need to flip the second leg to perform the SVD.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-77-1"><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a><span class="n">I0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getIdentity</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;-0&#39;</span><span class="p">);</span>
</span><span id="__span-77-2"><a id="__codelineno-77-2" name="__codelineno-77-2" href="#__codelineno-77-2"></a><span class="n">AI</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">contract</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;!1&#39;</span><span class="p">,</span><span class="n">I0</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;!2*&#39;</span><span class="p">,[</span><span class="mi">1</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">2</span><span class="p">])</span>
</span></code></pre></div>
<p>Then use the <span style="font-family: monospace; font-size:.85em">svdQS</span>.
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-78-1"><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a><span class="p">[</span><span class="n">U</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Vd</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">svdQS</span><span class="p">(</span><span class="n">AI</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</span></code></pre></div></p>
<p>As mentioned above, the direct outputs from MEX functions are in the form of struct variables, not as QSpace objects. So we need to wrap them up.
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-79-1"><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a><span class="n">U</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">QSpace</span><span class="p">(</span><span class="n">U</span><span class="p">);</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">U = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 2x [1 1 1] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ s00*, A01, s01 }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 3-D double (224 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 x 2 x 1 =&gt; 2 x 4 x 2<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x1x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 1 ; 0 ; 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.7071<br>&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x3x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 1 ; 2 ; 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.225<br></span></p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-80-1"><a id="__codelineno-80-1" name="__codelineno-80-1" href="#__codelineno-80-1"></a><span class="n">S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">QSpace</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">S = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 1x [1 1] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ s00, s00 }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (112 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 x 1 =&gt; 2 x 2<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 1 ; 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.414&nbsp;&nbsp;{1.414}</span></p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-81-1"><a id="__codelineno-81-1" name="__codelineno-81-1" href="#__codelineno-81-1"></a><span class="n">Vd</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">QSpace</span><span class="p">(</span><span class="n">Vd</span><span class="p">)</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">Vd = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 1x [1 1] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ s00*, s00 }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 2-D double (112 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 x 1 =&gt; 2 x 2<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 1 ; 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;&nbsp;{1.414}</span></p>
<p>The first leg (incoming) of <span style="font-family: monospace; font-size:.85em">AI</span> is associated with the second leg (incoming) of <span style="font-family: monospace; font-size:.85em">Vd</span>. And the singular value tensor <span style="font-family: monospace; font-size:.85em">S</span> is all-in.</p>
<h2 id="normalization-convention">Normalization convention</h2>
<p>The QSpace library has different conventions of normalizing the Clebsch-Gordan coefficients for rank-2 tensors (such as <span style="font-family: monospace; font-size:.85em">Z</span> and <span style="font-family: monospace; font-size:.85em">I.E</span>) and for higher-rank tensors (such as <span style="font-family: monospace; font-size:.85em">F</span> and <span style="font-family: monospace; font-size:.85em">S</span>).</p>
<p>For rank-2 tensors, the Clebsch-Gordan coefficients are normalized so that the reduced matrix elements have immediately relevant values. The elements of the tensor <span style="font-family: monospace; font-size:.85em">D</span> (obtained after <span style="font-family: monospace; font-size:.85em">eig</span>) for the energy eigenvalues are indeed energy eigenvalues.
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-82-1"><a id="__codelineno-82-1" name="__codelineno-82-1" href="#__codelineno-82-1"></a><span class="nb">celldisp</span><span class="p">(</span><span class="n">D</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>
</span></code></pre></div></p>
<p><span style="font-family: monospace; font-size:.85em">ans{1} =<br>
&nbsp;&nbsp;&nbsp;1.0000e-40<br>
<br>
<br>
ans{2} = <br>
&nbsp;&nbsp;-1.0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.0000<br>
<br>
<br>
ans{3} = <br>
&nbsp;&nbsp;-2.0000&nbsp;&nbsp;&nbsp;&nbsp;-0.0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.0000<br>
<br>
<br>
ans{4} =<br>
&nbsp;&nbsp;&nbsp;1.0000e-40<br>
<br>
<br>
ans{5} = <br>
&nbsp;&nbsp;-1.0000&nbsp;&nbsp;&nbsp;&nbsp;1.0000<br>
<br>
<br>
ans{6} =<br>
&nbsp;&nbsp;&nbsp;1.0000e-40<br>
</span>
Also each cell <span style="font-family: monospace; font-size:.85em">.data{..}</span> of identity operator <span style="font-family: monospace; font-size:.85em">I.E</span> contains the identity matrices themselves.
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-83-1"><a id="__codelineno-83-1" name="__codelineno-83-1" href="#__codelineno-83-1"></a><span class="nb">celldisp</span><span class="p">(</span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>
</span></code></pre></div></p>
<p><span style="font-family: monospace; font-size:.85em">ans{1} =<br>
&nbsp;&nbsp;&nbsp;1.0000<br>
</span></p>
<p>On the other hand, for higher-rank tensors, the Clebsch-Gordan coefficents are normalized so that the contraction of a tensor and its Hermitian conjugate becomes unity, when the reduced matrix elements are unity. For example, consider a rank-3 tensor which is the subspace projection of <span style="font-family: monospace; font-size:.85em">F</span>,
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-84-1"><a id="__codelineno-84-1" name="__codelineno-84-1" href="#__codelineno-84-1"></a><span class="n">O1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getsub</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></code></pre></div></p>
<p><span style="font-family: monospace; font-size:.85em">O1 = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 1x [2 2 2] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ , *,  * }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 3-D double (112 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 x 1 x 1 =&gt; 2 x 1 x 2<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x1x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 0 1 ; 1 0 ; -1 1 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.414<br></span></p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-85-1"><a id="__codelineno-85-1" name="__codelineno-85-1" href="#__codelineno-85-1"></a><span class="n">O1</span><span class="p">.</span><span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c">% make the reduced matrix to be trivial 1</span>
</span></code></pre></div>
<p>The contraction of <span style="font-family: monospace; font-size:.85em">O1</span> and its Hermitian conjugate, with all the legs contracted, is equal to the squared norm of the Clebsch-Gordan coefficents, since the reduced matrix is set as trivial 1.</p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-86-1"><a id="__codelineno-86-1" name="__codelineno-86-1" href="#__codelineno-86-1"></a><span class="n">contract</span><span class="p">(</span><span class="n">O1</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;1,2,3&#39;</span><span class="p">,</span><span class="n">O1</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;1,2,3;*&#39;</span><span class="p">)</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: [] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 0-D double (112 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;[  ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.<br></span></p>
<p>On the other hand, due to the different normalization convention of rank-2 tensors, the contraction of two identity operators, with all the legs contracted, becomes the Hilbert space dimension.
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-87-1"><a id="__codelineno-87-1" name="__codelineno-87-1" href="#__codelineno-87-1"></a><span class="n">contract</span><span class="p">(</span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;1,2&#39;</span><span class="p">,</span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;1,2;*&#39;</span><span class="p">)</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: [] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 0-D double (112 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;[  ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.<br></span></p>
<h2 id="outer-multiplicity">Outer multiplicity</h2>
<p>When non-Abelian symmetry is used, it is possible that there are multiple sectors with the same quantum numbers, while different sectors are indeed associated with different (orthogonal) Clebsch-Gordan coefficients. It is called <strong>outer multiplicity</strong>. One simple example is:</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-88-1"><a id="__codelineno-88-1" name="__codelineno-88-1" href="#__codelineno-88-1"></a><span class="p">[</span><span class="n">S</span><span class="p">,</span><span class="n">I</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getLocalSpace</span><span class="p">(</span><span class="w"> </span><span class="s">&#39;Spin&#39;</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
</span><span id="__span-88-2"><a id="__codelineno-88-2" name="__codelineno-88-2" href="#__codelineno-88-2"></a><span class="n">A1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getIdentity</span><span class="p">(</span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
</span><span id="__span-88-3"><a id="__codelineno-88-3" name="__codelineno-88-3" href="#__codelineno-88-3"></a><span class="n">A2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getIdentity</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">I</span><span class="p">.</span><span class="n">E</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
</span><span id="__span-88-4"><a id="__codelineno-88-4" name="__codelineno-88-4" href="#__codelineno-88-4"></a><span class="n">A12</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">contract</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;3&#39;</span><span class="p">,</span><span class="n">A2</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;1&#39;</span><span class="p">)</span>
</span></code></pre></div>
<p><span style="font-family: monospace; font-size:.85em">A12 = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: 3x [1 1 1 1] having 'SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ , , , * }&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 4-D double (352 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 x 1 x 1 x 3 =&gt; 2 x 2 x 2 x 8<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1x1x2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2x2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 1 ; 1 ; 1 ; 1 ]&nbsp;&nbsp;16 B&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;2. 1x1x1x2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2x2x2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 1 ; 1 ; 1 ; 1 ]&nbsp;&nbsp;16 B&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;3. 1x1x1x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;2x2x2x4 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ 1 ; 1 ; 1 ; 3 ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.<br>
</span>
The first and second sectors have the same quantum numbers! But, of course, they are orthogonal. Consider their parts:</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-89-1"><a id="__codelineno-89-1" name="__codelineno-89-1" href="#__codelineno-89-1"></a><span class="n">A12a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getsub</span><span class="p">(</span><span class="n">A12</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-89-2"><a id="__codelineno-89-2" name="__codelineno-89-2" href="#__codelineno-89-2"></a><span class="n">A12a</span><span class="p">.</span><span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-89-3"><a id="__codelineno-89-3" name="__codelineno-89-3" href="#__codelineno-89-3"></a><span class="n">A12b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getsub</span><span class="p">(</span><span class="n">A12</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
</span><span id="__span-89-4"><a id="__codelineno-89-4" name="__codelineno-89-4" href="#__codelineno-89-4"></a><span class="n">A12b</span><span class="p">.</span><span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span></code></pre></div>
<p>Here we replaced the reduced matrix elements (<span style="font-family: monospace; font-size:.85em">.data{..}</span>) with ones, to focus on the Clebsch-Gordan coefficients. Then their overlap, i.e., contraction between <span style="font-family: monospace; font-size:.85em">A12a</span> and the conjugate of <span style="font-family: monospace; font-size:.85em">A12b</span> vanishes.</p>
<p><div class="language-matlab highlight"><pre><span></span><code><span id="__span-90-1"><a id="__codelineno-90-1" name="__codelineno-90-1" href="#__codelineno-90-1"></a><span class="n">contract</span><span class="p">(</span><span class="n">A12a</span><span class="p">,</span><span class="s">&#39;1234&#39;</span><span class="p">,</span><span class="n">A12b</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;1234*&#39;</span><span class="p">);</span>
</span></code></pre></div>
<span style="font-family: monospace; font-size:.85em">ans = (empty QSpace)
</span></p>
<p>On the other hand, three incoming legs (from the first to the third) look identical, so it seems that the tensor remains the same after permuting the incoming legs. But it's not! The overlap with <span style="font-family: monospace; font-size:.85em">A12a</span> and the permutation of the first and third legs of <span style="font-family: monospace; font-size:.85em">A12a</span> is <strong>not unity</strong>. It means that the Clebsch-Gordan coefficients can change by permuting legs.</p>
<div class="language-matlab highlight"><pre><span></span><code><span id="__span-91-1"><a id="__codelineno-91-1" name="__codelineno-91-1" href="#__codelineno-91-1"></a><span class="n">contract</span><span class="p">(</span><span class="n">A12a</span><span class="p">,</span><span class="s">&#39;1234&#39;</span><span class="p">,</span><span class="n">A12b</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;3214*&#39;</span><span class="p">);</span><span class="w"> </span><span class="c">% note the 4th input</span>
</span></code></pre></div>
<p><span style="font-family: monospace; font-size:.85em">ans = <br>
&nbsp;&nbsp;&nbsp;&nbsp;Q: [] having 'A,SU2',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;data: 0-D double (112 bytes)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;1. 1x1&nbsp;&nbsp;&nbsp;[  ]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.5<br></span></p>
<p>Why? Let's draw the tensor network diagram for the first and second sectors of <span style="font-family: monospace; font-size:.85em">A12</span>.</p>
<p align="center">
  <img src="../images/image_7.png" alt="Alt Text" width = "40%">
</p>
<p>Attached to the legs are spin quantum numbers. Fusing two <span class="arithmatex">\(S=1/2\)</span> (two incoming legs of <span style="font-family: monospace; font-size:.85em">A1</span>) lead to two values of spin <span class="arithmatex">\(S=0\oplus 1\)</span> (outgoing leg of <span style="font-family: monospace; font-size:.85em">A1</span>). These two values can result in <span class="arithmatex">\(S=1/2\)</span> (outgoing leg of <span style="font-family: monospace; font-size:.85em">A2</span>) by being fused with one <span class="arithmatex">\(S=1/2\)</span> (bottom incoming leg of <span style="font-family: monospace; font-size:.85em">A2</span>). The outer multiplicity of <span style="font-family: monospace; font-size:.85em">A12</span> reflects this two different ways of having four legs of <span class="arithmatex">\(S=1/2\)</span>. In this diagram, it is clear to see that the left leg of <span style="font-family: monospace; font-size:.85em">A1</span> and the bottom leg of <span style="font-family: monospace; font-size:.85em">A2</span> are not equivalent.</p>
<p>&nbsp;</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "content.action.edit", "content.action.view"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.cd18aaf1.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>